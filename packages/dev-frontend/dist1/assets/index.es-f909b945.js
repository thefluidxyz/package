import{c as g_,r as v_,d as y_,a as Wi,g as __,b as b_,E as Fr,e as m_,_ as w_}from"./index-3ce0559c.js";import{t as Br}from"./tslib-ff4456d9.js";import{s as E_,f as D_,a as S_,d as I_,g as x_,b as Nf,c as C_,e as A_,h as Vc,i as hl,j as O_,k as P_,l as Tf,m as kc,p as N_,J as Ci,n as Gc,o as Wc,q as Si,r as li,t as Rf,u as Yc,H as Zi}from"./http-2fe0c86a.js";var Jc={},Oa={},Le={},Uf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(d,g){var w=d>>>16&65535,S=d&65535,F=g>>>16&65535,q=g&65535;return S*q+(w*q+S*F<<16>>>0)|0}n.mul=Math.imul||t;function r(d,g){return d+g|0}n.add=r;function s(d,g){return d-g|0}n.sub=s;function o(d,g){return d<<g|d>>>32-g}n.rotl=o;function l(d,g){return d<<32-g|d>>>g}n.rotr=l;function v(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d}n.isInteger=Number.isInteger||v,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(d){return n.isInteger(d)&&d>=-n.MAX_SAFE_INTEGER&&d<=n.MAX_SAFE_INTEGER}})(Uf);Object.defineProperty(Le,"__esModule",{value:!0});var Ff=Uf;function T_(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}Le.readInt16BE=T_;function R_(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}Le.readUint16BE=R_;function U_(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}Le.readInt16LE=U_;function F_(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}Le.readUint16LE=F_;function Lf(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}Le.writeUint16BE=Lf;Le.writeInt16BE=Lf;function $f(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}Le.writeUint16LE=$f;Le.writeInt16LE=$f;function Ac(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}Le.readInt32BE=Ac;function Oc(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}Le.readUint32BE=Oc;function Pc(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}Le.readInt32LE=Pc;function Nc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}Le.readUint32LE=Nc;function Da(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}Le.writeUint32BE=Da;Le.writeInt32BE=Da;function Sa(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}Le.writeUint32LE=Sa;Le.writeInt32LE=Sa;function L_(n,t){t===void 0&&(t=0);var r=Ac(n,t),s=Ac(n,t+4);return r*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=L_;function $_(n,t){t===void 0&&(t=0);var r=Oc(n,t),s=Oc(n,t+4);return r*4294967296+s}Le.readUint64BE=$_;function M_(n,t){t===void 0&&(t=0);var r=Pc(n,t),s=Pc(n,t+4);return s*4294967296+r-(r>>31)*4294967296}Le.readInt64LE=M_;function j_(n,t){t===void 0&&(t=0);var r=Nc(n,t),s=Nc(n,t+4);return s*4294967296+r}Le.readUint64LE=j_;function Mf(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Da(n/4294967296>>>0,t,r),Da(n>>>0,t,r+4),t}Le.writeUint64BE=Mf;Le.writeInt64BE=Mf;function jf(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Sa(n>>>0,t,r),Sa(n/4294967296>>>0,t,r+4),t}Le.writeUint64LE=jf;Le.writeInt64LE=jf;function z_(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,l=n/8+r-1;l>=r;l--)s+=t[l]*o,o*=256;return s}Le.readUintBE=z_;function q_(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,l=r;l<r+n/8;l++)s+=t[l]*o,o*=256;return s}Le.readUintLE=q_;function H_(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ff.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,l=n/8+s-1;l>=s;l--)r[l]=t/o&255,o*=256;return r}Le.writeUintBE=H_;function B_(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ff.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,l=s;l<s+n/8;l++)r[l]=t/o&255,o*=256;return r}Le.writeUintLE=B_;function K_(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}Le.readFloat32BE=K_;function V_(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}Le.readFloat32LE=V_;function k_(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}Le.readFloat64BE=k_;function G_(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}Le.readFloat64LE=G_;function W_(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}Le.writeFloat32BE=W_;function Y_(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}Le.writeFloat32LE=Y_;function J_(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}Le.writeFloat64BE=J_;function X_(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}Le.writeFloat64LE=X_;var Er={};Object.defineProperty(Er,"__esModule",{value:!0});function Z_(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Er.wipe=Z_;Object.defineProperty(Oa,"__esModule",{value:!0});var Xt=Le,Tc=Er,Q_=20;function eb(n,t,r){for(var s=1634760805,o=857760878,l=2036477234,v=1797285236,d=r[3]<<24|r[2]<<16|r[1]<<8|r[0],g=r[7]<<24|r[6]<<16|r[5]<<8|r[4],w=r[11]<<24|r[10]<<16|r[9]<<8|r[8],S=r[15]<<24|r[14]<<16|r[13]<<8|r[12],F=r[19]<<24|r[18]<<16|r[17]<<8|r[16],q=r[23]<<24|r[22]<<16|r[21]<<8|r[20],L=r[27]<<24|r[26]<<16|r[25]<<8|r[24],$=r[31]<<24|r[30]<<16|r[29]<<8|r[28],B=t[3]<<24|t[2]<<16|t[1]<<8|t[0],G=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ie=t[11]<<24|t[10]<<16|t[9]<<8|t[8],A=t[15]<<24|t[14]<<16|t[13]<<8|t[12],R=s,D=o,x=l,b=v,c=d,_=g,K=w,k=S,ae=F,ce=q,ge=L,P=$,z=B,le=G,te=ie,W=A,ee=0;ee<Q_;ee+=2)R=R+c|0,z^=R,z=z>>>32-16|z<<16,ae=ae+z|0,c^=ae,c=c>>>32-12|c<<12,D=D+_|0,le^=D,le=le>>>32-16|le<<16,ce=ce+le|0,_^=ce,_=_>>>32-12|_<<12,x=x+K|0,te^=x,te=te>>>32-16|te<<16,ge=ge+te|0,K^=ge,K=K>>>32-12|K<<12,b=b+k|0,W^=b,W=W>>>32-16|W<<16,P=P+W|0,k^=P,k=k>>>32-12|k<<12,x=x+K|0,te^=x,te=te>>>32-8|te<<8,ge=ge+te|0,K^=ge,K=K>>>32-7|K<<7,b=b+k|0,W^=b,W=W>>>32-8|W<<8,P=P+W|0,k^=P,k=k>>>32-7|k<<7,D=D+_|0,le^=D,le=le>>>32-8|le<<8,ce=ce+le|0,_^=ce,_=_>>>32-7|_<<7,R=R+c|0,z^=R,z=z>>>32-8|z<<8,ae=ae+z|0,c^=ae,c=c>>>32-7|c<<7,R=R+_|0,W^=R,W=W>>>32-16|W<<16,ge=ge+W|0,_^=ge,_=_>>>32-12|_<<12,D=D+K|0,z^=D,z=z>>>32-16|z<<16,P=P+z|0,K^=P,K=K>>>32-12|K<<12,x=x+k|0,le^=x,le=le>>>32-16|le<<16,ae=ae+le|0,k^=ae,k=k>>>32-12|k<<12,b=b+c|0,te^=b,te=te>>>32-16|te<<16,ce=ce+te|0,c^=ce,c=c>>>32-12|c<<12,x=x+k|0,le^=x,le=le>>>32-8|le<<8,ae=ae+le|0,k^=ae,k=k>>>32-7|k<<7,b=b+c|0,te^=b,te=te>>>32-8|te<<8,ce=ce+te|0,c^=ce,c=c>>>32-7|c<<7,D=D+K|0,z^=D,z=z>>>32-8|z<<8,P=P+z|0,K^=P,K=K>>>32-7|K<<7,R=R+_|0,W^=R,W=W>>>32-8|W<<8,ge=ge+W|0,_^=ge,_=_>>>32-7|_<<7;Xt.writeUint32LE(R+s|0,n,0),Xt.writeUint32LE(D+o|0,n,4),Xt.writeUint32LE(x+l|0,n,8),Xt.writeUint32LE(b+v|0,n,12),Xt.writeUint32LE(c+d|0,n,16),Xt.writeUint32LE(_+g|0,n,20),Xt.writeUint32LE(K+w|0,n,24),Xt.writeUint32LE(k+S|0,n,28),Xt.writeUint32LE(ae+F|0,n,32),Xt.writeUint32LE(ce+q|0,n,36),Xt.writeUint32LE(ge+L|0,n,40),Xt.writeUint32LE(P+$|0,n,44),Xt.writeUint32LE(z+B|0,n,48),Xt.writeUint32LE(le+G|0,n,52),Xt.writeUint32LE(te+ie|0,n,56),Xt.writeUint32LE(W+A|0,n,60)}function zf(n,t,r,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,v;if(o===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),v=l.length-t.length,l.set(t,v)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=t,v=o}for(var d=new Uint8Array(64),g=0;g<r.length;g+=64){eb(d,l,n);for(var w=g;w<g+64&&w<r.length;w++)s[w]=r[w]^d[w-g];rb(l,0,v)}return Tc.wipe(d),o===0&&Tc.wipe(l),s}Oa.streamXOR=zf;function tb(n,t,r,s){return s===void 0&&(s=0),Tc.wipe(r),zf(n,t,r,r,s)}Oa.stream=tb;function rb(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var qf={},Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});function ib(n,t,r){return~(n-1)&t|n-1&r}Ai.select=ib;function nb(n,t){return(n|0)-(t|0)-1>>>31&1}Ai.lessOrEqual=nb;function Hf(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Ai.compare=Hf;function sb(n,t){return n.length===0||t.length===0?!1:Hf(n,t)!==0}Ai.equal=sb;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ai,r=Er;n.DIGEST_LENGTH=16;var s=function(){function v(d){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=d[0]|d[1]<<8;this._r[0]=g&8191;var w=d[2]|d[3]<<8;this._r[1]=(g>>>13|w<<3)&8191;var S=d[4]|d[5]<<8;this._r[2]=(w>>>10|S<<6)&7939;var F=d[6]|d[7]<<8;this._r[3]=(S>>>7|F<<9)&8191;var q=d[8]|d[9]<<8;this._r[4]=(F>>>4|q<<12)&255,this._r[5]=q>>>1&8190;var L=d[10]|d[11]<<8;this._r[6]=(q>>>14|L<<2)&8191;var $=d[12]|d[13]<<8;this._r[7]=(L>>>11|$<<5)&8065;var B=d[14]|d[15]<<8;this._r[8]=($>>>8|B<<8)&8191,this._r[9]=B>>>5&127,this._pad[0]=d[16]|d[17]<<8,this._pad[1]=d[18]|d[19]<<8,this._pad[2]=d[20]|d[21]<<8,this._pad[3]=d[22]|d[23]<<8,this._pad[4]=d[24]|d[25]<<8,this._pad[5]=d[26]|d[27]<<8,this._pad[6]=d[28]|d[29]<<8,this._pad[7]=d[30]|d[31]<<8}return v.prototype._blocks=function(d,g,w){for(var S=this._fin?0:2048,F=this._h[0],q=this._h[1],L=this._h[2],$=this._h[3],B=this._h[4],G=this._h[5],ie=this._h[6],A=this._h[7],R=this._h[8],D=this._h[9],x=this._r[0],b=this._r[1],c=this._r[2],_=this._r[3],K=this._r[4],k=this._r[5],ae=this._r[6],ce=this._r[7],ge=this._r[8],P=this._r[9];w>=16;){var z=d[g+0]|d[g+1]<<8;F+=z&8191;var le=d[g+2]|d[g+3]<<8;q+=(z>>>13|le<<3)&8191;var te=d[g+4]|d[g+5]<<8;L+=(le>>>10|te<<6)&8191;var W=d[g+6]|d[g+7]<<8;$+=(te>>>7|W<<9)&8191;var ee=d[g+8]|d[g+9]<<8;B+=(W>>>4|ee<<12)&8191,G+=ee>>>1&8191;var Y=d[g+10]|d[g+11]<<8;ie+=(ee>>>14|Y<<2)&8191;var re=d[g+12]|d[g+13]<<8;A+=(Y>>>11|re<<5)&8191;var xe=d[g+14]|d[g+15]<<8;R+=(re>>>8|xe<<8)&8191,D+=xe>>>5|S;var ne=0,be=ne;be+=F*x,be+=q*(5*P),be+=L*(5*ge),be+=$*(5*ce),be+=B*(5*ae),ne=be>>>13,be&=8191,be+=G*(5*k),be+=ie*(5*K),be+=A*(5*_),be+=R*(5*c),be+=D*(5*b),ne+=be>>>13,be&=8191;var ue=ne;ue+=F*b,ue+=q*x,ue+=L*(5*P),ue+=$*(5*ge),ue+=B*(5*ce),ne=ue>>>13,ue&=8191,ue+=G*(5*ae),ue+=ie*(5*k),ue+=A*(5*K),ue+=R*(5*_),ue+=D*(5*c),ne+=ue>>>13,ue&=8191;var ye=ne;ye+=F*c,ye+=q*b,ye+=L*x,ye+=$*(5*P),ye+=B*(5*ge),ne=ye>>>13,ye&=8191,ye+=G*(5*ce),ye+=ie*(5*ae),ye+=A*(5*k),ye+=R*(5*K),ye+=D*(5*_),ne+=ye>>>13,ye&=8191;var j=ne;j+=F*_,j+=q*c,j+=L*b,j+=$*x,j+=B*(5*P),ne=j>>>13,j&=8191,j+=G*(5*ge),j+=ie*(5*ce),j+=A*(5*ae),j+=R*(5*k),j+=D*(5*K),ne+=j>>>13,j&=8191;var M=ne;M+=F*K,M+=q*_,M+=L*c,M+=$*b,M+=B*x,ne=M>>>13,M&=8191,M+=G*(5*P),M+=ie*(5*ge),M+=A*(5*ce),M+=R*(5*ae),M+=D*(5*k),ne+=M>>>13,M&=8191;var O=ne;O+=F*k,O+=q*K,O+=L*_,O+=$*c,O+=B*b,ne=O>>>13,O&=8191,O+=G*x,O+=ie*(5*P),O+=A*(5*ge),O+=R*(5*ce),O+=D*(5*ae),ne+=O>>>13,O&=8191;var h=ne;h+=F*ae,h+=q*k,h+=L*K,h+=$*_,h+=B*c,ne=h>>>13,h&=8191,h+=G*b,h+=ie*x,h+=A*(5*P),h+=R*(5*ge),h+=D*(5*ce),ne+=h>>>13,h&=8191;var I=ne;I+=F*ce,I+=q*ae,I+=L*k,I+=$*K,I+=B*_,ne=I>>>13,I&=8191,I+=G*c,I+=ie*b,I+=A*x,I+=R*(5*P),I+=D*(5*ge),ne+=I>>>13,I&=8191;var se=ne;se+=F*ge,se+=q*ce,se+=L*ae,se+=$*k,se+=B*K,ne=se>>>13,se&=8191,se+=G*_,se+=ie*c,se+=A*b,se+=R*x,se+=D*(5*P),ne+=se>>>13,se&=8191;var fe=ne;fe+=F*P,fe+=q*ge,fe+=L*ce,fe+=$*ae,fe+=B*k,ne=fe>>>13,fe&=8191,fe+=G*K,fe+=ie*_,fe+=A*c,fe+=R*b,fe+=D*x,ne+=fe>>>13,fe&=8191,ne=(ne<<2)+ne|0,ne=ne+be|0,be=ne&8191,ne=ne>>>13,ue+=ne,F=be,q=ue,L=ye,$=j,B=M,G=O,ie=h,A=I,R=se,D=fe,g+=16,w-=16}this._h[0]=F,this._h[1]=q,this._h[2]=L,this._h[3]=$,this._h[4]=B,this._h[5]=G,this._h[6]=ie,this._h[7]=A,this._h[8]=R,this._h[9]=D},v.prototype.finish=function(d,g){g===void 0&&(g=0);var w=new Uint16Array(10),S,F,q,L;if(this._leftover){for(L=this._leftover,this._buffer[L++]=1;L<16;L++)this._buffer[L]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(S=this._h[1]>>>13,this._h[1]&=8191,L=2;L<10;L++)this._h[L]+=S,S=this._h[L]>>>13,this._h[L]&=8191;for(this._h[0]+=S*5,S=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=S,S=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=S,w[0]=this._h[0]+5,S=w[0]>>>13,w[0]&=8191,L=1;L<10;L++)w[L]=this._h[L]+S,S=w[L]>>>13,w[L]&=8191;for(w[9]-=8192,F=(S^1)-1,L=0;L<10;L++)w[L]&=F;for(F=~F,L=0;L<10;L++)this._h[L]=this._h[L]&F|w[L];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,q=this._h[0]+this._pad[0],this._h[0]=q&65535,L=1;L<8;L++)q=(this._h[L]+this._pad[L]|0)+(q>>>16)|0,this._h[L]=q&65535;return d[g+0]=this._h[0]>>>0,d[g+1]=this._h[0]>>>8,d[g+2]=this._h[1]>>>0,d[g+3]=this._h[1]>>>8,d[g+4]=this._h[2]>>>0,d[g+5]=this._h[2]>>>8,d[g+6]=this._h[3]>>>0,d[g+7]=this._h[3]>>>8,d[g+8]=this._h[4]>>>0,d[g+9]=this._h[4]>>>8,d[g+10]=this._h[5]>>>0,d[g+11]=this._h[5]>>>8,d[g+12]=this._h[6]>>>0,d[g+13]=this._h[6]>>>8,d[g+14]=this._h[7]>>>0,d[g+15]=this._h[7]>>>8,this._finished=!0,this},v.prototype.update=function(d){var g=0,w=d.length,S;if(this._leftover){S=16-this._leftover,S>w&&(S=w);for(var F=0;F<S;F++)this._buffer[this._leftover+F]=d[g+F];if(w-=S,g+=S,this._leftover+=S,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(w>=16&&(S=w-w%16,this._blocks(d,g,S),g+=S,w-=S),w){for(var F=0;F<w;F++)this._buffer[this._leftover+F]=d[g+F];this._leftover+=w}return this},v.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var d=new Uint8Array(16);return this.finish(d),d},v.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},v}();n.Poly1305=s;function o(v,d){var g=new s(v);g.update(d);var w=g.digest();return g.clean(),w}n.oneTimeAuth=o;function l(v,d){return v.length!==n.DIGEST_LENGTH||d.length!==n.DIGEST_LENGTH?!1:t.equal(v,d)}n.equal=l})(qf);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Oa,r=qf,s=Er,o=Le,l=Ai;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var v=new Uint8Array(16),d=function(){function g(w){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,w.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(w)}return g.prototype.seal=function(w,S,F,q){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var L=new Uint8Array(16);L.set(w,L.length-w.length);var $=new Uint8Array(32);t.stream(this._key,L,$,4);var B=S.length+this.tagLength,G;if(q){if(q.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");G=q}else G=new Uint8Array(B);return t.streamXOR(this._key,L,S,G,4),this._authenticate(G.subarray(G.length-this.tagLength,G.length),$,G.subarray(0,G.length-this.tagLength),F),s.wipe(L),G},g.prototype.open=function(w,S,F,q){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(S.length<this.tagLength)return null;var L=new Uint8Array(16);L.set(w,L.length-w.length);var $=new Uint8Array(32);t.stream(this._key,L,$,4);var B=new Uint8Array(this.tagLength);if(this._authenticate(B,$,S.subarray(0,S.length-this.tagLength),F),!l.equal(B,S.subarray(S.length-this.tagLength,S.length)))return null;var G=S.length-this.tagLength,ie;if(q){if(q.length!==G)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=q}else ie=new Uint8Array(G);return t.streamXOR(this._key,L,S.subarray(0,S.length-this.tagLength),ie,4),s.wipe(L),ie},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(w,S,F,q){var L=new r.Poly1305(S);q&&(L.update(q),q.length%16>0&&L.update(v.subarray(q.length%16))),L.update(F),F.length%16>0&&L.update(v.subarray(F.length%16));var $=new Uint8Array(8);q&&o.writeUint64LE(q.length,$),L.update($),o.writeUint64LE(F.length,$),L.update($);for(var B=L.digest(),G=0;G<B.length;G++)w[G]=B[G];L.clean(),s.wipe(B),s.wipe($)},g}();n.ChaCha20Poly1305=d})(Jc);var Bf={},os={},Xc={};Object.defineProperty(Xc,"__esModule",{value:!0});function ab(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}Xc.isSerializableHash=ab;Object.defineProperty(os,"__esModule",{value:!0});var Jr=Xc,ob=Ai,cb=Er,Kf=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Jr.isSerializableHash(this._inner)&&Jr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),cb.wipe(s)}return n.prototype.reset=function(){if(!Jr.isSerializableHash(this._inner)||!Jr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Jr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Jr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!Jr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!Jr.isSerializableHash(this._inner)||!Jr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!Jr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();os.HMAC=Kf;function ub(n,t,r){var s=new Kf(n,t);s.update(r);var o=s.digest();return s.clean(),o}os.hmac=ub;os.equal=ob.equal;Object.defineProperty(Bf,"__esModule",{value:!0});var ll=os,fl=Er,hb=function(){function n(t,r,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=o;var l=ll.hmac(this._hash,s,r);this._hmac=new ll.HMAC(t,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),fl.wipe(this._buffer),fl.wipe(this._counter),this._bufpos=0},n}(),lb=Bf.HKDF=hb,Cn={},Pa={},Na={};Object.defineProperty(Na,"__esModule",{value:!0});Na.BrowserRandomSource=void 0;const dl=65536;class fb{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=dl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,dl)));return r}}Na.BrowserRandomSource=fb;var Ta={};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.NodeRandomSource=void 0;const db=Er;class pb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof g_<"u"){const t=v_;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let o=0;o<s.length;o++)s[o]=r[o];return(0,db.wipe)(r),s}}Ta.NodeRandomSource=pb;Object.defineProperty(Pa,"__esModule",{value:!0});Pa.SystemRandomSource=void 0;const gb=Na,vb=Ta;class yb{constructor(){if(this.isAvailable=!1,this.name="",this._source=new gb.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new vb.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Pa.SystemRandomSource=yb;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=Pa,r=Le,s=Er;n.defaultRandomSource=new t.SystemRandomSource;function o(w,S=n.defaultRandomSource){return S.randomBytes(w)}n.randomBytes=o;function l(w=n.defaultRandomSource){const S=o(4,w),F=(0,r.readUint32LE)(S);return(0,s.wipe)(S),F}n.randomUint32=l;const v="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function d(w,S=v,F=n.defaultRandomSource){if(S.length<2)throw new Error("randomString charset is too short");if(S.length>256)throw new Error("randomString charset is too long");let q="";const L=S.length,$=256-256%L;for(;w>0;){const B=o(Math.ceil(w*256/$),F);for(let G=0;G<B.length&&w>0;G++){const ie=B[G];ie<$&&(q+=S.charAt(ie%L),w--)}(0,s.wipe)(B)}return q}n.randomString=d;function g(w,S=v,F=n.defaultRandomSource){const q=Math.ceil(w/(Math.log(S.length)/Math.LN2));return d(q,S,F)}n.randomStringForEntropy=g})(Cn);var Ra={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Le,r=Er;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},d.prototype.update=function(g,w){if(w===void 0&&(w=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var S=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&w>0;)this._buffer[this._bufferLength++]=g[S++],w--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(S=l(this._temp,this._state,g,S,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=g[S++],w--;return this},d.prototype.finish=function(g){if(!this._finished){var w=this._bytesHashed,S=this._bufferLength,F=w/536870912|0,q=w<<3,L=w%64<56?64:128;this._buffer[S]=128;for(var $=S+1;$<L-8;$++)this._buffer[$]=0;t.writeUint32BE(F,this._buffer,L-8),t.writeUint32BE(q,this._buffer,L-4),l(this._temp,this._state,this._buffer,0,L),this._finished=!0}for(var $=0;$<this.digestLength/4;$++)t.writeUint32BE(this._state[$],g,$*4);return this},d.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(g){r.wipe(g.state),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},d}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(d,g,w,S,F){for(;F>=64;){for(var q=g[0],L=g[1],$=g[2],B=g[3],G=g[4],ie=g[5],A=g[6],R=g[7],D=0;D<16;D++){var x=S+D*4;d[D]=t.readUint32BE(w,x)}for(var D=16;D<64;D++){var b=d[D-2],c=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=d[D-15];var _=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;d[D]=(c+d[D-7]|0)+(_+d[D-16]|0)}for(var D=0;D<64;D++){var c=(((G>>>6|G<<26)^(G>>>11|G<<21)^(G>>>25|G<<7))+(G&ie^~G&A)|0)+(R+(o[D]+d[D]|0)|0)|0,_=((q>>>2|q<<32-2)^(q>>>13|q<<32-13)^(q>>>22|q<<32-22))+(q&L^q&$^L&$)|0;R=A,A=ie,ie=G,G=B+c|0,B=$,$=L,L=q,q=c+_|0}g[0]+=q,g[1]+=L,g[2]+=$,g[3]+=B,g[4]+=G,g[5]+=ie,g[6]+=A,g[7]+=R,S+=64,F-=64}return S}function v(d){var g=new s;g.update(d);var w=g.digest();return g.clean(),w}n.hash=v})(Ra);var Zc={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=Cn,r=Er;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(D){const x=new Float64Array(16);if(D)for(let b=0;b<D.length;b++)x[b]=D[b];return x}const o=new Uint8Array(32);o[0]=9;const l=s([56129,1]);function v(D){let x=1;for(let b=0;b<16;b++){let c=D[b]+x+65535;x=Math.floor(c/65536),D[b]=c-x*65536}D[0]+=x-1+37*(x-1)}function d(D,x,b){const c=~(b-1);for(let _=0;_<16;_++){const K=c&(D[_]^x[_]);D[_]^=K,x[_]^=K}}function g(D,x){const b=s(),c=s();for(let _=0;_<16;_++)c[_]=x[_];v(c),v(c),v(c);for(let _=0;_<2;_++){b[0]=c[0]-65517;for(let k=1;k<15;k++)b[k]=c[k]-65535-(b[k-1]>>16&1),b[k-1]&=65535;b[15]=c[15]-32767-(b[14]>>16&1);const K=b[15]>>16&1;b[14]&=65535,d(c,b,1-K)}for(let _=0;_<16;_++)D[2*_]=c[_]&255,D[2*_+1]=c[_]>>8}function w(D,x){for(let b=0;b<16;b++)D[b]=x[2*b]+(x[2*b+1]<<8);D[15]&=32767}function S(D,x,b){for(let c=0;c<16;c++)D[c]=x[c]+b[c]}function F(D,x,b){for(let c=0;c<16;c++)D[c]=x[c]-b[c]}function q(D,x,b){let c,_,K=0,k=0,ae=0,ce=0,ge=0,P=0,z=0,le=0,te=0,W=0,ee=0,Y=0,re=0,xe=0,ne=0,be=0,ue=0,ye=0,j=0,M=0,O=0,h=0,I=0,se=0,fe=0,Se=0,He=0,Ve=0,$e=0,dt=0,pt=0,je=b[0],Ie=b[1],Re=b[2],Ue=b[3],ze=b[4],Ae=b[5],Fe=b[6],De=b[7],Oe=b[8],Be=b[9],Ce=b[10],ke=b[11],We=b[12],et=b[13],tt=b[14],Je=b[15];c=x[0],K+=c*je,k+=c*Ie,ae+=c*Re,ce+=c*Ue,ge+=c*ze,P+=c*Ae,z+=c*Fe,le+=c*De,te+=c*Oe,W+=c*Be,ee+=c*Ce,Y+=c*ke,re+=c*We,xe+=c*et,ne+=c*tt,be+=c*Je,c=x[1],k+=c*je,ae+=c*Ie,ce+=c*Re,ge+=c*Ue,P+=c*ze,z+=c*Ae,le+=c*Fe,te+=c*De,W+=c*Oe,ee+=c*Be,Y+=c*Ce,re+=c*ke,xe+=c*We,ne+=c*et,be+=c*tt,ue+=c*Je,c=x[2],ae+=c*je,ce+=c*Ie,ge+=c*Re,P+=c*Ue,z+=c*ze,le+=c*Ae,te+=c*Fe,W+=c*De,ee+=c*Oe,Y+=c*Be,re+=c*Ce,xe+=c*ke,ne+=c*We,be+=c*et,ue+=c*tt,ye+=c*Je,c=x[3],ce+=c*je,ge+=c*Ie,P+=c*Re,z+=c*Ue,le+=c*ze,te+=c*Ae,W+=c*Fe,ee+=c*De,Y+=c*Oe,re+=c*Be,xe+=c*Ce,ne+=c*ke,be+=c*We,ue+=c*et,ye+=c*tt,j+=c*Je,c=x[4],ge+=c*je,P+=c*Ie,z+=c*Re,le+=c*Ue,te+=c*ze,W+=c*Ae,ee+=c*Fe,Y+=c*De,re+=c*Oe,xe+=c*Be,ne+=c*Ce,be+=c*ke,ue+=c*We,ye+=c*et,j+=c*tt,M+=c*Je,c=x[5],P+=c*je,z+=c*Ie,le+=c*Re,te+=c*Ue,W+=c*ze,ee+=c*Ae,Y+=c*Fe,re+=c*De,xe+=c*Oe,ne+=c*Be,be+=c*Ce,ue+=c*ke,ye+=c*We,j+=c*et,M+=c*tt,O+=c*Je,c=x[6],z+=c*je,le+=c*Ie,te+=c*Re,W+=c*Ue,ee+=c*ze,Y+=c*Ae,re+=c*Fe,xe+=c*De,ne+=c*Oe,be+=c*Be,ue+=c*Ce,ye+=c*ke,j+=c*We,M+=c*et,O+=c*tt,h+=c*Je,c=x[7],le+=c*je,te+=c*Ie,W+=c*Re,ee+=c*Ue,Y+=c*ze,re+=c*Ae,xe+=c*Fe,ne+=c*De,be+=c*Oe,ue+=c*Be,ye+=c*Ce,j+=c*ke,M+=c*We,O+=c*et,h+=c*tt,I+=c*Je,c=x[8],te+=c*je,W+=c*Ie,ee+=c*Re,Y+=c*Ue,re+=c*ze,xe+=c*Ae,ne+=c*Fe,be+=c*De,ue+=c*Oe,ye+=c*Be,j+=c*Ce,M+=c*ke,O+=c*We,h+=c*et,I+=c*tt,se+=c*Je,c=x[9],W+=c*je,ee+=c*Ie,Y+=c*Re,re+=c*Ue,xe+=c*ze,ne+=c*Ae,be+=c*Fe,ue+=c*De,ye+=c*Oe,j+=c*Be,M+=c*Ce,O+=c*ke,h+=c*We,I+=c*et,se+=c*tt,fe+=c*Je,c=x[10],ee+=c*je,Y+=c*Ie,re+=c*Re,xe+=c*Ue,ne+=c*ze,be+=c*Ae,ue+=c*Fe,ye+=c*De,j+=c*Oe,M+=c*Be,O+=c*Ce,h+=c*ke,I+=c*We,se+=c*et,fe+=c*tt,Se+=c*Je,c=x[11],Y+=c*je,re+=c*Ie,xe+=c*Re,ne+=c*Ue,be+=c*ze,ue+=c*Ae,ye+=c*Fe,j+=c*De,M+=c*Oe,O+=c*Be,h+=c*Ce,I+=c*ke,se+=c*We,fe+=c*et,Se+=c*tt,He+=c*Je,c=x[12],re+=c*je,xe+=c*Ie,ne+=c*Re,be+=c*Ue,ue+=c*ze,ye+=c*Ae,j+=c*Fe,M+=c*De,O+=c*Oe,h+=c*Be,I+=c*Ce,se+=c*ke,fe+=c*We,Se+=c*et,He+=c*tt,Ve+=c*Je,c=x[13],xe+=c*je,ne+=c*Ie,be+=c*Re,ue+=c*Ue,ye+=c*ze,j+=c*Ae,M+=c*Fe,O+=c*De,h+=c*Oe,I+=c*Be,se+=c*Ce,fe+=c*ke,Se+=c*We,He+=c*et,Ve+=c*tt,$e+=c*Je,c=x[14],ne+=c*je,be+=c*Ie,ue+=c*Re,ye+=c*Ue,j+=c*ze,M+=c*Ae,O+=c*Fe,h+=c*De,I+=c*Oe,se+=c*Be,fe+=c*Ce,Se+=c*ke,He+=c*We,Ve+=c*et,$e+=c*tt,dt+=c*Je,c=x[15],be+=c*je,ue+=c*Ie,ye+=c*Re,j+=c*Ue,M+=c*ze,O+=c*Ae,h+=c*Fe,I+=c*De,se+=c*Oe,fe+=c*Be,Se+=c*Ce,He+=c*ke,Ve+=c*We,$e+=c*et,dt+=c*tt,pt+=c*Je,K+=38*ue,k+=38*ye,ae+=38*j,ce+=38*M,ge+=38*O,P+=38*h,z+=38*I,le+=38*se,te+=38*fe,W+=38*Se,ee+=38*He,Y+=38*Ve,re+=38*$e,xe+=38*dt,ne+=38*pt,_=1,c=K+_+65535,_=Math.floor(c/65536),K=c-_*65536,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=ae+_+65535,_=Math.floor(c/65536),ae=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,c=P+_+65535,_=Math.floor(c/65536),P=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=le+_+65535,_=Math.floor(c/65536),le=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=Y+_+65535,_=Math.floor(c/65536),Y=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=xe+_+65535,_=Math.floor(c/65536),xe=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,K+=_-1+37*(_-1),_=1,c=K+_+65535,_=Math.floor(c/65536),K=c-_*65536,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=ae+_+65535,_=Math.floor(c/65536),ae=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,c=P+_+65535,_=Math.floor(c/65536),P=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=le+_+65535,_=Math.floor(c/65536),le=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=Y+_+65535,_=Math.floor(c/65536),Y=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=xe+_+65535,_=Math.floor(c/65536),xe=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,K+=_-1+37*(_-1),D[0]=K,D[1]=k,D[2]=ae,D[3]=ce,D[4]=ge,D[5]=P,D[6]=z,D[7]=le,D[8]=te,D[9]=W,D[10]=ee,D[11]=Y,D[12]=re,D[13]=xe,D[14]=ne,D[15]=be}function L(D,x){q(D,x,x)}function $(D,x){const b=s();for(let c=0;c<16;c++)b[c]=x[c];for(let c=253;c>=0;c--)L(b,b),c!==2&&c!==4&&q(b,b,x);for(let c=0;c<16;c++)D[c]=b[c]}function B(D,x){const b=new Uint8Array(32),c=new Float64Array(80),_=s(),K=s(),k=s(),ae=s(),ce=s(),ge=s();for(let te=0;te<31;te++)b[te]=D[te];b[31]=D[31]&127|64,b[0]&=248,w(c,x);for(let te=0;te<16;te++)K[te]=c[te];_[0]=ae[0]=1;for(let te=254;te>=0;--te){const W=b[te>>>3]>>>(te&7)&1;d(_,K,W),d(k,ae,W),S(ce,_,k),F(_,_,k),S(k,K,ae),F(K,K,ae),L(ae,ce),L(ge,_),q(_,k,_),q(k,K,ce),S(ce,_,k),F(_,_,k),L(K,_),F(k,ae,ge),q(_,k,l),S(_,_,ae),q(k,k,_),q(_,ae,ge),q(ae,K,c),L(K,ce),d(_,K,W),d(k,ae,W)}for(let te=0;te<16;te++)c[te+16]=_[te],c[te+32]=k[te],c[te+48]=K[te],c[te+64]=ae[te];const P=c.subarray(32),z=c.subarray(16);$(P,P),q(z,z,P);const le=new Uint8Array(32);return g(le,z),le}n.scalarMult=B;function G(D){return B(D,o)}n.scalarMultBase=G;function ie(D){if(D.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const x=new Uint8Array(D);return{publicKey:G(x),secretKey:x}}n.generateKeyPairFromSeed=ie;function A(D){const x=(0,t.randomBytes)(32,D),b=ie(x);return(0,r.wipe)(x),b}n.generateKeyPair=A;function R(D,x,b=!1){if(D.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=B(D,x);if(b){let _=0;for(let K=0;K<c.length;K++)_|=c[K];if(_===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=R})(Zc);function Qc(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Vf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Qc(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Rc(n,t){t||(t=n.reduce((o,l)=>o+l.length,0));const r=Vf(t);let s=0;for(const o of n)r.set(o,s),s+=o.length;return Qc(r)}function _b(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var l=n.charAt(o),v=l.charCodeAt(0);if(r[v]!==255)throw new TypeError(l+" is ambiguous");r[v]=o}var d=n.length,g=n.charAt(0),w=Math.log(d)/Math.log(256),S=Math.log(256)/Math.log(d);function F($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var B=0,G=0,ie=0,A=$.length;ie!==A&&$[ie]===0;)ie++,B++;for(var R=(A-ie)*S+1>>>0,D=new Uint8Array(R);ie!==A;){for(var x=$[ie],b=0,c=R-1;(x!==0||b<G)&&c!==-1;c--,b++)x+=256*D[c]>>>0,D[c]=x%d>>>0,x=x/d>>>0;if(x!==0)throw new Error("Non-zero carry");G=b,ie++}for(var _=R-G;_!==R&&D[_]===0;)_++;for(var K=g.repeat(B);_<R;++_)K+=n.charAt(D[_]);return K}function q($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var B=0;if($[B]!==" "){for(var G=0,ie=0;$[B]===g;)G++,B++;for(var A=($.length-B)*w+1>>>0,R=new Uint8Array(A);$[B];){var D=r[$.charCodeAt(B)];if(D===255)return;for(var x=0,b=A-1;(D!==0||x<ie)&&b!==-1;b--,x++)D+=d*R[b]>>>0,R[b]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");ie=x,B++}if($[B]!==" "){for(var c=A-ie;c!==A&&R[c]===0;)c++;for(var _=new Uint8Array(G+(A-c)),K=G;c!==A;)_[K++]=R[c++];return _}}}function L($){var B=q($);if(B)return B;throw new Error(`Non-${t} character`)}return{encode:F,decodeUnsafe:q,decode:L}}var bb=_b,mb=bb;const wb=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Eb=n=>new TextEncoder().encode(n),Db=n=>new TextDecoder().decode(n);class Sb{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Ib{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return kf(this,t)}}class xb{constructor(t){this.decoders=t}or(t){return kf(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const kf=(n,t)=>new xb({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class Cb{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new Sb(t,r,s),this.decoder=new Ib(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ua=({name:n,prefix:t,encode:r,decode:s})=>new Cb(n,t,r,s),cs=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=mb(r,t);return Ua({prefix:n,name:t,encode:s,decode:l=>wb(o(l))})},Ab=(n,t,r,s)=>{const o={};for(let S=0;S<t.length;++S)o[t[S]]=S;let l=n.length;for(;n[l-1]==="=";)--l;const v=new Uint8Array(l*r/8|0);let d=0,g=0,w=0;for(let S=0;S<l;++S){const F=o[n[S]];if(F===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|F,d+=r,d>=8&&(d-=8,v[w++]=255&g>>d)}if(d>=r||255&g<<8-d)throw new SyntaxError("Unexpected end of data");return v},Ob=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let l="",v=0,d=0;for(let g=0;g<n.length;++g)for(d=d<<8|n[g],v+=8;v>r;)v-=r,l+=t[o&d>>v];if(v&&(l+=t[o&d<<r-v]),s)for(;l.length*r&7;)l+="=";return l},Gt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ua({prefix:t,name:n,encode(o){return Ob(o,s,r)},decode(o){return Ab(o,s,r,n)}}),Pb=Ua({prefix:"\0",name:"identity",encode:n=>Db(n),decode:n=>Eb(n)}),Nb=Object.freeze(Object.defineProperty({__proto__:null,identity:Pb},Symbol.toStringTag,{value:"Module"})),Tb=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Rb=Object.freeze(Object.defineProperty({__proto__:null,base2:Tb},Symbol.toStringTag,{value:"Module"})),Ub=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Fb=Object.freeze(Object.defineProperty({__proto__:null,base8:Ub},Symbol.toStringTag,{value:"Module"})),Lb=cs({prefix:"9",name:"base10",alphabet:"0123456789"}),$b=Object.freeze(Object.defineProperty({__proto__:null,base10:Lb},Symbol.toStringTag,{value:"Module"})),Mb=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jb=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),zb=Object.freeze(Object.defineProperty({__proto__:null,base16:Mb,base16upper:jb},Symbol.toStringTag,{value:"Module"})),qb=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hb=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bb=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Kb=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Vb=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kb=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Gb=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Wb=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yb=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Jb=Object.freeze(Object.defineProperty({__proto__:null,base32:qb,base32hex:Vb,base32hexpad:Gb,base32hexpadupper:Wb,base32hexupper:kb,base32pad:Bb,base32padupper:Kb,base32upper:Hb,base32z:Yb},Symbol.toStringTag,{value:"Module"})),Xb=cs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Zb=cs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Qb=Object.freeze(Object.defineProperty({__proto__:null,base36:Xb,base36upper:Zb},Symbol.toStringTag,{value:"Module"})),em=cs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tm=cs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),rm=Object.freeze(Object.defineProperty({__proto__:null,base58btc:em,base58flickr:tm},Symbol.toStringTag,{value:"Module"})),im=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),nm=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sm=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),am=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),om=Object.freeze(Object.defineProperty({__proto__:null,base64:im,base64pad:nm,base64url:sm,base64urlpad:am},Symbol.toStringTag,{value:"Module"})),Gf=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),cm=Gf.reduce((n,t,r)=>(n[r]=t,n),[]),um=Gf.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function hm(n){return n.reduce((t,r)=>(t+=cm[r],t),"")}function lm(n){const t=[];for(const r of n){const s=um[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const fm=Ua({prefix:"ðŸš€",name:"base256emoji",encode:hm,decode:lm}),dm=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:fm},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const pl={...Nb,...Rb,...Fb,...$b,...zb,...Jb,...Qb,...rm,...om,...dm};function Wf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const gl=Wf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),uc=Wf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Vf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Yf={utf8:gl,"utf-8":gl,hex:pl.base16,latin1:uc,ascii:uc,binary:uc,...pl};function gr(n,t="utf8"){const r=Yf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Qc(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function or(n,t="utf8"){const r=Yf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var Ee={},hc={},Wn={},vl;function pm(){if(vl)return Wn;vl=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return Wn.delay=n,Wn}var Ki={},lc={},Vi={},yl;function gm(){return yl||(yl=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.ONE_THOUSAND=Vi.ONE_HUNDRED=void 0,Vi.ONE_HUNDRED=100,Vi.ONE_THOUSAND=1e3),Vi}var fc={},_l;function vm(){return _l||(_l=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(fc)),fc}var bl;function Jf(){return bl||(bl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Br;t.__exportStar(gm(),n),t.__exportStar(vm(),n)}(lc)),lc}var ml;function ym(){if(ml)return Ki;ml=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.fromMiliseconds=Ki.toMiliseconds=void 0;const n=Jf();function t(s){return s*n.ONE_THOUSAND}Ki.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Ki.fromMiliseconds=r,Ki}var wl;function _m(){return wl||(wl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Br;t.__exportStar(pm(),n),t.__exportStar(ym(),n)}(hc)),hc}var Dn={},El;function bm(){if(El)return Dn;El=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const o=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:o})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return Dn.Watch=n,Dn.default=n,Dn}var dc={},Yn={},Dl;function mm(){if(Dl)return Yn;Dl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.IWatch=void 0;class n{}return Yn.IWatch=n,Yn}var Sl;function wm(){return Sl||(Sl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Br.__exportStar(mm(),n)}(dc)),dc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Br;t.__exportStar(_m(),n),t.__exportStar(bm(),n),t.__exportStar(wm(),n),t.__exportStar(Jf(),n)})(Ee);var as={};(function(n){const t=S_,r=I_,s=E_,o=D_,l=A=>A==null,v=Symbol("encodeFragmentIdentifier");function d(A){switch(A.arrayFormat){case"index":return R=>(D,x)=>{const b=D.length;return x===void 0||A.skipNull&&x===null||A.skipEmptyString&&x===""?D:x===null?[...D,[S(R,A),"[",b,"]"].join("")]:[...D,[S(R,A),"[",S(b,A),"]=",S(x,A)].join("")]};case"bracket":return R=>(D,x)=>x===void 0||A.skipNull&&x===null||A.skipEmptyString&&x===""?D:x===null?[...D,[S(R,A),"[]"].join("")]:[...D,[S(R,A),"[]=",S(x,A)].join("")];case"colon-list-separator":return R=>(D,x)=>x===void 0||A.skipNull&&x===null||A.skipEmptyString&&x===""?D:x===null?[...D,[S(R,A),":list="].join("")]:[...D,[S(R,A),":list=",S(x,A)].join("")];case"comma":case"separator":case"bracket-separator":{const R=A.arrayFormat==="bracket-separator"?"[]=":"=";return D=>(x,b)=>b===void 0||A.skipNull&&b===null||A.skipEmptyString&&b===""?x:(b=b===null?"":b,x.length===0?[[S(D,A),R,S(b,A)].join("")]:[[x,S(b,A)].join(A.arrayFormatSeparator)])}default:return R=>(D,x)=>x===void 0||A.skipNull&&x===null||A.skipEmptyString&&x===""?D:x===null?[...D,S(R,A)]:[...D,[S(R,A),"=",S(x,A)].join("")]}}function g(A){let R;switch(A.arrayFormat){case"index":return(D,x,b)=>{if(R=/\[(\d*)\]$/.exec(D),D=D.replace(/\[\d*\]$/,""),!R){b[D]=x;return}b[D]===void 0&&(b[D]={}),b[D][R[1]]=x};case"bracket":return(D,x,b)=>{if(R=/(\[\])$/.exec(D),D=D.replace(/\[\]$/,""),!R){b[D]=x;return}if(b[D]===void 0){b[D]=[x];return}b[D]=[].concat(b[D],x)};case"colon-list-separator":return(D,x,b)=>{if(R=/(:list)$/.exec(D),D=D.replace(/:list$/,""),!R){b[D]=x;return}if(b[D]===void 0){b[D]=[x];return}b[D]=[].concat(b[D],x)};case"comma":case"separator":return(D,x,b)=>{const c=typeof x=="string"&&x.includes(A.arrayFormatSeparator),_=typeof x=="string"&&!c&&F(x,A).includes(A.arrayFormatSeparator);x=_?F(x,A):x;const K=c||_?x.split(A.arrayFormatSeparator).map(k=>F(k,A)):x===null?x:F(x,A);b[D]=K};case"bracket-separator":return(D,x,b)=>{const c=/(\[\])$/.test(D);if(D=D.replace(/\[\]$/,""),!c){b[D]=x&&F(x,A);return}const _=x===null?[]:x.split(A.arrayFormatSeparator).map(K=>F(K,A));if(b[D]===void 0){b[D]=_;return}b[D]=[].concat(b[D],_)};default:return(D,x,b)=>{if(b[D]===void 0){b[D]=x;return}b[D]=[].concat(b[D],x)}}}function w(A){if(typeof A!="string"||A.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(A,R){return R.encode?R.strict?t(A):encodeURIComponent(A):A}function F(A,R){return R.decode?r(A):A}function q(A){return Array.isArray(A)?A.sort():typeof A=="object"?q(Object.keys(A)).sort((R,D)=>Number(R)-Number(D)).map(R=>A[R]):A}function L(A){const R=A.indexOf("#");return R!==-1&&(A=A.slice(0,R)),A}function $(A){let R="";const D=A.indexOf("#");return D!==-1&&(R=A.slice(D)),R}function B(A){A=L(A);const R=A.indexOf("?");return R===-1?"":A.slice(R+1)}function G(A,R){return R.parseNumbers&&!Number.isNaN(Number(A))&&typeof A=="string"&&A.trim()!==""?A=Number(A):R.parseBooleans&&A!==null&&(A.toLowerCase()==="true"||A.toLowerCase()==="false")&&(A=A.toLowerCase()==="true"),A}function ie(A,R){R=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},R),w(R.arrayFormatSeparator);const D=g(R),x=Object.create(null);if(typeof A!="string"||(A=A.trim().replace(/^[?#&]/,""),!A))return x;for(const b of A.split("&")){if(b==="")continue;let[c,_]=s(R.decode?b.replace(/\+/g," "):b,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(R.arrayFormat)?_:F(_,R),D(F(c,R),_,x)}for(const b of Object.keys(x)){const c=x[b];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=G(c[_],R);else x[b]=G(c,R)}return R.sort===!1?x:(R.sort===!0?Object.keys(x).sort():Object.keys(x).sort(R.sort)).reduce((b,c)=>{const _=x[c];return _&&typeof _=="object"&&!Array.isArray(_)?b[c]=q(_):b[c]=_,b},Object.create(null))}n.extract=B,n.parse=ie,n.stringify=(A,R)=>{if(!A)return"";R=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},R),w(R.arrayFormatSeparator);const D=_=>R.skipNull&&l(A[_])||R.skipEmptyString&&A[_]==="",x=d(R),b={};for(const _ of Object.keys(A))D(_)||(b[_]=A[_]);const c=Object.keys(b);return R.sort!==!1&&c.sort(R.sort),c.map(_=>{const K=A[_];return K===void 0?"":K===null?S(_,R):Array.isArray(K)?K.length===0&&R.arrayFormat==="bracket-separator"?S(_,R)+"[]":K.reduce(x(_),[]).join("&"):S(_,R)+"="+S(K,R)}).filter(_=>_.length>0).join("&")},n.parseUrl=(A,R)=>{R=Object.assign({decode:!0},R);const[D,x]=s(A,"#");return Object.assign({url:D.split("?")[0]||"",query:ie(B(A),R)},R&&R.parseFragmentIdentifier&&x?{fragmentIdentifier:F(x,R)}:{})},n.stringifyUrl=(A,R)=>{R=Object.assign({encode:!0,strict:!0,[v]:!0},R);const D=L(A.url).split("?")[0]||"",x=n.extract(A.url),b=n.parse(x,{sort:!1}),c=Object.assign(b,A.query);let _=n.stringify(c,R);_&&(_=`?${_}`);let K=$(A.url);return A.fragmentIdentifier&&(K=`#${R[v]?S(A.fragmentIdentifier,R):A.fragmentIdentifier}`),`${D}${_}${K}`},n.pick=(A,R,D)=>{D=Object.assign({parseFragmentIdentifier:!0,[v]:!1},D);const{url:x,query:b,fragmentIdentifier:c}=n.parseUrl(A,D);return n.stringifyUrl({url:x,query:o(b,R),fragmentIdentifier:c},D)},n.exclude=(A,R,D)=>{const x=Array.isArray(R)?b=>!R.includes(b):(b,c)=>!R(b,c);return n.pick(A,x,D)}})(as);const Em={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Dm(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const o=n[s];r.push(...o.accounts)}),r}function Xf(n,t){return n.includes(":")?[n]:t.chains||[]}const Zf="base10",ar="base16",Uc="base64pad",eu="utf8",Qf=0,Qi=1,Sm=0,Il=1,Fc=12,tu=32;function Im(){const n=Zc.generateKeyPair();return{privateKey:or(n.secretKey,ar),publicKey:or(n.publicKey,ar)}}function Lc(){const n=Cn.randomBytes(tu);return or(n,ar)}function xm(n,t){const r=Zc.sharedKey(gr(n,ar),gr(t,ar)),s=new lb(Ra.SHA256,r).expand(tu);return or(s,ar)}function Cm(n){const t=Ra.hash(gr(n,ar));return or(t,ar)}function Xi(n){const t=Ra.hash(gr(n,eu));return or(t,ar)}function Am(n){return gr(`${n}`,Zf)}function us(n){return Number(or(n,Zf))}function Om(n){const t=Am(typeof n.type<"u"?n.type:Qf);if(us(t)===Qi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?gr(n.senderPublicKey,ar):void 0,s=typeof n.iv<"u"?gr(n.iv,ar):Cn.randomBytes(Fc),o=new Jc.ChaCha20Poly1305(gr(n.symKey,ar)).seal(s,gr(n.message,eu));return Nm({type:t,sealed:o,iv:s,senderPublicKey:r})}function Pm(n){const t=new Jc.ChaCha20Poly1305(gr(n.symKey,ar)),{sealed:r,iv:s}=Ia(n.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return or(o,eu)}function Nm(n){if(us(n.type)===Qi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return or(Rc([n.type,n.senderPublicKey,n.iv,n.sealed]),Uc)}return or(Rc([n.type,n.iv,n.sealed]),Uc)}function Ia(n){const t=gr(n,Uc),r=t.slice(Sm,Il),s=Il;if(us(r)===Qi){const d=s+tu,g=d+Fc,w=t.slice(s,d),S=t.slice(d,g),F=t.slice(g);return{type:r,sealed:F,iv:S,senderPublicKey:w}}const o=s+Fc,l=t.slice(s,o),v=t.slice(o);return{type:r,sealed:v,iv:l}}function Tm(n,t){const r=Ia(n);return ed({type:us(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?or(r.senderPublicKey,ar):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function ed(n){const t=(n==null?void 0:n.type)||Qf;if(t===Qi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function xl(n){return n.type===Qi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Rm=Object.defineProperty,Cl=Object.getOwnPropertySymbols,Um=Object.prototype.hasOwnProperty,Fm=Object.prototype.propertyIsEnumerable,Al=(n,t,r)=>t in n?Rm(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ol=(n,t)=>{for(var r in t||(t={}))Um.call(t,r)&&Al(n,r,t[r]);if(Cl)for(var r of Cl(t))Fm.call(t,r)&&Al(n,r,t[r]);return n};const Lm="ReactNative",Yi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},$m="js";function ru(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function td(){return!C_()&&!!Nf()&&navigator.product===Lm}function iu(){return!ru()&&!!Nf()}function rd(){return td()?Yi.reactNative:ru()?Yi.node:iu()?Yi.browser:Yi.unknown}function Mm(n,t){let r=as.parse(n);return r=Ol(Ol({},r),t),n=as.stringify(r),n}function jm(){return x_()||{name:"",description:"",url:"",icons:[""]}}function zm(){const n=y_();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function qm(){var n;const t=rd();return t===Yi.browser?[t,((n=A_())==null?void 0:n.host)||"unknown"].join(":"):t}function Hm(n,t,r){const s=zm(),o=qm();return[[n,t].join("-"),[$m,r].join("-"),s,o].join("/")}function Bm({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:l,useOnCloseEvent:v}){const d=r.split("?"),g=Hm(n,t,s),w={auth:o,ua:g,projectId:l,useOnCloseEvent:v||void 0},S=Mm(d[1]||"",w);return d[0]+"?"+S}function Ji(n,t){return n.filter(r=>t.includes(r)).length===n.length}function id(n){return Object.fromEntries(n.entries())}function nd(n){return new Map(Object.entries(n))}function Sn(n=Ee.FIVE_MINUTES,t){const r=Ee.toMiliseconds(n||Ee.FIVE_MINUTES);let s,o,l;return{resolve:v=>{l&&s&&(clearTimeout(l),s(v))},reject:v=>{l&&o&&(clearTimeout(l),o(v))},done:()=>new Promise((v,d)=>{l=setTimeout(()=>{d(new Error(t))},r),s=v,o=d})}}function xa(n,t,r){return new Promise(async(s,o)=>{const l=setTimeout(()=>o(new Error(r)),t);try{const v=await n;s(v)}catch(v){o(v)}clearTimeout(l)})}function sd(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function Km(n){return sd("topic",n)}function Vm(n){return sd("id",n)}function ad(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Hr(n,t){return Ee.fromMiliseconds((t||Date.now())+Ee.toMiliseconds(n))}function Ii(n){return Date.now()>=Ee.toMiliseconds(n)}function jt(n,t){return`${n}${t?`:${t}`:""}`}function pc(n=[],t=[]){return[...new Set([...n,...t])]}const km="irn";function $c(n){return(n==null?void 0:n.relay)||{protocol:km}}function ma(n){const t=Em[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Gm=Object.defineProperty,Pl=Object.getOwnPropertySymbols,Wm=Object.prototype.hasOwnProperty,Ym=Object.prototype.propertyIsEnumerable,Nl=(n,t,r)=>t in n?Gm(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Jm=(n,t)=>{for(var r in t||(t={}))Wm.call(t,r)&&Nl(n,r,t[r]);if(Pl)for(var r of Pl(t))Ym.call(t,r)&&Nl(n,r,t[r]);return n};function Xm(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const l=o.replace(s,""),v=n[o];r[l]=v}}),r}function Zm(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),o=n.substring(t+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",v=as.parse(l);return{protocol:s,topic:o[0],version:parseInt(o[1],10),symKey:v.symKey,relay:Xm(v)}}function Qm(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(o=>{const l=r+t+o;n[o]&&(s[l]=n[o])}),s}function ew(n){return`${n.protocol}:${n.topic}@${n.version}?`+as.stringify(Jm({symKey:n.symKey},Qm(n.relay)))}function An(n){const t=[];return n.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function tw(n){const t=[];return Object.values(n).forEach(r=>{t.push(...An(r.accounts))}),t}function rw(n,t){const r=[];return Object.values(n).forEach(s=>{An(s.accounts).includes(t)&&r.push(...s.methods)}),r}function iw(n,t){const r=[];return Object.values(n).forEach(s=>{An(s.accounts).includes(t)&&r.push(...s.events)}),r}function nw(n,t){const r=Ea(n,t);if(r)throw new Error(r.message);const s={};for(const[o,l]of Object.entries(n))s[o]={methods:l.methods,events:l.events,chains:l.accounts.map(v=>`${v.split(":")[0]}:${v.split(":")[1]}`)};return s}function od(n){return n.includes(":")}function wa(n){return od(n)?n.split(":")[0]:n}const sw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},aw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function he(n,t){const{message:r,code:s}=aw[n];return{message:t?`${r} ${t}`:r,code:s}}function Nt(n,t){const{message:r,code:s}=sw[n];return{message:t?`${r} ${t}`:r,code:s}}function fi(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function xn(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function sr(n){return typeof n>"u"}function Vt(n,t){return t&&sr(n)?!0:typeof n=="string"&&!!n.trim().length}function nu(n,t){return t&&sr(n)?!0:typeof n=="number"&&!isNaN(n)}function ow(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),o=Object.keys(r);let l=!0;return Ji(o,s)?(s.forEach(v=>{const{accounts:d,methods:g,events:w}=n.namespaces[v],S=An(d),F=r[v];(!Ji(Xf(v,F),S)||!Ji(F.methods,g)||!Ji(F.events,w))&&(l=!1)}),l):!1}function su(n){return Vt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function cw(n){if(Vt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&su(r)}}return!1}function uw(n){if(Vt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function hw(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function lw(n){return n==null?void 0:n.topic}function fw(n,t){let r=null;return Vt(n==null?void 0:n.publicKey,!1)||(r=he("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Tl(n){let t=!0;return fi(n)?n.length&&(t=n.every(r=>Vt(r,!1))):t=!1,t}function dw(n,t,r){let s=null;return fi(t)?t.forEach(o=>{s||(!su(o)||!o.includes(n))&&(s=Nt("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):s=Nt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),s}function pw(n,t){let r=null;return Object.entries(n).forEach(([s,o])=>{if(r)return;const l=dw(s,Xf(s,o),`${t} requiredNamespace`);l&&(r=l)}),r}function gw(n,t){let r=null;return fi(n)?n.forEach(s=>{r||cw(s)||(r=Nt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Nt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function vw(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=gw(s==null?void 0:s.accounts,`${t} namespace`);o&&(r=o)}),r}function yw(n,t){let r=null;return Tl(n==null?void 0:n.methods)?Tl(n==null?void 0:n.events)||(r=Nt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Nt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function cd(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=yw(s,`${t}, namespace`);o&&(r=o)}),r}function _w(n,t,r){let s=null;if(n&&xn(n)){const o=cd(n,t);o&&(s=o);const l=pw(n,t);l&&(s=l)}else s=he("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ea(n,t){let r=null;if(n&&xn(n)){const s=cd(n,t);s&&(r=s);const o=vw(n,t);o&&(r=o)}else r=he("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function ud(n){return Vt(n.protocol,!0)}function bw(n,t){let r=!1;return t&&!n?r=!0:n&&fi(n)&&n.length&&n.forEach(s=>{r=ud(s)}),r}function mw(n){return typeof n=="number"}function pr(n){return typeof n<"u"&&typeof n!==null}function ww(n){return!(!n||typeof n!="object"||!n.code||!nu(n.code,!1)||!n.message||!Vt(n.message,!1))}function Ew(n){return!(sr(n)||!Vt(n.method,!1))}function Dw(n){return!(sr(n)||sr(n.result)&&sr(n.error)||!nu(n.id,!1)||!Vt(n.jsonrpc,!1))}function Sw(n){return!(sr(n)||!Vt(n.name,!1))}function Rl(n,t){return!(!su(t)||!tw(n).includes(t))}function Iw(n,t,r){return Vt(r,!1)?rw(n,t).includes(r):!1}function xw(n,t,r){return Vt(r,!1)?iw(n,t).includes(r):!1}function Ul(n,t,r){let s=null;const o=Cw(n),l=Aw(t),v=Object.keys(o),d=Object.keys(l),g=Fl(Object.keys(n)),w=Fl(Object.keys(t)),S=g.filter(F=>!w.includes(F));return S.length&&(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${S.toString()}
      Received: ${Object.keys(t).toString()}`)),Ji(v,d)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${v.toString()}
      Approved: ${d.toString()}`)),Object.keys(t).forEach(F=>{if(!F.includes(":")||s)return;const q=An(t[F].accounts);q.includes(F)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${F}
        Required: ${F}
        Approved: ${q.toString()}`))}),v.forEach(F=>{s||(Ji(o[F].methods,l[F].methods)?Ji(o[F].events,l[F].events)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${F}`)):s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${F}`))}),s}function Cw(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(o=>{t[o]={methods:n[r].methods,events:n[r].events}})}),t}function Fl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function Aw(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=An(n[r].accounts);s==null||s.forEach(o=>{t[o]={accounts:n[r].accounts.filter(l=>l.includes(`${o}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function Ow(n,t){return nu(n,!1)&&n<=t.max&&n>=t.min}var Fa={},hs={};Object.defineProperty(hs,"__esModule",{value:!0});function Pw(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}hs.safeJsonParse=Pw;function Nw(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}hs.safeJsonStringify=Nw;var Jn={exports:{}},Ll;function Tw(){return Ll||(Ll=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Wi<"u"&&Wi.localStorage?Jn.exports=Wi.localStorage:typeof window<"u"&&window.localStorage?Jn.exports=window.localStorage:Jn.exports=new t}()),Jn.exports}var gc={},Xn={},$l;function Rw(){if($l)return Xn;$l=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.IKeyValueStorage=void 0;class n{}return Xn.IKeyValueStorage=n,Xn}var Zn={},Ml;function Uw(){if(Ml)return Zn;Ml=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.parseEntry=void 0;const n=hs;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return Zn.parseEntry=t,Zn}var jl;function Fw(){return jl||(jl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Br;t.__exportStar(Rw(),n),t.__exportStar(Uw(),n)}(gc)),gc}Object.defineProperty(Fa,"__esModule",{value:!0});Fa.KeyValueStorage=void 0;const In=Br,zl=hs,Lw=In.__importDefault(Tw()),$w=Fw();class hd{constructor(){this.localStorage=Lw.default}getKeys(){return In.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return In.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map($w.parseEntry)})}getItem(t){return In.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return zl.safeJsonParse(r)})}setItem(t,r){return In.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,zl.safeJsonStringify(r))})}removeItem(t){return In.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Fa.KeyValueStorage=hd;var Mw=Fa.default=hd,ls={},Qn={},vc={},es={};class en{}const jw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:en},Symbol.toStringTag,{value:"Module"})),zw=__(jw);var ql;function qw(){if(ql)return es;ql=1,Object.defineProperty(es,"__esModule",{value:!0}),es.IHeartBeat=void 0;const n=zw;class t extends n.IEvents{constructor(s){super()}}return es.IHeartBeat=t,es}var Hl;function ld(){return Hl||(Hl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Br.__exportStar(qw(),n)}(vc)),vc}var yc={},ki={},Bl;function Hw(){if(Bl)return ki;Bl=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.HEARTBEAT_EVENTS=ki.HEARTBEAT_INTERVAL=void 0;const n=Ee;return ki.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,ki.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ki}var Kl;function fd(){return Kl||(Kl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Br.__exportStar(Hw(),n)}(yc)),yc}var Vl;function Bw(){if(Vl)return Qn;Vl=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.HeartBeat=void 0;const n=Br,t=b_,r=Ee,s=ld(),o=fd();class l extends s.IHeartBeat{constructor(d){super(d),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||o.HEARTBEAT_INTERVAL}static init(d){return n.__awaiter(this,void 0,void 0,function*(){const g=new l(d);return yield g.init(),g})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,g){this.events.on(d,g)}once(d,g){this.events.once(d,g)}off(d,g){this.events.off(d,g)}removeListener(d,g){this.events.removeListener(d,g)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Qn.HeartBeat=l,Qn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Br;t.__exportStar(Bw(),n),t.__exportStar(ld(),n),t.__exportStar(fd(),n)})(ls);var Qe={},_c,kl;function Kw(){if(kl)return _c;kl=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}_c=t;function t(r,s,o){var l=o&&o.stringify||n,v=1;if(typeof r=="object"&&r!==null){var d=s.length+v;if(d===1)return r;var g=new Array(d);g[0]=l(r);for(var w=1;w<d;w++)g[w]=l(s[w]);return g.join(" ")}if(typeof r!="string")return r;var S=s.length;if(S===0)return r;for(var F="",q=1-v,L=-1,$=r&&r.length||0,B=0;B<$;){if(r.charCodeAt(B)===37&&B+1<$){switch(L=L>-1?L:0,r.charCodeAt(B+1)){case 100:case 102:if(q>=S||s[q]==null)break;L<B&&(F+=r.slice(L,B)),F+=Number(s[q]),L=B+2,B++;break;case 105:if(q>=S||s[q]==null)break;L<B&&(F+=r.slice(L,B)),F+=Math.floor(Number(s[q])),L=B+2,B++;break;case 79:case 111:case 106:if(q>=S||s[q]===void 0)break;L<B&&(F+=r.slice(L,B));var G=typeof s[q];if(G==="string"){F+="'"+s[q]+"'",L=B+2,B++;break}if(G==="function"){F+=s[q].name||"<anonymous>",L=B+2,B++;break}F+=l(s[q]),L=B+2,B++;break;case 115:if(q>=S)break;L<B&&(F+=r.slice(L,B)),F+=String(s[q]),L=B+2,B++;break;case 37:L<B&&(F+=r.slice(L,B)),F+="%",L=B+2,B++,q--;break}++q}++B}return L===-1?r:(L<$&&(F+=r.slice(L)),F)}return _c}var bc,Gl;function Vw(){if(Gl)return bc;Gl=1;const n=Kw();bc=o;const t=x().console||{},r={mapHttpRequest:$,mapHttpResponse:$,wrapRequestSerializer:B,wrapResponseSerializer:B,wrapErrorSerializer:B,req:$,res:$,err:q};function s(b,c){return Array.isArray(b)?b.filter(function(K){return K!=="!stdSerializers.err"}):b===!0?Object.keys(c):!1}function o(b){b=b||{},b.browser=b.browser||{};const c=b.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const _=b.browser.write||t;b.browser.write&&(b.browser.asObject=!0);const K=b.serializers||{},k=s(b.browser.serialize,K);let ae=b.browser.serialize;Array.isArray(b.browser.serialize)&&b.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ae=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof _=="function"&&(_.error=_.fatal=_.warn=_.info=_.debug=_.trace=_),b.enabled===!1&&(b.level="silent");const ge=b.level||"info",P=Object.create(_);P.log||(P.log=G),Object.defineProperty(P,"levelVal",{get:le}),Object.defineProperty(P,"level",{get:te,set:W});const z={transmit:c,serialize:k,asObject:b.browser.asObject,levels:ce,timestamp:L(b)};P.levels=o.levels,P.level=ge,P.setMaxListeners=P.getMaxListeners=P.emit=P.addListener=P.on=P.prependListener=P.once=P.prependOnceListener=P.removeListener=P.removeAllListeners=P.listeners=P.listenerCount=P.eventNames=P.write=P.flush=G,P.serializers=K,P._serialize=k,P._stdErrSerialize=ae,P.child=ee,c&&(P._logEvent=F());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,l(z,P,"error","log"),l(z,P,"fatal","error"),l(z,P,"warn","error"),l(z,P,"info","log"),l(z,P,"debug","log"),l(z,P,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},k&&Y.serializers&&(re.serializers=Y.serializers);const xe=re.serializers;if(k&&xe){var ne=Object.assign({},K,xe),be=b.browser.serialize===!0?Object.keys(ne):k;delete Y.serializers,g([Y],be,ne,this._stdErrSerialize)}function ue(ye){this._childLevel=(ye._childLevel|0)+1,this.error=w(ye,Y,"error"),this.fatal=w(ye,Y,"fatal"),this.warn=w(ye,Y,"warn"),this.info=w(ye,Y,"info"),this.debug=w(ye,Y,"debug"),this.trace=w(ye,Y,"trace"),ne&&(this.serializers=ne,this._serialize=be),c&&(this._logEvent=F([].concat(ye._logEvent.bindings,Y)))}return ue.prototype=this,new ue(this)}return P}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:A,unixTime:R,isoTime:D});function l(b,c,_,K){const k=Object.getPrototypeOf(c);c[_]=c.levelVal>c.levels.values[_]?G:k[_]?k[_]:t[_]||t[K]||G,v(b,c,_)}function v(b,c,_){!b.transmit&&c[_]===G||(c[_]=function(K){return function(){const ae=b.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var P=0;P<ce.length;P++)ce[P]=arguments[P];if(b.serialize&&!b.asObject&&g(ce,this._serialize,this.serializers,this._stdErrSerialize),b.asObject?K.call(ge,d(this,_,ce,ae)):K.apply(ge,ce),b.transmit){const z=b.transmit.level||c.level,le=o.levels.values[z],te=o.levels.values[_];if(te<le)return;S(this,{ts:ae,methodLevel:_,methodValue:te,transmitLevel:z,transmitValue:o.levels.values[b.transmit.level||c.level],send:b.transmit.send,val:c.levelVal},ce)}}}(c[_]))}function d(b,c,_,K){b._serialize&&g(_,b._serialize,b.serializers,b._stdErrSerialize);const k=_.slice();let ae=k[0];const ce={};K&&(ce.time=K),ce.level=o.levels.values[c];let ge=(b._childLevel|0)+1;if(ge<1&&(ge=1),ae!==null&&typeof ae=="object"){for(;ge--&&typeof k[0]=="object";)Object.assign(ce,k.shift());ae=k.length?n(k.shift(),k):void 0}else typeof ae=="string"&&(ae=n(k.shift(),k));return ae!==void 0&&(ce.msg=ae),ce}function g(b,c,_,K){for(const k in b)if(K&&b[k]instanceof Error)b[k]=o.stdSerializers.err(b[k]);else if(typeof b[k]=="object"&&!Array.isArray(b[k]))for(const ae in b[k])c&&c.indexOf(ae)>-1&&ae in _&&(b[k][ae]=_[ae](b[k][ae]))}function w(b,c,_){return function(){const K=new Array(1+arguments.length);K[0]=c;for(var k=1;k<K.length;k++)K[k]=arguments[k-1];return b[_].apply(this,K)}}function S(b,c,_){const K=c.send,k=c.ts,ae=c.methodLevel,ce=c.methodValue,ge=c.val,P=b._logEvent.bindings;g(_,b._serialize||Object.keys(b.serializers),b.serializers,b._stdErrSerialize===void 0?!0:b._stdErrSerialize),b._logEvent.ts=k,b._logEvent.messages=_.filter(function(z){return P.indexOf(z)===-1}),b._logEvent.level.label=ae,b._logEvent.level.value=ce,K(ae,b._logEvent,ge),b._logEvent=F(P)}function F(b){return{ts:0,messages:[],bindings:b||[],level:{label:"",value:0}}}function q(b){const c={type:b.constructor.name,msg:b.message,stack:b.stack};for(const _ in b)c[_]===void 0&&(c[_]=b[_]);return c}function L(b){return typeof b.timestamp=="function"?b.timestamp:b.timestamp===!1?ie:A}function $(){return{}}function B(b){return b}function G(){}function ie(){return!1}function A(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function D(){return new Date(Date.now()).toISOString()}function x(){function b(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return b(self)||b(window)||b(this)||{}}}return bc}var Gi={},Wl;function dd(){return Wl||(Wl=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.PINO_CUSTOM_CONTEXT_KEY=Gi.PINO_LOGGER_DEFAULTS=void 0,Gi.PINO_LOGGER_DEFAULTS={level:"info"},Gi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gi}var nr={},Yl;function kw(){if(Yl)return nr;Yl=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.generateChildLogger=nr.formatChildLoggerContext=nr.getLoggerContext=nr.setBrowserLoggerContext=nr.getBrowserLoggerContext=nr.getDefaultLoggerOptions=void 0;const n=dd();function t(d){return Object.assign(Object.assign({},d),{level:(d==null?void 0:d.level)||n.PINO_LOGGER_DEFAULTS.level})}nr.getDefaultLoggerOptions=t;function r(d,g=n.PINO_CUSTOM_CONTEXT_KEY){return d[g]||""}nr.getBrowserLoggerContext=r;function s(d,g,w=n.PINO_CUSTOM_CONTEXT_KEY){return d[w]=g,d}nr.setBrowserLoggerContext=s;function o(d,g=n.PINO_CUSTOM_CONTEXT_KEY){let w="";return typeof d.bindings>"u"?w=r(d,g):w=d.bindings().context||"",w}nr.getLoggerContext=o;function l(d,g,w=n.PINO_CUSTOM_CONTEXT_KEY){const S=o(d,w);return S.trim()?`${S}/${g}`:g}nr.formatChildLoggerContext=l;function v(d,g,w=n.PINO_CUSTOM_CONTEXT_KEY){const S=l(d,g,w),F=d.child({context:S});return s(F,S,w)}return nr.generateChildLogger=v,nr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Br,r=t.__importDefault(Vw());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(dd(),n),t.__exportStar(kw(),n)})(Qe);class Gw extends en{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Ww extends en{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Yw{constructor(t,r){this.logger=t,this.core=r}}let Jw=class extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}};class Xw extends en{constructor(t){super()}}let Zw=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}};class Qw extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}}let eE=class extends en{constructor(t,r){super(),this.core=t,this.logger=r}},tE=class{constructor(t,r){this.projectId=t,this.logger=r}},rE=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}};class iE{constructor(t){this.client=t}}var au={},pd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Le,r=Er;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},d.prototype.update=function(g,w){if(w===void 0&&(w=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&w>0;)this._buffer[this._bufferLength++]=g[S++],w--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(S=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,S,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=g[S++],w--;return this},d.prototype.finish=function(g){if(!this._finished){var w=this._bytesHashed,S=this._bufferLength,F=w/536870912|0,q=w<<3,L=w%128<112?128:256;this._buffer[S]=128;for(var $=S+1;$<L-8;$++)this._buffer[$]=0;t.writeUint32BE(F,this._buffer,L-8),t.writeUint32BE(q,this._buffer,L-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,L),this._finished=!0}for(var $=0;$<this.digestLength/8;$++)t.writeUint32BE(this._stateHi[$],g,$*8),t.writeUint32BE(this._stateLo[$],g,$*8+4);return this},d.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(g){r.wipe(g.stateHi),r.wipe(g.stateLo),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},d}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(d,g,w,S,F,q,L){for(var $=w[0],B=w[1],G=w[2],ie=w[3],A=w[4],R=w[5],D=w[6],x=w[7],b=S[0],c=S[1],_=S[2],K=S[3],k=S[4],ae=S[5],ce=S[6],ge=S[7],P,z,le,te,W,ee,Y,re;L>=128;){for(var xe=0;xe<16;xe++){var ne=8*xe+q;d[xe]=t.readUint32BE(F,ne),g[xe]=t.readUint32BE(F,ne+4)}for(var xe=0;xe<80;xe++){var be=$,ue=B,ye=G,j=ie,M=A,O=R,h=D,I=x,se=b,fe=c,Se=_,He=K,Ve=k,$e=ae,dt=ce,pt=ge;if(P=x,z=ge,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=(A>>>14|k<<32-14)^(A>>>18|k<<32-18)^(k>>>41-32|A<<32-(41-32)),z=(k>>>14|A<<32-14)^(k>>>18|A<<32-18)^(A>>>41-32|k<<32-(41-32)),W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,P=A&R^~A&D,z=k&ae^~k&ce,W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,P=o[xe*2],z=o[xe*2+1],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,P=d[xe%16],z=g[xe%16],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,P=le,z=te,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=($>>>28|b<<32-28)^(b>>>34-32|$<<32-(34-32))^(b>>>39-32|$<<32-(39-32)),z=(b>>>28|$<<32-28)^($>>>34-32|b<<32-(34-32))^($>>>39-32|b<<32-(39-32)),W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,P=$&B^$&G^B&G,z=b&c^b&_^c&_,W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,I=Y&65535|re<<16,pt=W&65535|ee<<16,P=j,z=He,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=le,z=te,W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,j=Y&65535|re<<16,He=W&65535|ee<<16,B=be,G=ue,ie=ye,A=j,R=M,D=O,x=h,$=I,c=se,_=fe,K=Se,k=He,ae=Ve,ce=$e,ge=dt,b=pt,xe%16===15)for(var ne=0;ne<16;ne++)P=d[ne],z=g[ne],W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=d[(ne+9)%16],z=g[(ne+9)%16],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,le=d[(ne+1)%16],te=g[(ne+1)%16],P=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,z=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,le=d[(ne+14)%16],te=g[(ne+14)%16],P=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,z=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[ne]=Y&65535|re<<16,g[ne]=W&65535|ee<<16}P=$,z=b,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[0],z=S[0],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[0]=$=Y&65535|re<<16,S[0]=b=W&65535|ee<<16,P=B,z=c,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[1],z=S[1],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[1]=B=Y&65535|re<<16,S[1]=c=W&65535|ee<<16,P=G,z=_,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[2],z=S[2],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[2]=G=Y&65535|re<<16,S[2]=_=W&65535|ee<<16,P=ie,z=K,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[3],z=S[3],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[3]=ie=Y&65535|re<<16,S[3]=K=W&65535|ee<<16,P=A,z=k,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[4],z=S[4],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[4]=A=Y&65535|re<<16,S[4]=k=W&65535|ee<<16,P=R,z=ae,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[5],z=S[5],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[5]=R=Y&65535|re<<16,S[5]=ae=W&65535|ee<<16,P=D,z=ce,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[6],z=S[6],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[6]=D=Y&65535|re<<16,S[6]=ce=W&65535|ee<<16,P=x,z=ge,W=z&65535,ee=z>>>16,Y=P&65535,re=P>>>16,P=w[7],z=S[7],W+=z&65535,ee+=z>>>16,Y+=P&65535,re+=P>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,w[7]=x=Y&65535|re<<16,S[7]=ge=W&65535|ee<<16,q+=128,L-=128}return q}function v(d){var g=new s;g.update(d);var w=g.digest();return g.clean(),w}n.hash=v})(pd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Cn,r=pd,s=Er;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(j){const M=new Float64Array(16);if(j)for(let O=0;O<j.length;O++)M[O]=j[O];return M}const l=new Uint8Array(32);l[0]=9;const v=o(),d=o([1]),g=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),w=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),F=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),q=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function L(j,M){for(let O=0;O<16;O++)j[O]=M[O]|0}function $(j){let M=1;for(let O=0;O<16;O++){let h=j[O]+M+65535;M=Math.floor(h/65536),j[O]=h-M*65536}j[0]+=M-1+37*(M-1)}function B(j,M,O){const h=~(O-1);for(let I=0;I<16;I++){const se=h&(j[I]^M[I]);j[I]^=se,M[I]^=se}}function G(j,M){const O=o(),h=o();for(let I=0;I<16;I++)h[I]=M[I];$(h),$(h),$(h);for(let I=0;I<2;I++){O[0]=h[0]-65517;for(let fe=1;fe<15;fe++)O[fe]=h[fe]-65535-(O[fe-1]>>16&1),O[fe-1]&=65535;O[15]=h[15]-32767-(O[14]>>16&1);const se=O[15]>>16&1;O[14]&=65535,B(h,O,1-se)}for(let I=0;I<16;I++)j[2*I]=h[I]&255,j[2*I+1]=h[I]>>8}function ie(j,M){let O=0;for(let h=0;h<32;h++)O|=j[h]^M[h];return(1&O-1>>>8)-1}function A(j,M){const O=new Uint8Array(32),h=new Uint8Array(32);return G(O,j),G(h,M),ie(O,h)}function R(j){const M=new Uint8Array(32);return G(M,j),M[0]&1}function D(j,M){for(let O=0;O<16;O++)j[O]=M[2*O]+(M[2*O+1]<<8);j[15]&=32767}function x(j,M,O){for(let h=0;h<16;h++)j[h]=M[h]+O[h]}function b(j,M,O){for(let h=0;h<16;h++)j[h]=M[h]-O[h]}function c(j,M,O){let h,I,se=0,fe=0,Se=0,He=0,Ve=0,$e=0,dt=0,pt=0,je=0,Ie=0,Re=0,Ue=0,ze=0,Ae=0,Fe=0,De=0,Oe=0,Be=0,Ce=0,ke=0,We=0,et=0,tt=0,Je=0,Zt=0,cr=0,Kr=0,Qt=0,Qr=0,di=0,Pi=0,mt=O[0],gt=O[1],wt=O[2],Et=O[3],_t=O[4],vt=O[5],Tt=O[6],Rt=O[7],Dt=O[8],Ut=O[9],St=O[10],Ct=O[11],It=O[12],ht=O[13],Ft=O[14],Lt=O[15];h=M[0],se+=h*mt,fe+=h*gt,Se+=h*wt,He+=h*Et,Ve+=h*_t,$e+=h*vt,dt+=h*Tt,pt+=h*Rt,je+=h*Dt,Ie+=h*Ut,Re+=h*St,Ue+=h*Ct,ze+=h*It,Ae+=h*ht,Fe+=h*Ft,De+=h*Lt,h=M[1],fe+=h*mt,Se+=h*gt,He+=h*wt,Ve+=h*Et,$e+=h*_t,dt+=h*vt,pt+=h*Tt,je+=h*Rt,Ie+=h*Dt,Re+=h*Ut,Ue+=h*St,ze+=h*Ct,Ae+=h*It,Fe+=h*ht,De+=h*Ft,Oe+=h*Lt,h=M[2],Se+=h*mt,He+=h*gt,Ve+=h*wt,$e+=h*Et,dt+=h*_t,pt+=h*vt,je+=h*Tt,Ie+=h*Rt,Re+=h*Dt,Ue+=h*Ut,ze+=h*St,Ae+=h*Ct,Fe+=h*It,De+=h*ht,Oe+=h*Ft,Be+=h*Lt,h=M[3],He+=h*mt,Ve+=h*gt,$e+=h*wt,dt+=h*Et,pt+=h*_t,je+=h*vt,Ie+=h*Tt,Re+=h*Rt,Ue+=h*Dt,ze+=h*Ut,Ae+=h*St,Fe+=h*Ct,De+=h*It,Oe+=h*ht,Be+=h*Ft,Ce+=h*Lt,h=M[4],Ve+=h*mt,$e+=h*gt,dt+=h*wt,pt+=h*Et,je+=h*_t,Ie+=h*vt,Re+=h*Tt,Ue+=h*Rt,ze+=h*Dt,Ae+=h*Ut,Fe+=h*St,De+=h*Ct,Oe+=h*It,Be+=h*ht,Ce+=h*Ft,ke+=h*Lt,h=M[5],$e+=h*mt,dt+=h*gt,pt+=h*wt,je+=h*Et,Ie+=h*_t,Re+=h*vt,Ue+=h*Tt,ze+=h*Rt,Ae+=h*Dt,Fe+=h*Ut,De+=h*St,Oe+=h*Ct,Be+=h*It,Ce+=h*ht,ke+=h*Ft,We+=h*Lt,h=M[6],dt+=h*mt,pt+=h*gt,je+=h*wt,Ie+=h*Et,Re+=h*_t,Ue+=h*vt,ze+=h*Tt,Ae+=h*Rt,Fe+=h*Dt,De+=h*Ut,Oe+=h*St,Be+=h*Ct,Ce+=h*It,ke+=h*ht,We+=h*Ft,et+=h*Lt,h=M[7],pt+=h*mt,je+=h*gt,Ie+=h*wt,Re+=h*Et,Ue+=h*_t,ze+=h*vt,Ae+=h*Tt,Fe+=h*Rt,De+=h*Dt,Oe+=h*Ut,Be+=h*St,Ce+=h*Ct,ke+=h*It,We+=h*ht,et+=h*Ft,tt+=h*Lt,h=M[8],je+=h*mt,Ie+=h*gt,Re+=h*wt,Ue+=h*Et,ze+=h*_t,Ae+=h*vt,Fe+=h*Tt,De+=h*Rt,Oe+=h*Dt,Be+=h*Ut,Ce+=h*St,ke+=h*Ct,We+=h*It,et+=h*ht,tt+=h*Ft,Je+=h*Lt,h=M[9],Ie+=h*mt,Re+=h*gt,Ue+=h*wt,ze+=h*Et,Ae+=h*_t,Fe+=h*vt,De+=h*Tt,Oe+=h*Rt,Be+=h*Dt,Ce+=h*Ut,ke+=h*St,We+=h*Ct,et+=h*It,tt+=h*ht,Je+=h*Ft,Zt+=h*Lt,h=M[10],Re+=h*mt,Ue+=h*gt,ze+=h*wt,Ae+=h*Et,Fe+=h*_t,De+=h*vt,Oe+=h*Tt,Be+=h*Rt,Ce+=h*Dt,ke+=h*Ut,We+=h*St,et+=h*Ct,tt+=h*It,Je+=h*ht,Zt+=h*Ft,cr+=h*Lt,h=M[11],Ue+=h*mt,ze+=h*gt,Ae+=h*wt,Fe+=h*Et,De+=h*_t,Oe+=h*vt,Be+=h*Tt,Ce+=h*Rt,ke+=h*Dt,We+=h*Ut,et+=h*St,tt+=h*Ct,Je+=h*It,Zt+=h*ht,cr+=h*Ft,Kr+=h*Lt,h=M[12],ze+=h*mt,Ae+=h*gt,Fe+=h*wt,De+=h*Et,Oe+=h*_t,Be+=h*vt,Ce+=h*Tt,ke+=h*Rt,We+=h*Dt,et+=h*Ut,tt+=h*St,Je+=h*Ct,Zt+=h*It,cr+=h*ht,Kr+=h*Ft,Qt+=h*Lt,h=M[13],Ae+=h*mt,Fe+=h*gt,De+=h*wt,Oe+=h*Et,Be+=h*_t,Ce+=h*vt,ke+=h*Tt,We+=h*Rt,et+=h*Dt,tt+=h*Ut,Je+=h*St,Zt+=h*Ct,cr+=h*It,Kr+=h*ht,Qt+=h*Ft,Qr+=h*Lt,h=M[14],Fe+=h*mt,De+=h*gt,Oe+=h*wt,Be+=h*Et,Ce+=h*_t,ke+=h*vt,We+=h*Tt,et+=h*Rt,tt+=h*Dt,Je+=h*Ut,Zt+=h*St,cr+=h*Ct,Kr+=h*It,Qt+=h*ht,Qr+=h*Ft,di+=h*Lt,h=M[15],De+=h*mt,Oe+=h*gt,Be+=h*wt,Ce+=h*Et,ke+=h*_t,We+=h*vt,et+=h*Tt,tt+=h*Rt,Je+=h*Dt,Zt+=h*Ut,cr+=h*St,Kr+=h*Ct,Qt+=h*It,Qr+=h*ht,di+=h*Ft,Pi+=h*Lt,se+=38*Oe,fe+=38*Be,Se+=38*Ce,He+=38*ke,Ve+=38*We,$e+=38*et,dt+=38*tt,pt+=38*Je,je+=38*Zt,Ie+=38*cr,Re+=38*Kr,Ue+=38*Qt,ze+=38*Qr,Ae+=38*di,Fe+=38*Pi,I=1,h=se+I+65535,I=Math.floor(h/65536),se=h-I*65536,h=fe+I+65535,I=Math.floor(h/65536),fe=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=He+I+65535,I=Math.floor(h/65536),He=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=dt+I+65535,I=Math.floor(h/65536),dt=h-I*65536,h=pt+I+65535,I=Math.floor(h/65536),pt=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,h=Ue+I+65535,I=Math.floor(h/65536),Ue=h-I*65536,h=ze+I+65535,I=Math.floor(h/65536),ze=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,se+=I-1+37*(I-1),I=1,h=se+I+65535,I=Math.floor(h/65536),se=h-I*65536,h=fe+I+65535,I=Math.floor(h/65536),fe=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=He+I+65535,I=Math.floor(h/65536),He=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=dt+I+65535,I=Math.floor(h/65536),dt=h-I*65536,h=pt+I+65535,I=Math.floor(h/65536),pt=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,h=Ue+I+65535,I=Math.floor(h/65536),Ue=h-I*65536,h=ze+I+65535,I=Math.floor(h/65536),ze=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,se+=I-1+37*(I-1),j[0]=se,j[1]=fe,j[2]=Se,j[3]=He,j[4]=Ve,j[5]=$e,j[6]=dt,j[7]=pt,j[8]=je,j[9]=Ie,j[10]=Re,j[11]=Ue,j[12]=ze,j[13]=Ae,j[14]=Fe,j[15]=De}function _(j,M){c(j,M,M)}function K(j,M){const O=o();let h;for(h=0;h<16;h++)O[h]=M[h];for(h=253;h>=0;h--)_(O,O),h!==2&&h!==4&&c(O,O,M);for(h=0;h<16;h++)j[h]=O[h]}function k(j,M){const O=o();let h;for(h=0;h<16;h++)O[h]=M[h];for(h=250;h>=0;h--)_(O,O),h!==1&&c(O,O,M);for(h=0;h<16;h++)j[h]=O[h]}function ae(j,M){const O=o(),h=o(),I=o(),se=o(),fe=o(),Se=o(),He=o(),Ve=o(),$e=o();b(O,j[1],j[0]),b($e,M[1],M[0]),c(O,O,$e),x(h,j[0],j[1]),x($e,M[0],M[1]),c(h,h,$e),c(I,j[3],M[3]),c(I,I,w),c(se,j[2],M[2]),x(se,se,se),b(fe,h,O),b(Se,se,I),x(He,se,I),x(Ve,h,O),c(j[0],fe,Se),c(j[1],Ve,He),c(j[2],He,Se),c(j[3],fe,Ve)}function ce(j,M,O){for(let h=0;h<4;h++)B(j[h],M[h],O)}function ge(j,M){const O=o(),h=o(),I=o();K(I,M[2]),c(O,M[0],I),c(h,M[1],I),G(j,h),j[31]^=R(O)<<7}function P(j,M,O){L(j[0],v),L(j[1],d),L(j[2],d),L(j[3],v);for(let h=255;h>=0;--h){const I=O[h/8|0]>>(h&7)&1;ce(j,M,I),ae(M,j),ae(j,j),ce(j,M,I)}}function z(j,M){const O=[o(),o(),o(),o()];L(O[0],S),L(O[1],F),L(O[2],d),c(O[3],S,F),P(j,O,M)}function le(j){if(j.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const M=(0,r.hash)(j);M[0]&=248,M[31]&=127,M[31]|=64;const O=new Uint8Array(32),h=[o(),o(),o(),o()];z(h,M),ge(O,h);const I=new Uint8Array(64);return I.set(j),I.set(O,32),{publicKey:O,secretKey:I}}n.generateKeyPairFromSeed=le;function te(j){const M=(0,t.randomBytes)(32,j),O=le(M);return(0,s.wipe)(M),O}n.generateKeyPair=te;function W(j){if(j.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(j.subarray(32))}n.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(j,M){let O,h,I,se;for(h=63;h>=32;--h){for(O=0,I=h-32,se=h-12;I<se;++I)M[I]+=O-16*M[h]*ee[I-(h-32)],O=Math.floor((M[I]+128)/256),M[I]-=O*256;M[I]+=O,M[h]=0}for(O=0,I=0;I<32;I++)M[I]+=O-(M[31]>>4)*ee[I],O=M[I]>>8,M[I]&=255;for(I=0;I<32;I++)M[I]-=O*ee[I];for(h=0;h<32;h++)M[h+1]+=M[h]>>8,j[h]=M[h]&255}function re(j){const M=new Float64Array(64);for(let O=0;O<64;O++)M[O]=j[O];for(let O=0;O<64;O++)j[O]=0;Y(j,M)}function xe(j,M){const O=new Float64Array(64),h=[o(),o(),o(),o()],I=(0,r.hash)(j.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const se=new Uint8Array(64);se.set(I.subarray(32),32);const fe=new r.SHA512;fe.update(se.subarray(32)),fe.update(M);const Se=fe.digest();fe.clean(),re(Se),z(h,Se),ge(se,h),fe.reset(),fe.update(se.subarray(0,32)),fe.update(j.subarray(32)),fe.update(M);const He=fe.digest();re(He);for(let Ve=0;Ve<32;Ve++)O[Ve]=Se[Ve];for(let Ve=0;Ve<32;Ve++)for(let $e=0;$e<32;$e++)O[Ve+$e]+=He[Ve]*I[$e];return Y(se.subarray(32),O),se}n.sign=xe;function ne(j,M){const O=o(),h=o(),I=o(),se=o(),fe=o(),Se=o(),He=o();return L(j[2],d),D(j[1],M),_(I,j[1]),c(se,I,g),b(I,I,j[2]),x(se,j[2],se),_(fe,se),_(Se,fe),c(He,Se,fe),c(O,He,I),c(O,O,se),k(O,O),c(O,O,I),c(O,O,se),c(O,O,se),c(j[0],O,se),_(h,j[0]),c(h,h,se),A(h,I)&&c(j[0],j[0],q),_(h,j[0]),c(h,h,se),A(h,I)?-1:(R(j[0])===M[31]>>7&&b(j[0],v,j[0]),c(j[3],j[0],j[1]),0)}function be(j,M,O){const h=new Uint8Array(32),I=[o(),o(),o(),o()],se=[o(),o(),o(),o()];if(O.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ne(se,j))return!1;const fe=new r.SHA512;fe.update(O.subarray(0,32)),fe.update(j),fe.update(M);const Se=fe.digest();return re(Se),P(I,se,Se),z(se,O.subarray(32)),ae(I,se),ge(h,I),!ie(O,h)}n.verify=be;function ue(j){let M=[o(),o(),o(),o()];if(ne(M,j))throw new Error("Ed25519: invalid public key");let O=o(),h=o(),I=M[1];x(O,d,I),b(h,d,I),K(h,h),c(O,O,h);let se=new Uint8Array(32);return G(se,O),se}n.convertPublicKeyToX25519=ue;function ye(j){const M=(0,r.hash)(j.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const O=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),O}n.convertSecretKeyToX25519=ye})(au);const nE="EdDSA",sE="JWT",gd=".",vd="base64url",aE="utf8",oE="utf8",cE=":",uE="did",hE="key",Jl="base58btc",lE="z",fE="K36",dE=32;function Ca(n){return or(gr(Vc(n),aE),vd)}function yd(n){const t=gr(fE,Jl),r=lE+or(Rc([t,n]),Jl);return[uE,hE,r].join(cE)}function pE(n){return or(n,vd)}function gE(n){return gr([Ca(n.header),Ca(n.payload)].join(gd),oE)}function vE(n){return[Ca(n.header),Ca(n.payload),pE(n.signature)].join(gd)}function Xl(n=Cn.randomBytes(dE)){return au.generateKeyPairFromSeed(n)}async function yE(n,t,r,s,o=Ee.fromMiliseconds(Date.now())){const l={alg:nE,typ:sE},v=yd(s.publicKey),d=o+r,g={iss:v,sub:n,aud:t,iat:o,exp:d},w=gE({header:l,payload:g}),S=au.sign(s.secretKey,w);return vE({header:l,payload:g,signature:S})}const Zl=10,_E=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),bE=()=>typeof window<"u",mE=_E();class wE{constructor(t){if(this.url=t,this.events=new Fr,this.registering=!1,!hl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Vc(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!hl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=O_.isReactNative()?void 0:{rejectUnauthorized:!P_(t)},l=new mE(t,[],o);bE()?l.onerror=v=>{const d=v;s(this.emitError(d.error))}:l.on("error",v=>{s(this.emitError(v))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Tf(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),l=kc(t,o);this.events.emit("payload",l)}parseError(t,r=this.url){return N_(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Zl&&this.events.setMaxListeners(Zl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Aa={exports:{}};Aa.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",o=1,l=2,v=9007199254740991,d="[object Arguments]",g="[object Array]",w="[object AsyncFunction]",S="[object Boolean]",F="[object Date]",q="[object Error]",L="[object Function]",$="[object GeneratorFunction]",B="[object Map]",G="[object Number]",ie="[object Null]",A="[object Object]",R="[object Promise]",D="[object Proxy]",x="[object RegExp]",b="[object Set]",c="[object String]",_="[object Symbol]",K="[object Undefined]",k="[object WeakMap]",ae="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",P="[object Float64Array]",z="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,ue={};ue[ge]=ue[P]=ue[z]=ue[le]=ue[te]=ue[W]=ue[ee]=ue[Y]=ue[re]=!0,ue[d]=ue[g]=ue[ae]=ue[S]=ue[ce]=ue[F]=ue[q]=ue[L]=ue[B]=ue[G]=ue[A]=ue[x]=ue[b]=ue[c]=ue[k]=!1;var ye=typeof Wi=="object"&&Wi&&Wi.Object===Object&&Wi,j=typeof self=="object"&&self&&self.Object===Object&&self,M=ye||j||Function("return this")(),O=t&&!t.nodeType&&t,h=O&&!0&&n&&!n.nodeType&&n,I=h&&h.exports===O,se=I&&ye.process,fe=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Se=fe&&fe.isTypedArray;function He(m,N){for(var Z=-1,de=m==null?0:m.length,ot=0,Ne=[];++Z<de;){var lt=m[Z];N(lt,Z,m)&&(Ne[ot++]=lt)}return Ne}function Ve(m,N){for(var Z=-1,de=N.length,ot=m.length;++Z<de;)m[ot+Z]=N[Z];return m}function $e(m,N){for(var Z=-1,de=m==null?0:m.length;++Z<de;)if(N(m[Z],Z,m))return!0;return!1}function dt(m,N){for(var Z=-1,de=Array(m);++Z<m;)de[Z]=N(Z);return de}function pt(m){return function(N){return m(N)}}function je(m,N){return m.has(N)}function Ie(m,N){return m==null?void 0:m[N]}function Re(m){var N=-1,Z=Array(m.size);return m.forEach(function(de,ot){Z[++N]=[ot,de]}),Z}function Ue(m,N){return function(Z){return m(N(Z))}}function ze(m){var N=-1,Z=Array(m.size);return m.forEach(function(de){Z[++N]=de}),Z}var Ae=Array.prototype,Fe=Function.prototype,De=Object.prototype,Oe=M["__core-js_shared__"],Be=Fe.toString,Ce=De.hasOwnProperty,ke=function(){var m=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),We=De.toString,et=RegExp("^"+Be.call(Ce).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=I?M.Buffer:void 0,Je=M.Symbol,Zt=M.Uint8Array,cr=De.propertyIsEnumerable,Kr=Ae.splice,Qt=Je?Je.toStringTag:void 0,Qr=Object.getOwnPropertySymbols,di=tt?tt.isBuffer:void 0,Pi=Ue(Object.keys,Object),mt=vr(M,"DataView"),gt=vr(M,"Map"),wt=vr(M,"Promise"),Et=vr(M,"Set"),_t=vr(M,"WeakMap"),vt=vr(Object,"create"),Tt=ti(mt),Rt=ti(gt),Dt=ti(wt),Ut=ti(Et),St=ti(_t),Ct=Je?Je.prototype:void 0,It=Ct?Ct.valueOf:void 0;function ht(m){var N=-1,Z=m==null?0:m.length;for(this.clear();++N<Z;){var de=m[N];this.set(de[0],de[1])}}function Ft(){this.__data__=vt?vt(null):{},this.size=0}function Lt(m){var N=this.has(m)&&delete this.__data__[m];return this.size-=N?1:0,N}function Ma(m){var N=this.__data__;if(vt){var Z=N[m];return Z===s?void 0:Z}return Ce.call(N,m)?N[m]:void 0}function ja(m){var N=this.__data__;return vt?N[m]!==void 0:Ce.call(N,m)}function za(m,N){var Z=this.__data__;return this.size+=this.has(m)?0:1,Z[m]=vt&&N===void 0?s:N,this}ht.prototype.clear=Ft,ht.prototype.delete=Lt,ht.prototype.get=Ma,ht.prototype.has=ja,ht.prototype.set=za;function Dr(m){var N=-1,Z=m==null?0:m.length;for(this.clear();++N<Z;){var de=m[N];this.set(de[0],de[1])}}function qa(){this.__data__=[],this.size=0}function Ha(m){var N=this.__data__,Z=Ni(N,m);if(Z<0)return!1;var de=N.length-1;return Z==de?N.pop():Kr.call(N,Z,1),--this.size,!0}function Ba(m){var N=this.__data__,Z=Ni(N,m);return Z<0?void 0:N[Z][1]}function Ka(m){return Ni(this.__data__,m)>-1}function Va(m,N){var Z=this.__data__,de=Ni(Z,m);return de<0?(++this.size,Z.push([m,N])):Z[de][1]=N,this}Dr.prototype.clear=qa,Dr.prototype.delete=Ha,Dr.prototype.get=Ba,Dr.prototype.has=Ka,Dr.prototype.set=Va;function ei(m){var N=-1,Z=m==null?0:m.length;for(this.clear();++N<Z;){var de=m[N];this.set(de[0],de[1])}}function rn(){this.size=0,this.__data__={hash:new ht,map:new(gt||Dr),string:new ht}}function ka(m){var N=pi(this,m).delete(m);return this.size-=N?1:0,N}function nn(m){return pi(this,m).get(m)}function Ga(m){return pi(this,m).has(m)}function Wa(m,N){var Z=pi(this,m),de=Z.size;return Z.set(m,N),this.size+=Z.size==de?0:1,this}ei.prototype.clear=rn,ei.prototype.delete=ka,ei.prototype.get=nn,ei.prototype.has=Ga,ei.prototype.set=Wa;function sn(m){var N=-1,Z=m==null?0:m.length;for(this.__data__=new ei;++N<Z;)this.add(m[N])}function ds(m){return this.__data__.set(m,s),this}function ps(m){return this.__data__.has(m)}sn.prototype.add=sn.prototype.push=ds,sn.prototype.has=ps;function Lr(m){var N=this.__data__=new Dr(m);this.size=N.size}function Ya(){this.__data__=new Dr,this.size=0}function Ja(m){var N=this.__data__,Z=N.delete(m);return this.size=N.size,Z}function Xa(m){return this.__data__.get(m)}function Za(m){return this.__data__.has(m)}function gs(m,N){var Z=this.__data__;if(Z instanceof Dr){var de=Z.__data__;if(!gt||de.length<r-1)return de.push([m,N]),this.size=++Z.size,this;Z=this.__data__=new ei(de)}return Z.set(m,N),this.size=Z.size,this}Lr.prototype.clear=Ya,Lr.prototype.delete=Ja,Lr.prototype.get=Xa,Lr.prototype.has=Za,Lr.prototype.set=gs;function vs(m,N){var Z=cn(m),de=!Z&&As(m),ot=!Z&&!de&&Nn(m),Ne=!Z&&!de&&!ot&&Ns(m),lt=Z||de||ot||Ne,$t=lt?dt(m.length,String):[],Xe=$t.length;for(var ct in m)(N||Ce.call(m,ct))&&!(lt&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ds(ct,Xe)))&&$t.push(ct);return $t}function Ni(m,N){for(var Z=m.length;Z--;)if(Cs(m[Z][0],N))return Z;return-1}function On(m,N,Z){var de=N(m);return cn(m)?de:Ve(de,Z(m))}function Ti(m){return m==null?m===void 0?K:ie:Qt&&Qt in Object(m)?ws(m):to(m)}function Pn(m){return Ui(m)&&Ti(m)==d}function Ri(m,N,Z,de,ot){return m===N?!0:m==null||N==null||!Ui(m)&&!Ui(N)?m!==m&&N!==N:ys(m,N,Z,de,Ri,ot)}function ys(m,N,Z,de,ot,Ne){var lt=cn(m),$t=cn(N),Xe=lt?g:Vr(m),ct=$t?g:Vr(N);Xe=Xe==d?A:Xe,ct=ct==d?A:ct;var At=Xe==A,ur=ct==A,Mt=Xe==ct;if(Mt&&Nn(m)){if(!Nn(N))return!1;lt=!0,At=!1}if(Mt&&!At)return Ne||(Ne=new Lr),lt||Ns(m)?an(m,N,Z,de,ot,Ne):eo(m,N,Xe,Z,de,ot,Ne);if(!(Z&o)){var ft=At&&Ce.call(m,"__wrapped__"),er=ur&&Ce.call(N,"__wrapped__");if(ft||er){var $r=ft?m.value():m,Sr=er?N.value():N;return Ne||(Ne=new Lr),ot($r,Sr,Z,de,Ne)}}return Mt?(Ne||(Ne=new Lr),ms(m,N,Z,de,ot,Ne)):!1}function Qa(m){if(!Ps(m)||Is(m))return!1;var N=un(m)?et:ne;return N.test(ti(m))}function _s(m){return Ui(m)&&Os(m.length)&&!!ue[Ti(m)]}function bs(m){if(!xs(m))return Pi(m);var N=[];for(var Z in Object(m))Ce.call(m,Z)&&Z!="constructor"&&N.push(Z);return N}function an(m,N,Z,de,ot,Ne){var lt=Z&o,$t=m.length,Xe=N.length;if($t!=Xe&&!(lt&&Xe>$t))return!1;var ct=Ne.get(m);if(ct&&Ne.get(N))return ct==N;var At=-1,ur=!0,Mt=Z&l?new sn:void 0;for(Ne.set(m,N),Ne.set(N,m);++At<$t;){var ft=m[At],er=N[At];if(de)var $r=lt?de(er,ft,At,N,m,Ne):de(ft,er,At,m,N,Ne);if($r!==void 0){if($r)continue;ur=!1;break}if(Mt){if(!$e(N,function(Sr,kr){if(!je(Mt,kr)&&(ft===Sr||ot(ft,Sr,Z,de,Ne)))return Mt.push(kr)})){ur=!1;break}}else if(!(ft===er||ot(ft,er,Z,de,Ne))){ur=!1;break}}return Ne.delete(m),Ne.delete(N),ur}function eo(m,N,Z,de,ot,Ne,lt){switch(Z){case ce:if(m.byteLength!=N.byteLength||m.byteOffset!=N.byteOffset)return!1;m=m.buffer,N=N.buffer;case ae:return!(m.byteLength!=N.byteLength||!Ne(new Zt(m),new Zt(N)));case S:case F:case G:return Cs(+m,+N);case q:return m.name==N.name&&m.message==N.message;case x:case c:return m==N+"";case B:var $t=Re;case b:var Xe=de&o;if($t||($t=ze),m.size!=N.size&&!Xe)return!1;var ct=lt.get(m);if(ct)return ct==N;de|=l,lt.set(m,N);var At=an($t(m),$t(N),de,ot,Ne,lt);return lt.delete(m),At;case _:if(It)return It.call(m)==It.call(N)}return!1}function ms(m,N,Z,de,ot,Ne){var lt=Z&o,$t=on(m),Xe=$t.length,ct=on(N),At=ct.length;if(Xe!=At&&!lt)return!1;for(var ur=Xe;ur--;){var Mt=$t[ur];if(!(lt?Mt in N:Ce.call(N,Mt)))return!1}var ft=Ne.get(m);if(ft&&Ne.get(N))return ft==N;var er=!0;Ne.set(m,N),Ne.set(N,m);for(var $r=lt;++ur<Xe;){Mt=$t[ur];var Sr=m[Mt],kr=N[Mt];if(de)var Tn=lt?de(kr,Sr,Mt,N,m,Ne):de(Sr,kr,Mt,m,N,Ne);if(!(Tn===void 0?Sr===kr||ot(Sr,kr,Z,de,Ne):Tn)){er=!1;break}$r||($r=Mt=="constructor")}if(er&&!$r){var Fi=m.constructor,Ht=N.constructor;Fi!=Ht&&"constructor"in m&&"constructor"in N&&!(typeof Fi=="function"&&Fi instanceof Fi&&typeof Ht=="function"&&Ht instanceof Ht)&&(er=!1)}return Ne.delete(m),Ne.delete(N),er}function on(m){return On(m,no,Es)}function pi(m,N){var Z=m.__data__;return Ss(N)?Z[typeof N=="string"?"string":"hash"]:Z.map}function vr(m,N){var Z=Ie(m,N);return Qa(Z)?Z:void 0}function ws(m){var N=Ce.call(m,Qt),Z=m[Qt];try{m[Qt]=void 0;var de=!0}catch{}var ot=We.call(m);return de&&(N?m[Qt]=Z:delete m[Qt]),ot}var Es=Qr?function(m){return m==null?[]:(m=Object(m),He(Qr(m),function(N){return cr.call(m,N)}))}:at,Vr=Ti;(mt&&Vr(new mt(new ArrayBuffer(1)))!=ce||gt&&Vr(new gt)!=B||wt&&Vr(wt.resolve())!=R||Et&&Vr(new Et)!=b||_t&&Vr(new _t)!=k)&&(Vr=function(m){var N=Ti(m),Z=N==A?m.constructor:void 0,de=Z?ti(Z):"";if(de)switch(de){case Tt:return ce;case Rt:return B;case Dt:return R;case Ut:return b;case St:return k}return N});function Ds(m,N){return N=N??v,!!N&&(typeof m=="number"||be.test(m))&&m>-1&&m%1==0&&m<N}function Ss(m){var N=typeof m;return N=="string"||N=="number"||N=="symbol"||N=="boolean"?m!=="__proto__":m===null}function Is(m){return!!ke&&ke in m}function xs(m){var N=m&&m.constructor,Z=typeof N=="function"&&N.prototype||De;return m===Z}function to(m){return We.call(m)}function ti(m){if(m!=null){try{return Be.call(m)}catch{}try{return m+""}catch{}}return""}function Cs(m,N){return m===N||m!==m&&N!==N}var As=Pn(function(){return arguments}())?Pn:function(m){return Ui(m)&&Ce.call(m,"callee")&&!cr.call(m,"callee")},cn=Array.isArray;function ro(m){return m!=null&&Os(m.length)&&!un(m)}var Nn=di||st;function io(m,N){return Ri(m,N)}function un(m){if(!Ps(m))return!1;var N=Ti(m);return N==L||N==$||N==w||N==D}function Os(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=v}function Ps(m){var N=typeof m;return m!=null&&(N=="object"||N=="function")}function Ui(m){return m!=null&&typeof m=="object"}var Ns=Se?pt(Se):_s;function no(m){return ro(m)?vs(m):bs(m)}function at(){return[]}function st(){return!1}n.exports=io})(Aa,Aa.exports);var EE=Aa.exports;const DE=m_(EE);function SE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var l=n.charAt(o),v=l.charCodeAt(0);if(r[v]!==255)throw new TypeError(l+" is ambiguous");r[v]=o}var d=n.length,g=n.charAt(0),w=Math.log(d)/Math.log(256),S=Math.log(256)/Math.log(d);function F($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var B=0,G=0,ie=0,A=$.length;ie!==A&&$[ie]===0;)ie++,B++;for(var R=(A-ie)*S+1>>>0,D=new Uint8Array(R);ie!==A;){for(var x=$[ie],b=0,c=R-1;(x!==0||b<G)&&c!==-1;c--,b++)x+=256*D[c]>>>0,D[c]=x%d>>>0,x=x/d>>>0;if(x!==0)throw new Error("Non-zero carry");G=b,ie++}for(var _=R-G;_!==R&&D[_]===0;)_++;for(var K=g.repeat(B);_<R;++_)K+=n.charAt(D[_]);return K}function q($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var B=0;if($[B]!==" "){for(var G=0,ie=0;$[B]===g;)G++,B++;for(var A=($.length-B)*w+1>>>0,R=new Uint8Array(A);$[B];){var D=r[$.charCodeAt(B)];if(D===255)return;for(var x=0,b=A-1;(D!==0||x<ie)&&b!==-1;b--,x++)D+=d*R[b]>>>0,R[b]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");ie=x,B++}if($[B]!==" "){for(var c=A-ie;c!==A&&R[c]===0;)c++;for(var _=new Uint8Array(G+(A-c)),K=G;c!==A;)_[K++]=R[c++];return _}}}function L($){var B=q($);if(B)return B;throw new Error(`Non-${t} character`)}return{encode:F,decodeUnsafe:q,decode:L}}var IE=SE,xE=IE;const _d=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},CE=n=>new TextEncoder().encode(n),AE=n=>new TextDecoder().decode(n);class OE{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}let PE=class{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return bd(this,t)}};class NE{constructor(t){this.decoders=t}or(t){return bd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bd=(n,t)=>new NE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class TE{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new OE(t,r,s),this.decoder=new PE(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const La=({name:n,prefix:t,encode:r,decode:s})=>new TE(n,t,r,s),fs=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=xE(r,t);return La({prefix:n,name:t,encode:s,decode:l=>_d(o(l))})},RE=(n,t,r,s)=>{const o={};for(let S=0;S<t.length;++S)o[t[S]]=S;let l=n.length;for(;n[l-1]==="=";)--l;const v=new Uint8Array(l*r/8|0);let d=0,g=0,w=0;for(let S=0;S<l;++S){const F=o[n[S]];if(F===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|F,d+=r,d>=8&&(d-=8,v[w++]=255&g>>d)}if(d>=r||255&g<<8-d)throw new SyntaxError("Unexpected end of data");return v},UE=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let l="",v=0,d=0;for(let g=0;g<n.length;++g)for(d=d<<8|n[g],v+=8;v>r;)v-=r,l+=t[o&d>>v];if(v&&(l+=t[o&d<<r-v]),s)for(;l.length*r&7;)l+="=";return l},Wt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>La({prefix:t,name:n,encode(o){return UE(o,s,r)},decode(o){return RE(o,s,r,n)}}),FE=La({prefix:"\0",name:"identity",encode:n=>AE(n),decode:n=>CE(n)});var LE=Object.freeze({__proto__:null,identity:FE});const $E=Wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ME=Object.freeze({__proto__:null,base2:$E});const jE=Wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zE=Object.freeze({__proto__:null,base8:jE});const qE=fs({prefix:"9",name:"base10",alphabet:"0123456789"});var HE=Object.freeze({__proto__:null,base10:qE});const BE=Wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),KE=Wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var VE=Object.freeze({__proto__:null,base16:BE,base16upper:KE});const kE=Wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),GE=Wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),WE=Wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),YE=Wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),JE=Wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),XE=Wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ZE=Wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),QE=Wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),e3=Wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var t3=Object.freeze({__proto__:null,base32:kE,base32upper:GE,base32pad:WE,base32padupper:YE,base32hex:JE,base32hexupper:XE,base32hexpad:ZE,base32hexpadupper:QE,base32z:e3});const r3=fs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),i3=fs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var n3=Object.freeze({__proto__:null,base36:r3,base36upper:i3});const s3=fs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),a3=fs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var o3=Object.freeze({__proto__:null,base58btc:s3,base58flickr:a3});const c3=Wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),u3=Wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),h3=Wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),l3=Wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var f3=Object.freeze({__proto__:null,base64:c3,base64pad:u3,base64url:h3,base64urlpad:l3});const md=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),d3=md.reduce((n,t,r)=>(n[r]=t,n),[]),p3=md.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function g3(n){return n.reduce((t,r)=>(t+=d3[r],t),"")}function v3(n){const t=[];for(const r of n){const s=p3[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const y3=La({prefix:"ðŸš€",name:"base256emoji",encode:g3,decode:v3});var _3=Object.freeze({__proto__:null,base256emoji:y3}),b3=wd,Ql=128,m3=127,w3=~m3,E3=Math.pow(2,31);function wd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=E3;)t[r++]=n&255|Ql,n/=128;for(;n&w3;)t[r++]=n&255|Ql,n>>>=7;return t[r]=n|0,wd.bytes=r-s+1,t}var D3=Mc,S3=128,ef=127;function Mc(n,s){var r=0,s=s||0,o=0,l=s,v,d=n.length;do{if(l>=d)throw Mc.bytes=0,new RangeError("Could not decode varint");v=n[l++],r+=o<28?(v&ef)<<o:(v&ef)*Math.pow(2,o),o+=7}while(v>=S3);return Mc.bytes=l-s,r}var I3=Math.pow(2,7),x3=Math.pow(2,14),C3=Math.pow(2,21),A3=Math.pow(2,28),O3=Math.pow(2,35),P3=Math.pow(2,42),N3=Math.pow(2,49),T3=Math.pow(2,56),R3=Math.pow(2,63),U3=function(n){return n<I3?1:n<x3?2:n<C3?3:n<A3?4:n<O3?5:n<P3?6:n<N3?7:n<T3?8:n<R3?9:10},F3={encode:b3,decode:D3,encodingLength:U3},Ed=F3;const tf=(n,t,r=0)=>(Ed.encode(n,t,r),t),rf=n=>Ed.encodingLength(n),jc=(n,t)=>{const r=t.byteLength,s=rf(n),o=s+rf(r),l=new Uint8Array(o+r);return tf(n,l,0),tf(r,l,s),l.set(t,o),new L3(n,r,t,l)};class L3{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const Dd=({name:n,code:t,encode:r})=>new $3(n,t,r);class $3{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?jc(this.code,r):r.then(s=>jc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Sd=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),M3=Dd({name:"sha2-256",code:18,encode:Sd("SHA-256")}),j3=Dd({name:"sha2-512",code:19,encode:Sd("SHA-512")});var z3=Object.freeze({__proto__:null,sha256:M3,sha512:j3});const Id=0,q3="identity",xd=_d,H3=n=>jc(Id,xd(n)),B3={code:Id,name:q3,encode:xd,digest:H3};var K3=Object.freeze({__proto__:null,identity:B3});new TextEncoder,new TextDecoder;const nf={...LE,...ME,...zE,...HE,...VE,...t3,...n3,...o3,...f3,..._3};({...z3,...K3});function Cd(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function V3(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Cd(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Ad(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const sf=Ad("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),mc=Ad("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=V3(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),k3={utf8:sf,"utf-8":sf,hex:nf.base16,latin1:mc,ascii:mc,binary:mc,...nf};function G3(n,t="utf8"){const r=k3[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Cd(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Od="wc",W3=2,ou="core",xi=`${Od}@2:${ou}:`,Y3={name:ou,logger:"error"},J3={database:":memory:"},X3="crypto",af="client_ed25519_seed",Z3=Ee.ONE_DAY,Q3="keychain",e6="0.3",t6="messages",r6="0.3",i6=Ee.SIX_HOURS,n6="publisher",Pd="irn",s6="error",Nd="wss://relay.walletconnect.com",a6="relayer",Kt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},o6="_subscription",ts={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},c6=Ee.ONE_SECOND/2,u6="2.7.2",h6="0.3",Zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},l6="subscription",f6="0.3",d6=Ee.FIVE_SECONDS*1e3,p6="pairing",g6="0.3",rs={wc_pairingDelete:{req:{ttl:Ee.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Ee.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Ee.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Ee.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Ee.ONE_DAY,prompt:!1,tag:0},res:{ttl:Ee.ONE_DAY,prompt:!1,tag:0}}},Xr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},v6="history",y6="0.3",_6="expirer",Rr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},b6="0.3",of="verify-api",cf="https://verify.walletconnect.com";class m6{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=Q3,this.version=e6,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:l}=he("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,id(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?nd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class w6{constructor(t,r,s){this.core=t,this.logger=r,this.name=X3,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),l=Xl(o);return yd(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Im();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const l=await this.getClientSeed(),v=Xl(l),d=Lc();return await yE(d,o,Z3,v)},this.generateSharedKey=(o,l,v)=>{this.isInitialized();const d=this.getPrivateKey(o),g=xm(d,l);return this.setSymKey(g,v)},this.setSymKey=async(o,l)=>{this.isInitialized();const v=l||Cm(o);return await this.keychain.set(v,o),v},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,l,v)=>{this.isInitialized();const d=ed(v),g=Vc(l);if(xl(d)){const q=d.senderPublicKey,L=d.receiverPublicKey;o=await this.generateSharedKey(q,L)}const w=this.getSymKey(o),{type:S,senderPublicKey:F}=d;return Om({type:S,symKey:w,message:g,senderPublicKey:F})},this.decode=async(o,l,v)=>{this.isInitialized();const d=Tm(l,v);if(xl(d)){const S=d.receiverPublicKey,F=d.senderPublicKey;o=await this.generateSharedKey(S,F)}const g=this.getSymKey(o),w=Pm({symKey:g,encoded:l});return Tf(w)},this.getPayloadType=o=>{const l=Ia(o);return us(l.type)},this.getPayloadSenderPublicKey=o=>{const l=Ia(o);return l.senderPublicKey?or(l.senderPublicKey,ar):void 0},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.keychain=s||new m6(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(af)}catch{t=Lc(),await this.keychain.set(af,t)}return G3(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class E6 extends Yw{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=t6,this.version=r6,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const l=Xi(o);let v=this.messages.get(s);return typeof v>"u"&&(v={}),typeof v[l]<"u"||(v[l]=o,this.messages.set(s,v),await this.persist()),l},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const l=this.get(s),v=Xi(o);return typeof l[v]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(t,this.name),this.core=r}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,id(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?nd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class D6 extends Jw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Fr,this.name=n6,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(s,o,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:l}});try{const v=(l==null?void 0:l.ttl)||i6,d=$c(l),g=(l==null?void 0:l.prompt)||!1,w=(l==null?void 0:l.tag)||0,S={topic:s,message:o,opts:{ttl:v,relay:d,prompt:g,tag:w}},F=Xi(o);this.queue.set(F,S);try{await await xa(this.rpcPublish(s,o,v,d,g,w),this.publishTimeout),this.relayer.events.emit(Kt.publish,S)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Kt.connection_stalled);return}this.onPublish(F,S),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:l}})}catch(v){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(v),v}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,l,v){var d,g,w,S;const F={method:ma(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:l,tag:v}};return sr((d=F.params)==null?void 0:d.prompt)&&((g=F.params)==null||delete g.prompt),sr((w=F.params)==null?void 0:w.tag)&&((S=F.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:F}),this.relayer.request(F)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ls.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}let S6=class{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(l=>l!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}};var I6=Object.defineProperty,x6=Object.defineProperties,C6=Object.getOwnPropertyDescriptors,uf=Object.getOwnPropertySymbols,A6=Object.prototype.hasOwnProperty,O6=Object.prototype.propertyIsEnumerable,hf=(n,t,r)=>t in n?I6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,is=(n,t)=>{for(var r in t||(t={}))A6.call(t,r)&&hf(n,r,t[r]);if(uf)for(var r of uf(t))O6.call(t,r)&&hf(n,r,t[r]);return n},wc=(n,t)=>x6(n,C6(t));class P6 extends Qw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new S6,this.events=new Fr,this.name=l6,this.version=f6,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=xi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const l=$c(o),v={topic:s,relay:l};this.pending.set(s,v);const d=await this.rpcSubscribe(s,l);return this.onSubscribe(d,v),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),d}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,l)=>{const v=new Ee.Watch;v.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(d),v.stop(this.pendingSubscriptionWatchLabel),o(!0)),v.elapsed(this.pendingSubscriptionWatchLabel)>=d6&&(clearInterval(d),v.stop(this.pendingSubscriptionWatchLabel),l(!1))},this.pollingInterval)}),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=$c(s);await this.rpcUnsubscribe(t,r,o);const l=Nt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:ma(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await xa(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}return Xi(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:ma(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await xa(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:ma(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,wc(is({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,is({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,is({},r)),this.topicMap.set(r.topic,t),this.events.emit(Zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Zr.deleted,wc(is({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);fi(r)&&this.onBatchSubscribe(r.map((s,o)=>wc(is({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(ls.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Kt.connect,async()=>{await this.onConnect()}),this.relayer.on(Kt.disconnect,()=>{this.onDisconnect()}),this.events.on(Zr.created,async t=>{const r=Zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Zr.deleted,async t=>{const r=Zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var N6=Object.defineProperty,lf=Object.getOwnPropertySymbols,T6=Object.prototype.hasOwnProperty,R6=Object.prototype.propertyIsEnumerable,ff=(n,t,r)=>t in n?N6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,U6=(n,t)=>{for(var r in t||(t={}))T6.call(t,r)&&ff(n,r,t[r]);if(lf)for(var r of lf(t))R6.call(t,r)&&ff(n,r,t[r]);return n};class F6 extends Xw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Fr,this.name=a6,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Qe.generateChildLogger(t.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:t.logger||s6})),this.messages=new E6(this.logger,t.core),this.subscriber=new P6(this,this.logger),this.publisher=new D6(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Nd,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){this.isInitialized();let s="";return await Promise.all([new Promise(o=>{this.subscriber.once(Zr.created,l=>{l.topic===t&&o()})}),new Promise(async o=>{s=await this.subscriber.subscribe(t,r),o()})]),s}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Kt.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Zr.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await xa(this.provider.connect(),5e3,"socket stalled").catch(o=>s(o)).then(()=>r()).finally(()=>this.removeListener(Kt.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Kt.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Kt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(ts.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ci(new wE(Bm({sdkVersion:u6,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Gc(t)){if(!t.method.endsWith(o6))return;const r=t.params,{topic:s,message:o,publishedAt:l}=r.data,v={topic:s,message:o,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(U6({type:"event",event:r.id},v)),this.events.emit(r.id,v),await this.acknowledgePayload(t),await this.onMessageEvent(v)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Kt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Wc(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(ts.payload,t=>this.onProviderPayload(t)),this.provider.on(ts.connect,()=>{this.events.emit(Kt.connect)}),this.provider.on(ts.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(ts.error,t=>{this.logger.error(t),this.events.emit(Kt.error,t)})}registerEventListeners(){this.events.on(Kt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Kt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Ee.toMiliseconds(c6))}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var L6=Object.defineProperty,df=Object.getOwnPropertySymbols,$6=Object.prototype.hasOwnProperty,M6=Object.prototype.propertyIsEnumerable,pf=(n,t,r)=>t in n?L6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,gf=(n,t)=>{for(var r in t||(t={}))$6.call(t,r)&&pf(n,r,t[r]);if(df)for(var r of df(t))M6.call(t,r)&&pf(n,r,t[r]);return n};class $a extends Zw{constructor(t,r,s,o=xi,l=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=h6,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(v=>{this.getKey&&v!==null&&!sr(v)?this.map.set(this.getKey(v),v):hw(v)?this.map.set(v.id,v):lw(v)&&this.map.set(v.topic,v)}),this.cached=[],this.initialized=!0)},this.set=async(v,d)=>{this.isInitialized(),this.map.has(v)?await this.update(v,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:v,value:d}),this.map.set(v,d),await this.persist())},this.get=v=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:v}),this.getData(v)),this.getAll=v=>(this.isInitialized(),v?this.values.filter(d=>Object.keys(v).every(g=>DE(d[g],v[g]))):this.values),this.update=async(v,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:v,update:d});const g=gf(gf({},this.getData(v)),d);this.map.set(v,g),await this.persist()},this.delete=async(v,d)=>{this.isInitialized(),this.map.has(v)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:v,reason:d}),this.map.delete(v),await this.persist())},this.logger=Qe.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=l}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class j6{constructor(t,r){this.core=t,this.logger=r,this.name=p6,this.version=g6,this.events=new Fr,this.initialized=!1,this.storagePrefix=xi,this.ignoredPayloadTypes=[Qi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Lc(),o=await this.core.crypto.setSymKey(s),l=Hr(Ee.FIVE_MINUTES),v={protocol:Pd},d={topic:o,expiry:l,relay:v,active:!1},g=ew({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:v});return await this.pairings.set(o,d),await this.core.relayer.subscribe(o),this.core.expirer.set(o,l),{topic:o,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:l,relay:v}=Zm(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const d=Hr(Ee.FIVE_MINUTES),g={topic:o,relay:v,expiry:d,active:!1};return await this.pairings.set(o,g),await this.core.crypto.setSymKey(l,o),await this.core.relayer.subscribe(o,{relay:v}),this.core.expirer.set(o,d),s.activatePairing&&await this.activate({topic:o}),g},this.activate=async({topic:s})=>{this.isInitialized();const o=Hr(Ee.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const l=await this.sendRequest(o,"wc_pairingPing",{}),{done:v,resolve:d,reject:g}=Sn();this.events.once(jt("pairing_ping",l),({error:w})=>{w?g(w):d()}),await v()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Nt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,l)=>{const v=Yc(o,l),d=await this.core.crypto.encode(s,v),g=rs[o].req;return this.core.history.set(s,v),await this.core.relayer.publish(s,d,g),v.id},this.sendResult=async(s,o,l)=>{const v=Wc(s,l),d=await this.core.crypto.encode(o,v),g=await this.core.history.get(o,s),w=rs[g.request.method].res;await this.core.relayer.publish(o,d,w),await this.core.history.resolve(v)},this.sendError=async(s,o,l)=>{const v=kc(s,l),d=await this.core.crypto.encode(o,v),g=await this.core.history.get(o,s),w=rs[g.request.method]?rs[g.request.method].res:rs.unregistered_method.res;await this.core.relayer.publish(o,d,w),await this.core.history.resolve(v)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Nt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ii(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:l}=s,v=l.method;if(this.pairings.keys.includes(o))switch(v){case"wc_pairingPing":return this.onPairingPingRequest(o,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,l);default:return this.onUnknownRpcMethodRequest(o,l)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:l}=s,v=(await this.core.history.get(o,l.id)).request.method;if(this.pairings.keys.includes(o))switch(v){case"wc_pairingPing":return this.onPairingPingResponse(o,l);default:return this.onUnknownRpcMethodResponse(v)}},this.onPairingPingRequest=async(s,o)=>{const{id:l}=o;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit("pairing_ping",{id:l,topic:s})}catch(v){await this.sendError(l,s,v),this.logger.error(v)}},this.onPairingPingResponse=(s,o)=>{const{id:l}=o;setTimeout(()=>{Si(o)?this.events.emit(jt("pairing_ping",l),{}):li(o)&&this.events.emit(jt("pairing_ping",l),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:l}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:l,topic:s})}catch(v){await this.sendError(l,s,v),this.logger.error(v)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:l,method:v}=o;try{if(this.registeredMethods.includes(v))return;const d=Nt("WC_METHOD_UNSUPPORTED",v);await this.sendError(l,s,d),this.logger.error(d)}catch(d){await this.sendError(l,s,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Nt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!pr(s)){const{message:o}=he("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!uw(s.uri)){const{message:o}=he("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!pr(s)){const{message:l}=he("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!pr(s)){const{message:l}=he("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Vt(s,!1)){const{message:o}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ii(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=he("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.pairings=new $a(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Kt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);Gc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Rf(o)&&(await this.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o}))})}registerExpirerEvents(){this.core.expirer.on(Rr.expired,async t=>{const{topic:r}=ad(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class z6 extends Ww{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Fr,this.name=v6,this.version=y6,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:l}),this.records.has(o.id))return;const v={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:l};this.records.set(v.id,v),this.events.emit(Xr.created,v)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=li(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Xr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(l=>{if(l.topic===s){if(typeof o<"u"&&l.id!==o)return;this.records.delete(l.id),this.events.emit(Xr.deleted,l)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Yc(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Xr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Xr.created,t=>{const r=Xr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Xr.updated,t=>{const r=Xr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Xr.deleted,t=>{const r=Xr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}let q6=class extends eE{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Fr,this.name=_6,this.version=b6,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const l=this.formatTarget(s),v={target:l,expiry:o};this.expirations.set(l,v),this.checkExpiry(l,v),this.events.emit(Rr.created,{target:l,expiration:v})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),l=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Rr.deleted,{target:o,expiration:l})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Km(t);if(typeof t=="number")return Vm(t);const{message:r}=he("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;Ee.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Rr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(ls.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Rr.created,t=>{const r=Rr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.expired,t=>{const r=Rr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.deleted,t=>{const r=Rr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}};class H6 extends tE{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=of,this.initialized=!1,this.init=async s=>{td()||!iu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||cf,await this.createIframe())},this.register=async s=>{var o;this.initialized||await this.init(),this.iframe&&((o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`))},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const l=this.startAbortTimer(Ee.FIVE_SECONDS),v=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),v.status===200?(o=await v.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{const s=this.startAbortTimer(Ee.FIVE_SECONDS);await Promise.race([new Promise((o,l)=>{const v=document.createElement("iframe");v.setAttribute("id",of),v.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),v.style.display="none",v.addEventListener("load",()=>{this.initialized=!0,clearTimeout(s),o()}),v.addEventListener("error",d=>{l(d)}),document.body.append(v),this.iframe=v}),new Promise(o=>{this.abortController.signal.addEventListener("abort",()=>{o("iframe load timeout")})})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(r,this.name),this.verifyUrl=cf,this.abortController=new AbortController,this.isDevEnv=ru()&&{}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),Hr(t))}}var B6=Object.defineProperty,vf=Object.getOwnPropertySymbols,K6=Object.prototype.hasOwnProperty,V6=Object.prototype.propertyIsEnumerable,yf=(n,t,r)=>t in n?B6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,_f=(n,t)=>{for(var r in t||(t={}))K6.call(t,r)&&yf(n,r,t[r]);if(vf)for(var r of vf(t))V6.call(t,r)&&yf(n,r,t[r]);return n};let k6=class Td extends Gw{constructor(t){super(t),this.protocol=Od,this.version=W3,this.name=ou,this.events=new Fr,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Nd;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Y3.logger}));this.logger=Qe.generateChildLogger(r,this.name),this.heartbeat=new ls.HeartBeat,this.crypto=new w6(this,this.logger,t==null?void 0:t.keychain),this.history=new z6(this,this.logger),this.expirer=new q6(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Mw(_f(_f({},J3),t==null?void 0:t.storageOptions)),this.relayer=new F6({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new j6(this,this.logger),this.verify=new H6(this.projectId||"",this.logger)}static async init(t){const r=new Td(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const G6=k6,Rd="wc",Ud=2,Fd="client",cu=`${Rd}@${Ud}:${Fd}:`,Ec={name:Fd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},W6="proposal",Ld="Proposal expired",Y6="session",ya=Ee.SEVEN_DAYS,J6="engine",ns={wc_sessionPropose:{req:{ttl:Ee.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Ee.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Ee.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Ee.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Ee.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Ee.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Ee.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Ee.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Ee.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Ee.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Ee.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Ee.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Ee.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Ee.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Ee.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Ee.THIRTY_SECONDS,prompt:!1,tag:1115}}},Dc={min:Ee.FIVE_MINUTES,max:Ee.SEVEN_DAYS},X6="request",Z6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Q6=Object.defineProperty,e2=Object.defineProperties,t2=Object.getOwnPropertyDescriptors,bf=Object.getOwnPropertySymbols,r2=Object.prototype.hasOwnProperty,i2=Object.prototype.propertyIsEnumerable,mf=(n,t,r)=>t in n?Q6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Tr=(n,t)=>{for(var r in t||(t={}))r2.call(t,r)&&mf(n,r,t[r]);if(bf)for(var r of bf(t))i2.call(t,r)&&mf(n,r,t[r]);return n},Sc=(n,t)=>e2(n,t2(t));class n2 extends iE{constructor(t){super(t),this.name=J6,this.events=new Fr,this.initialized=!1,this.ignoredPayloadTypes=[Qi],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ns)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Sc(Tr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:l,optionalNamespaces:v,sessionProperties:d,relays:g}=s;let w=o,S,F=!1;if(w&&(F=this.client.core.pairing.pairings.get(w).active),!w||!F){const{topic:R,uri:D}=await this.client.core.pairing.create();w=R,S=D}const q=await this.client.core.crypto.generateKeyPair(),L=Tr({requiredNamespaces:l,optionalNamespaces:v,relays:g??[{protocol:Pd}],proposer:{publicKey:q,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:$,resolve:B,done:G}=Sn(Ee.FIVE_MINUTES,Ld);if(this.events.once(jt("session_connect"),async({error:R,session:D})=>{if(R)$(R);else if(D){D.self.publicKey=q;const x=Sc(Tr({},D),{requiredNamespaces:D.requiredNamespaces,optionalNamespaces:D.optionalNamespaces});await this.client.session.set(D.topic,x),await this.setExpiry(D.topic,D.expiry),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:D.peer.metadata}),B(x)}}),!w){const{message:R}=he("NO_MATCHING_KEY",`connect() pairing topic: ${w}`);throw new Error(R)}const ie=await this.sendRequest(w,"wc_sessionPropose",L),A=Hr(Ee.FIVE_MINUTES);return await this.setProposal(ie,Tr({id:ie,expiry:A},L)),{uri:S,approval:G}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:l,sessionProperties:v}=r,d=this.client.proposal.get(s);let{pairingTopic:g,proposer:w,requiredNamespaces:S,optionalNamespaces:F}=d;g=g||"",xn(S)||(S=nw(l,"approve()"));const q=await this.client.core.crypto.generateKeyPair(),L=w.publicKey,$=await this.client.core.crypto.generateSharedKey(q,L);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:w.metadata}),await this.sendResult(s,g,{relay:{protocol:o??"irn"},responderPublicKey:q}),await this.client.proposal.delete(s,Nt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const B=Tr({relay:{protocol:o??"irn"},namespaces:l,requiredNamespaces:S,optionalNamespaces:F,pairingTopic:g,controller:{publicKey:q,metadata:this.client.metadata},expiry:Hr(ya)},v&&{sessionProperties:v});await this.client.core.relayer.subscribe($),await this.sendRequest($,"wc_sessionSettle",B);const G=Sc(Tr({},B),{topic:$,pairingTopic:g,acknowledged:!1,self:B.controller,peer:{publicKey:w.publicKey,metadata:w.metadata},controller:q});return await this.client.session.set($,G),await this.setExpiry($,Hr(ya)),{topic:$,acknowledged:()=>new Promise(ie=>ie(this.client.session.get($)))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,o),await this.client.proposal.delete(s,Nt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,l=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:v,resolve:d,reject:g}=Sn();return this.events.once(jt("session_update",l),({error:w})=>{w?g(w):d()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:v}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:l,resolve:v,reject:d}=Sn();return this.events.once(jt("session_extend",o),({error:g})=>{g?d(g):v()}),await this.setExpiry(s,Hr(ya)),{acknowledged:l}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:l,expiry:v}=r,d=await this.sendRequest(l,"wc_sessionRequest",{request:o,chainId:s},v),{done:g,resolve:w,reject:S}=Sn(v);return this.events.once(jt("session_request",d),({error:F,result:q})=>{F?S(F):w(q)}),this.client.events.emit("session_request_sent",{topic:l,request:o,chainId:s,id:d}),await g()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:l}=o;Si(o)?await this.sendResult(l,s,o.result):li(o)&&await this.sendError(l,s,o.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:l,resolve:v,reject:d}=Sn();this.events.once(jt("session_ping",o),({error:g})=>{g?d(g):v()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:l}=r;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:l})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest(s,"wc_sessionDelete",Nt("USER_DISCONNECTED")),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>ow(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Nt("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.deleteSymKey(r),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Nt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=ns.wc_sessionRequest.req.ttl,{id:o,topic:l,params:v}=r;await this.client.pendingRequest.set(o,{id:o,topic:l,params:v}),s&&this.client.core.expirer.set(o,Hr(s))},this.sendRequest=async(r,s,o,l)=>{const v=Yc(s,o);if(iu()&&Z6.includes(s)){const w=Xi(JSON.stringify(v));await this.client.core.verify.register({attestationId:w})}const d=await this.client.core.crypto.encode(r,v),g=ns[s].req;return l&&(g.ttl=l),this.client.core.history.set(r,v),this.client.core.relayer.publish(r,d,g),v.id},this.sendResult=async(r,s,o)=>{const l=Wc(r,o),v=await this.client.core.crypto.encode(s,l),d=await this.client.core.history.get(s,r),g=ns[d.request.method].res;this.client.core.relayer.publish(s,v,g),await this.client.core.history.resolve(l)},this.sendError=async(r,s,o)=>{const l=kc(r,o),v=await this.client.core.crypto.encode(s,l),d=await this.client.core.history.get(s,r),g=ns[d.request.method].res;this.client.core.relayer.publish(s,v,g),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{Ii(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ii(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=r=>{const{topic:s,payload:o}=r,l=o.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,l=(await this.client.core.history.get(s,o.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:l}=s;try{this.isValidConnect(Tr({},s.params));const v=Hr(Ee.FIVE_MINUTES),d=Tr({id:l,pairingTopic:r,expiry:v},o);await this.setProposal(l,d);const g=Xi(JSON.stringify(s)),w=await this.getVerifyContext(g,d.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:d,context:w})}catch(v){await this.sendError(l,r,v),this.client.logger.error(v)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(Si(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const v=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:v});const d=v.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const g=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const w=await this.client.core.crypto.generateSharedKey(d,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const S=await this.client.core.relayer.subscribe(w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:r})}else li(s)&&(await this.client.proposal.delete(o,Nt("USER_DISCONNECTED")),this.events.emit(jt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:v,controller:d,expiry:g,namespaces:w,requiredNamespaces:S,optionalNamespaces:F,sessionProperties:q,pairingTopic:L}=s.params,$=Tr({topic:r,relay:v,expiry:g,namespaces:w,acknowledged:!0,pairingTopic:L,requiredNamespaces:S,optionalNamespaces:F,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},q&&{sessionProperties:q});await this.sendResult(s.id,r,!0),this.events.emit(jt("session_connect"),{session:$})}catch(v){await this.sendError(o,r,v),this.client.logger.error(v)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;Si(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(jt("session_approve",o),{})):li(s)&&(await this.client.session.delete(r,Nt("USER_DISCONNECTED")),this.events.emit(jt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:l}=s;try{this.isValidUpdate(Tr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult(l,r,!0),this.client.events.emit("session_update",{id:l,topic:r,params:o})}catch(v){await this.sendError(l,r,v),this.client.logger.error(v)}},this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;Si(s)?this.events.emit(jt("session_update",o),{}):li(s)&&this.events.emit(jt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Hr(ya)),await this.sendResult(o,r,!0),this.client.events.emit("session_extend",{id:o,topic:r})}catch(l){await this.sendError(o,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;Si(s)?this.events.emit(jt("session_extend",o),{}):li(s)&&this.events.emit(jt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult(o,r,!0),this.client.events.emit("session_ping",{id:o,topic:r})}catch(l){await this.sendError(o,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{Si(s)?this.events.emit(jt("session_ping",o),{}):li(s)&&this.events.emit(jt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Kt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult(o,r,!0)]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(l){await this.sendError(o,r,l),this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:l}=s;try{this.isValidRequest(Tr({topic:r},l)),await this.setPendingSessionRequest({id:o,topic:r,params:l});const v=Xi(JSON.stringify(s)),d=this.client.session.get(r),g=await this.getVerifyContext(v,d.peer.metadata);this.client.events.emit("session_request",{id:o,topic:r,params:l,context:g})}catch(v){await this.sendError(o,r,v),this.client.logger.error(v)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;Si(s)?this.events.emit(jt("session_request",o),{result:s.result}):li(s)&&this.events.emit(jt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:l}=s;try{this.isValidEmit(Tr({topic:r},l)),this.client.events.emit("session_event",{id:o,topic:r,params:l})}catch(v){await this.sendError(o,r,v),this.client.logger.error(v)}},this.isValidConnect=async r=>{if(!pr(r)){const{message:g}=he("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:l,sessionProperties:v,relays:d}=r;if(sr(s)||await this.isValidPairingTopic(s),!bw(d,!0)){const{message:g}=he("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(g)}!sr(o)&&xn(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!sr(l)&&xn(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),sr(v)||this.validateSessionProps(v,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=_w(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!pr(r))throw new Error(he("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:l,sessionProperties:v}=r;await this.isValidProposalId(s);const d=this.client.proposal.get(s),g=Ea(o,"approve()");if(g)throw new Error(g.message);const w=Ul(d.requiredNamespaces,o,"approve()");if(w)throw new Error(w.message);if(!Vt(l,!0)){const{message:S}=he("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(S)}sr(v)||this.validateSessionProps(v,"sessionProperties")},this.isValidReject=async r=>{if(!pr(r)){const{message:l}=he("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!ww(o)){const{message:l}=he("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!pr(r)){const{message:w}=he("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(w)}const{relay:s,controller:o,namespaces:l,expiry:v}=r;if(!ud(s)){const{message:w}=he("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(w)}const d=fw(o,"onSessionSettleRequest()");if(d)throw new Error(d.message);const g=Ea(l,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Ii(v)){const{message:w}=he("EXPIRED","onSessionSettleRequest()");throw new Error(w)}},this.isValidUpdate=async r=>{if(!pr(r)){const{message:g}=he("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(g)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),v=Ea(o,"update()");if(v)throw new Error(v.message);const d=Ul(l.requiredNamespaces,o,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async r=>{if(!pr(r)){const{message:o}=he("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!pr(r)){const{message:g}=he("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(g)}const{topic:s,request:o,chainId:l,expiry:v}=r;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Rl(d,l)){const{message:g}=he("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(g)}if(!Ew(o)){const{message:g}=he("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(g)}if(!Iw(d,l,o.method)){const{message:g}=he("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(g)}if(v&&!Ow(v,Dc)){const{message:g}=he("MISSING_OR_INVALID",`request() expiry: ${v}. Expiry must be a number (in seconds) between ${Dc.min} and ${Dc.max}`);throw new Error(g)}},this.isValidRespond=async r=>{if(!pr(r)){const{message:l}=he("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!Dw(o)){const{message:l}=he("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!pr(r)){const{message:o}=he("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!pr(r)){const{message:d}=he("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}const{topic:s,event:o,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:v}=this.client.session.get(s);if(!Rl(v,l)){const{message:d}=he("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(d)}if(!Sw(o)){const{message:d}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}if(!xw(v,l,o.name)){const{message:d}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(d)}},this.isValidDisconnect=async r=>{if(!pr(r)){const{message:o}=he("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(o.verified.origin=l,o.verified.validation=l===s.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Vt(o,!1)){const{message:l}=he("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Kt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);Gc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Rf(o)&&(await this.client.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o}))})}registerExpirerEvents(){this.client.core.expirer.on(Rr.expired,async t=>{const{topic:r,id:s}=ad(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,he("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!Vt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=he("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Vt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=he("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Vt(t,!1)){const{message:r}=he("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=he("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!mw(t)){const{message:r}=he("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=he("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class s2 extends $a{constructor(t,r){super(t,r,W6,cu),this.core=t,this.logger=r}}class a2 extends $a{constructor(t,r){super(t,r,Y6,cu),this.core=t,this.logger=r}}class o2 extends $a{constructor(t,r){super(t,r,X6,cu,s=>s.id),this.core=t,this.logger=r}}let c2=class $d extends rE{constructor(t){super(t),this.protocol=Rd,this.version=Ud,this.name=Ec.name,this.events=new Fr,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Ec.name,this.metadata=(t==null?void 0:t.metadata)||jm();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Ec.logger}));this.core=(t==null?void 0:t.core)||new G6(t),this.logger=Qe.generateChildLogger(r,this.name),this.session=new a2(this.core,this.logger),this.proposal=new s2(this.core,this.logger),this.pendingRequest=new o2(this.core,this.logger),this.engine=new n2(this)}static async init(t){const r=new $d(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};const wf="error",u2="wss://relay.walletconnect.com",h2="wc",l2="universal_provider",Ef=`${h2}@2:${l2}:`,f2="https://rpc.walletconnect.com/v1",Oi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ss=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",o=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",v="Expected a function",d="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",w=500,S="__lodash_placeholder__",F=1,q=2,L=4,$=1,B=2,G=1,ie=2,A=4,R=8,D=16,x=32,b=64,c=128,_=256,K=512,k=30,ae="...",ce=800,ge=16,P=1,z=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,xe=re-1,ne=re>>>1,be=[["ary",c],["bind",G],["bindKey",ie],["curry",R],["curryRight",D],["flip",K],["partial",x],["partialRight",b],["rearg",_]],ue="[object Arguments]",ye="[object Array]",j="[object AsyncFunction]",M="[object Boolean]",O="[object Date]",h="[object DOMException]",I="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",Se="[object Map]",He="[object Number]",Ve="[object Null]",$e="[object Object]",dt="[object Promise]",pt="[object Proxy]",je="[object RegExp]",Ie="[object Set]",Re="[object String]",Ue="[object Symbol]",ze="[object Undefined]",Ae="[object WeakMap]",Fe="[object WeakSet]",De="[object ArrayBuffer]",Oe="[object DataView]",Be="[object Float32Array]",Ce="[object Float64Array]",ke="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",Zt="[object Uint16Array]",cr="[object Uint32Array]",Kr=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,Qr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,di=/&(?:amp|lt|gt|quot|#39);/g,Pi=/[&<>"']/g,mt=RegExp(di.source),gt=RegExp(Pi.source),wt=/<%-([\s\S]+?)%>/g,Et=/<%([\s\S]+?)%>/g,_t=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tt=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dt=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(Dt.source),St=/^\s+/,Ct=/\s/,It=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Ft=/,? & /,Lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ma=/[()=,{}\[\]\/\s]/,ja=/\\(\\)?/g,za=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Dr=/\w*$/,qa=/^[-+]0x[0-9a-f]+$/i,Ha=/^0b[01]+$/i,Ba=/^\[object .+?Constructor\]$/,Ka=/^0o[0-7]+$/i,Va=/^(?:0|[1-9]\d*)$/,ei=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rn=/($^)/,ka=/['\n\r\u2028\u2029\\]/g,nn="\\ud800-\\udfff",Ga="\\u0300-\\u036f",Wa="\\ufe20-\\ufe2f",sn="\\u20d0-\\u20ff",ds=Ga+Wa+sn,ps="\\u2700-\\u27bf",Lr="a-z\\xdf-\\xf6\\xf8-\\xff",Ya="\\xac\\xb1\\xd7\\xf7",Ja="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xa="\\u2000-\\u206f",Za=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",gs="A-Z\\xc0-\\xd6\\xd8-\\xde",vs="\\ufe0e\\ufe0f",Ni=Ya+Ja+Xa+Za,On="['â€™]",Ti="["+nn+"]",Pn="["+Ni+"]",Ri="["+ds+"]",ys="\\d+",Qa="["+ps+"]",_s="["+Lr+"]",bs="[^"+nn+Ni+ys+ps+Lr+gs+"]",an="\\ud83c[\\udffb-\\udfff]",eo="(?:"+Ri+"|"+an+")",ms="[^"+nn+"]",on="(?:\\ud83c[\\udde6-\\uddff]){2}",pi="[\\ud800-\\udbff][\\udc00-\\udfff]",vr="["+gs+"]",ws="\\u200d",Es="(?:"+_s+"|"+bs+")",Vr="(?:"+vr+"|"+bs+")",Ds="(?:"+On+"(?:d|ll|m|re|s|t|ve))?",Ss="(?:"+On+"(?:D|LL|M|RE|S|T|VE))?",Is=eo+"?",xs="["+vs+"]?",to="(?:"+ws+"(?:"+[ms,on,pi].join("|")+")"+xs+Is+")*",ti="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Cs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",As=xs+Is+to,cn="(?:"+[Qa,on,pi].join("|")+")"+As,ro="(?:"+[ms+Ri+"?",Ri,on,pi,Ti].join("|")+")",Nn=RegExp(On,"g"),io=RegExp(Ri,"g"),un=RegExp(an+"(?="+an+")|"+ro+As,"g"),Os=RegExp([vr+"?"+_s+"+"+Ds+"(?="+[Pn,vr,"$"].join("|")+")",Vr+"+"+Ss+"(?="+[Pn,vr+Es,"$"].join("|")+")",vr+"?"+Es+"+"+Ds,vr+"+"+Ss,Cs,ti,ys,cn].join("|"),"g"),Ps=RegExp("["+ws+nn+ds+vs+"]"),Ui=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ns=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],no=-1,at={};at[Be]=at[Ce]=at[ke]=at[We]=at[et]=at[tt]=at[Je]=at[Zt]=at[cr]=!0,at[ue]=at[ye]=at[De]=at[M]=at[Oe]=at[O]=at[I]=at[se]=at[Se]=at[He]=at[$e]=at[je]=at[Ie]=at[Re]=at[Ae]=!1;var st={};st[ue]=st[ye]=st[De]=st[Oe]=st[M]=st[O]=st[Be]=st[Ce]=st[ke]=st[We]=st[et]=st[Se]=st[He]=st[$e]=st[je]=st[Ie]=st[Re]=st[Ue]=st[tt]=st[Je]=st[Zt]=st[cr]=!0,st[I]=st[se]=st[Ae]=!1;var m={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"s"},N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Ne=parseInt,lt=typeof ss=="object"&&ss&&ss.Object===Object&&ss,$t=typeof self=="object"&&self&&self.Object===Object&&self,Xe=lt||$t||Function("return this")(),ct=t&&!t.nodeType&&t,At=ct&&!0&&n&&!n.nodeType&&n,ur=At&&At.exports===ct,Mt=ur&&lt.process,ft=function(){try{var T=At&&At.require&&At.require("util").types;return T||Mt&&Mt.binding&&Mt.binding("util")}catch{}}(),er=ft&&ft.isArrayBuffer,$r=ft&&ft.isDate,Sr=ft&&ft.isMap,kr=ft&&ft.isRegExp,Tn=ft&&ft.isSet,Fi=ft&&ft.isTypedArray;function Ht(T,V,H){switch(H.length){case 0:return T.call(V);case 1:return T.call(V,H[0]);case 2:return T.call(V,H[0],H[1]);case 3:return T.call(V,H[0],H[1],H[2])}return T.apply(V,H)}function Md(T,V,H,pe){for(var Pe=-1,rt=T==null?0:T.length;++Pe<rt;){var zt=T[Pe];V(pe,zt,H(zt),T)}return pe}function Ir(T,V){for(var H=-1,pe=T==null?0:T.length;++H<pe&&V(T[H],H,T)!==!1;);return T}function jd(T,V){for(var H=T==null?0:T.length;H--&&V(T[H],H,T)!==!1;);return T}function lu(T,V){for(var H=-1,pe=T==null?0:T.length;++H<pe;)if(!V(T[H],H,T))return!1;return!0}function gi(T,V){for(var H=-1,pe=T==null?0:T.length,Pe=0,rt=[];++H<pe;){var zt=T[H];V(zt,H,T)&&(rt[Pe++]=zt)}return rt}function Ts(T,V){var H=T==null?0:T.length;return!!H&&hn(T,V,0)>-1}function so(T,V,H){for(var pe=-1,Pe=T==null?0:T.length;++pe<Pe;)if(H(V,T[pe]))return!0;return!1}function yt(T,V){for(var H=-1,pe=T==null?0:T.length,Pe=Array(pe);++H<pe;)Pe[H]=V(T[H],H,T);return Pe}function vi(T,V){for(var H=-1,pe=V.length,Pe=T.length;++H<pe;)T[Pe+H]=V[H];return T}function ao(T,V,H,pe){var Pe=-1,rt=T==null?0:T.length;for(pe&&rt&&(H=T[++Pe]);++Pe<rt;)H=V(H,T[Pe],Pe,T);return H}function zd(T,V,H,pe){var Pe=T==null?0:T.length;for(pe&&Pe&&(H=T[--Pe]);Pe--;)H=V(H,T[Pe],Pe,T);return H}function oo(T,V){for(var H=-1,pe=T==null?0:T.length;++H<pe;)if(V(T[H],H,T))return!0;return!1}var qd=co("length");function Hd(T){return T.split("")}function Bd(T){return T.match(Lt)||[]}function fu(T,V,H){var pe;return H(T,function(Pe,rt,zt){if(V(Pe,rt,zt))return pe=rt,!1}),pe}function Rs(T,V,H,pe){for(var Pe=T.length,rt=H+(pe?1:-1);pe?rt--:++rt<Pe;)if(V(T[rt],rt,T))return rt;return-1}function hn(T,V,H){return V===V?tp(T,V,H):Rs(T,du,H)}function Kd(T,V,H,pe){for(var Pe=H-1,rt=T.length;++Pe<rt;)if(pe(T[Pe],V))return Pe;return-1}function du(T){return T!==T}function pu(T,V){var H=T==null?0:T.length;return H?ho(T,V)/H:Y}function co(T){return function(V){return V==null?r:V[T]}}function uo(T){return function(V){return T==null?r:T[V]}}function gu(T,V,H,pe,Pe){return Pe(T,function(rt,zt,ut){H=pe?(pe=!1,rt):V(H,rt,zt,ut)}),H}function Vd(T,V){var H=T.length;for(T.sort(V);H--;)T[H]=T[H].value;return T}function ho(T,V){for(var H,pe=-1,Pe=T.length;++pe<Pe;){var rt=V(T[pe]);rt!==r&&(H=H===r?rt:H+rt)}return H}function lo(T,V){for(var H=-1,pe=Array(T);++H<T;)pe[H]=V(H);return pe}function kd(T,V){return yt(V,function(H){return[H,T[H]]})}function vu(T){return T&&T.slice(0,mu(T)+1).replace(St,"")}function yr(T){return function(V){return T(V)}}function fo(T,V){return yt(V,function(H){return T[H]})}function Rn(T,V){return T.has(V)}function yu(T,V){for(var H=-1,pe=T.length;++H<pe&&hn(V,T[H],0)>-1;);return H}function _u(T,V){for(var H=T.length;H--&&hn(V,T[H],0)>-1;);return H}function Gd(T,V){for(var H=T.length,pe=0;H--;)T[H]===V&&++pe;return pe}var Wd=uo(m),Yd=uo(N);function Jd(T){return"\\"+de[T]}function Xd(T,V){return T==null?r:T[V]}function ln(T){return Ps.test(T)}function Zd(T){return Ui.test(T)}function Qd(T){for(var V,H=[];!(V=T.next()).done;)H.push(V.value);return H}function po(T){var V=-1,H=Array(T.size);return T.forEach(function(pe,Pe){H[++V]=[Pe,pe]}),H}function bu(T,V){return function(H){return T(V(H))}}function yi(T,V){for(var H=-1,pe=T.length,Pe=0,rt=[];++H<pe;){var zt=T[H];(zt===V||zt===S)&&(T[H]=S,rt[Pe++]=H)}return rt}function Us(T){var V=-1,H=Array(T.size);return T.forEach(function(pe){H[++V]=pe}),H}function ep(T){var V=-1,H=Array(T.size);return T.forEach(function(pe){H[++V]=[pe,pe]}),H}function tp(T,V,H){for(var pe=H-1,Pe=T.length;++pe<Pe;)if(T[pe]===V)return pe;return-1}function rp(T,V,H){for(var pe=H+1;pe--;)if(T[pe]===V)return pe;return pe}function fn(T){return ln(T)?np(T):qd(T)}function Mr(T){return ln(T)?sp(T):Hd(T)}function mu(T){for(var V=T.length;V--&&Ct.test(T.charAt(V)););return V}var ip=uo(Z);function np(T){for(var V=un.lastIndex=0;un.test(T);)++V;return V}function sp(T){return T.match(un)||[]}function ap(T){return T.match(Os)||[]}var op=function T(V){V=V==null?Xe:dn.defaults(Xe.Object(),V,dn.pick(Xe,Ns));var H=V.Array,pe=V.Date,Pe=V.Error,rt=V.Function,zt=V.Math,ut=V.Object,go=V.RegExp,cp=V.String,xr=V.TypeError,Fs=H.prototype,up=rt.prototype,pn=ut.prototype,Ls=V["__core-js_shared__"],$s=up.toString,nt=pn.hasOwnProperty,hp=0,wu=function(){var e=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ms=pn.toString,lp=$s.call(ut),fp=Xe._,dp=go("^"+$s.call(nt).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),js=ur?V.Buffer:r,_i=V.Symbol,zs=V.Uint8Array,Eu=js?js.allocUnsafe:r,qs=bu(ut.getPrototypeOf,ut),Du=ut.create,Su=pn.propertyIsEnumerable,Hs=Fs.splice,Iu=_i?_i.isConcatSpreadable:r,Un=_i?_i.iterator:r,Li=_i?_i.toStringTag:r,Bs=function(){try{var e=qi(ut,"defineProperty");return e({},"",{}),e}catch{}}(),pp=V.clearTimeout!==Xe.clearTimeout&&V.clearTimeout,gp=pe&&pe.now!==Xe.Date.now&&pe.now,vp=V.setTimeout!==Xe.setTimeout&&V.setTimeout,Ks=zt.ceil,Vs=zt.floor,vo=ut.getOwnPropertySymbols,yp=js?js.isBuffer:r,xu=V.isFinite,_p=Fs.join,bp=bu(ut.keys,ut),qt=zt.max,Yt=zt.min,mp=pe.now,wp=V.parseInt,Cu=zt.random,Ep=Fs.reverse,yo=qi(V,"DataView"),Fn=qi(V,"Map"),_o=qi(V,"Promise"),gn=qi(V,"Set"),Ln=qi(V,"WeakMap"),$n=qi(ut,"create"),ks=Ln&&new Ln,vn={},Dp=Hi(yo),Sp=Hi(Fn),Ip=Hi(_o),xp=Hi(gn),Cp=Hi(Ln),Gs=_i?_i.prototype:r,Mn=Gs?Gs.valueOf:r,Au=Gs?Gs.toString:r;function p(e){if(xt(e)&&!Te(e)&&!(e instanceof Ye)){if(e instanceof Cr)return e;if(nt.call(e,"__wrapped__"))return Oh(e)}return new Cr(e)}var yn=function(){function e(){}return function(i){if(!bt(i))return{};if(Du)return Du(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function Ws(){}function Cr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}p.templateSettings={escape:wt,evaluate:Et,interpolate:_t,variable:"",imports:{_:p}},p.prototype=Ws.prototype,p.prototype.constructor=p,Cr.prototype=yn(Ws.prototype),Cr.prototype.constructor=Cr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Ap(){var e=new Ye(this.__wrapped__);return e.__actions__=hr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=hr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=hr(this.__views__),e}function Op(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Pp(){var e=this.__wrapped__.value(),i=this.__dir__,a=Te(e),u=i<0,f=a?e.length:0,y=Hg(0,f,this.__views__),E=y.start,C=y.end,U=C-E,J=u?C:E-1,X=this.__iteratees__,Q=X.length,oe=0,ve=Yt(U,this.__takeCount__);if(!a||!u&&f==U&&ve==U)return Zu(e,this.__actions__);var me=[];e:for(;U--&&oe<ve;){J+=i;for(var qe=-1,we=e[J];++qe<Q;){var Ge=X[qe],Ze=Ge.iteratee,mr=Ge.type,ir=Ze(we);if(mr==z)we=ir;else if(!ir){if(mr==P)continue e;break e}}me[oe++]=we}return me}Ye.prototype=yn(Ws.prototype),Ye.prototype.constructor=Ye;function $i(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function Np(){this.__data__=$n?$n(null):{},this.size=0}function Tp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Rp(e){var i=this.__data__;if($n){var a=i[e];return a===g?r:a}return nt.call(i,e)?i[e]:r}function Up(e){var i=this.__data__;return $n?i[e]!==r:nt.call(i,e)}function Fp(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=$n&&i===r?g:i,this}$i.prototype.clear=Np,$i.prototype.delete=Tp,$i.prototype.get=Rp,$i.prototype.has=Up,$i.prototype.set=Fp;function ri(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function Lp(){this.__data__=[],this.size=0}function $p(e){var i=this.__data__,a=Ys(i,e);if(a<0)return!1;var u=i.length-1;return a==u?i.pop():Hs.call(i,a,1),--this.size,!0}function Mp(e){var i=this.__data__,a=Ys(i,e);return a<0?r:i[a][1]}function jp(e){return Ys(this.__data__,e)>-1}function zp(e,i){var a=this.__data__,u=Ys(a,e);return u<0?(++this.size,a.push([e,i])):a[u][1]=i,this}ri.prototype.clear=Lp,ri.prototype.delete=$p,ri.prototype.get=Mp,ri.prototype.has=jp,ri.prototype.set=zp;function ii(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function qp(){this.size=0,this.__data__={hash:new $i,map:new(Fn||ri),string:new $i}}function Hp(e){var i=oa(this,e).delete(e);return this.size-=i?1:0,i}function Bp(e){return oa(this,e).get(e)}function Kp(e){return oa(this,e).has(e)}function Vp(e,i){var a=oa(this,e),u=a.size;return a.set(e,i),this.size+=a.size==u?0:1,this}ii.prototype.clear=qp,ii.prototype.delete=Hp,ii.prototype.get=Bp,ii.prototype.has=Kp,ii.prototype.set=Vp;function Mi(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new ii;++i<a;)this.add(e[i])}function kp(e){return this.__data__.set(e,g),this}function Gp(e){return this.__data__.has(e)}Mi.prototype.add=Mi.prototype.push=kp,Mi.prototype.has=Gp;function jr(e){var i=this.__data__=new ri(e);this.size=i.size}function Wp(){this.__data__=new ri,this.size=0}function Yp(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function Jp(e){return this.__data__.get(e)}function Xp(e){return this.__data__.has(e)}function Zp(e,i){var a=this.__data__;if(a instanceof ri){var u=a.__data__;if(!Fn||u.length<o-1)return u.push([e,i]),this.size=++a.size,this;a=this.__data__=new ii(u)}return a.set(e,i),this.size=a.size,this}jr.prototype.clear=Wp,jr.prototype.delete=Yp,jr.prototype.get=Jp,jr.prototype.has=Xp,jr.prototype.set=Zp;function Ou(e,i){var a=Te(e),u=!a&&Bi(e),f=!a&&!u&&Di(e),y=!a&&!u&&!f&&wn(e),E=a||u||f||y,C=E?lo(e.length,cp):[],U=C.length;for(var J in e)(i||nt.call(e,J))&&!(E&&(J=="length"||f&&(J=="offset"||J=="parent")||y&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||oi(J,U)))&&C.push(J);return C}function Pu(e){var i=e.length;return i?e[Oo(0,i-1)]:r}function Qp(e,i){return ca(hr(e),ji(i,0,e.length))}function eg(e){return ca(hr(e))}function bo(e,i,a){(a!==r&&!zr(e[i],a)||a===r&&!(i in e))&&ni(e,i,a)}function jn(e,i,a){var u=e[i];(!(nt.call(e,i)&&zr(u,a))||a===r&&!(i in e))&&ni(e,i,a)}function Ys(e,i){for(var a=e.length;a--;)if(zr(e[a][0],i))return a;return-1}function tg(e,i,a,u){return bi(e,function(f,y,E){i(u,f,a(f),E)}),u}function Nu(e,i){return e&&Wr(i,Bt(i),e)}function rg(e,i){return e&&Wr(i,fr(i),e)}function ni(e,i,a){i=="__proto__"&&Bs?Bs(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function mo(e,i){for(var a=-1,u=i.length,f=H(u),y=e==null;++a<u;)f[a]=y?r:ec(e,i[a]);return f}function ji(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Ar(e,i,a,u,f,y){var E,C=i&F,U=i&q,J=i&L;if(a&&(E=f?a(e,u,f,y):a(e)),E!==r)return E;if(!bt(e))return e;var X=Te(e);if(X){if(E=Kg(e),!C)return hr(e,E)}else{var Q=Jt(e),oe=Q==se||Q==fe;if(Di(e))return th(e,C);if(Q==$e||Q==ue||oe&&!f){if(E=U||oe?{}:mh(e),!C)return U?Rg(e,rg(E,e)):Tg(e,Nu(E,e))}else{if(!st[Q])return f?e:{};E=Vg(e,Q,C)}}y||(y=new jr);var ve=y.get(e);if(ve)return ve;y.set(e,E),Yh(e)?e.forEach(function(we){E.add(Ar(we,i,a,we,e,y))}):Gh(e)&&e.forEach(function(we,Ge){E.set(Ge,Ar(we,i,a,Ge,e,y))});var me=J?U?zo:jo:U?fr:Bt,qe=X?r:me(e);return Ir(qe||e,function(we,Ge){qe&&(Ge=we,we=e[Ge]),jn(E,Ge,Ar(we,i,a,Ge,e,y))}),E}function ig(e){var i=Bt(e);return function(a){return Tu(a,e,i)}}function Tu(e,i,a){var u=a.length;if(e==null)return!u;for(e=ut(e);u--;){var f=a[u],y=i[f],E=e[f];if(E===r&&!(f in e)||!y(E))return!1}return!0}function Ru(e,i,a){if(typeof e!="function")throw new xr(v);return kn(function(){e.apply(r,a)},i)}function zn(e,i,a,u){var f=-1,y=Ts,E=!0,C=e.length,U=[],J=i.length;if(!C)return U;a&&(i=yt(i,yr(a))),u?(y=so,E=!1):i.length>=o&&(y=Rn,E=!1,i=new Mi(i));e:for(;++f<C;){var X=e[f],Q=a==null?X:a(X);if(X=u||X!==0?X:0,E&&Q===Q){for(var oe=J;oe--;)if(i[oe]===Q)continue e;U.push(X)}else y(i,Q,u)||U.push(X)}return U}var bi=ah(Gr),Uu=ah(Eo,!0);function ng(e,i){var a=!0;return bi(e,function(u,f,y){return a=!!i(u,f,y),a}),a}function Js(e,i,a){for(var u=-1,f=e.length;++u<f;){var y=e[u],E=i(y);if(E!=null&&(C===r?E===E&&!br(E):a(E,C)))var C=E,U=y}return U}function sg(e,i,a,u){var f=e.length;for(a=Me(a),a<0&&(a=-a>f?0:f+a),u=u===r||u>f?f:Me(u),u<0&&(u+=f),u=a>u?0:Xh(u);a<u;)e[a++]=i;return e}function Fu(e,i){var a=[];return bi(e,function(u,f,y){i(u,f,y)&&a.push(u)}),a}function kt(e,i,a,u,f){var y=-1,E=e.length;for(a||(a=Gg),f||(f=[]);++y<E;){var C=e[y];i>0&&a(C)?i>1?kt(C,i-1,a,u,f):vi(f,C):u||(f[f.length]=C)}return f}var wo=oh(),Lu=oh(!0);function Gr(e,i){return e&&wo(e,i,Bt)}function Eo(e,i){return e&&Lu(e,i,Bt)}function Xs(e,i){return gi(i,function(a){return ci(e[a])})}function zi(e,i){i=wi(i,e);for(var a=0,u=i.length;e!=null&&a<u;)e=e[Yr(i[a++])];return a&&a==u?e:r}function $u(e,i,a){var u=i(e);return Te(e)?u:vi(u,a(e))}function tr(e){return e==null?e===r?ze:Ve:Li&&Li in ut(e)?qg(e):e0(e)}function Do(e,i){return e>i}function ag(e,i){return e!=null&&nt.call(e,i)}function og(e,i){return e!=null&&i in ut(e)}function cg(e,i,a){return e>=Yt(i,a)&&e<qt(i,a)}function So(e,i,a){for(var u=a?so:Ts,f=e[0].length,y=e.length,E=y,C=H(y),U=1/0,J=[];E--;){var X=e[E];E&&i&&(X=yt(X,yr(i))),U=Yt(X.length,U),C[E]=!a&&(i||f>=120&&X.length>=120)?new Mi(E&&X):r}X=e[0];var Q=-1,oe=C[0];e:for(;++Q<f&&J.length<U;){var ve=X[Q],me=i?i(ve):ve;if(ve=a||ve!==0?ve:0,!(oe?Rn(oe,me):u(J,me,a))){for(E=y;--E;){var qe=C[E];if(!(qe?Rn(qe,me):u(e[E],me,a)))continue e}oe&&oe.push(me),J.push(ve)}}return J}function ug(e,i,a,u){return Gr(e,function(f,y,E){i(u,a(f),y,E)}),u}function qn(e,i,a){i=wi(i,e),e=Sh(e,i);var u=e==null?e:e[Yr(Pr(i))];return u==null?r:Ht(u,e,a)}function Mu(e){return xt(e)&&tr(e)==ue}function hg(e){return xt(e)&&tr(e)==De}function lg(e){return xt(e)&&tr(e)==O}function Hn(e,i,a,u,f){return e===i?!0:e==null||i==null||!xt(e)&&!xt(i)?e!==e&&i!==i:fg(e,i,a,u,Hn,f)}function fg(e,i,a,u,f,y){var E=Te(e),C=Te(i),U=E?ye:Jt(e),J=C?ye:Jt(i);U=U==ue?$e:U,J=J==ue?$e:J;var X=U==$e,Q=J==$e,oe=U==J;if(oe&&Di(e)){if(!Di(i))return!1;E=!0,X=!1}if(oe&&!X)return y||(y=new jr),E||wn(e)?yh(e,i,a,u,f,y):jg(e,i,U,a,u,f,y);if(!(a&$)){var ve=X&&nt.call(e,"__wrapped__"),me=Q&&nt.call(i,"__wrapped__");if(ve||me){var qe=ve?e.value():e,we=me?i.value():i;return y||(y=new jr),f(qe,we,a,u,y)}}return oe?(y||(y=new jr),zg(e,i,a,u,f,y)):!1}function dg(e){return xt(e)&&Jt(e)==Se}function Io(e,i,a,u){var f=a.length,y=f,E=!u;if(e==null)return!y;for(e=ut(e);f--;){var C=a[f];if(E&&C[2]?C[1]!==e[C[0]]:!(C[0]in e))return!1}for(;++f<y;){C=a[f];var U=C[0],J=e[U],X=C[1];if(E&&C[2]){if(J===r&&!(U in e))return!1}else{var Q=new jr;if(u)var oe=u(J,X,U,e,i,Q);if(!(oe===r?Hn(X,J,$|B,u,Q):oe))return!1}}return!0}function ju(e){if(!bt(e)||Yg(e))return!1;var i=ci(e)?dp:Ba;return i.test(Hi(e))}function pg(e){return xt(e)&&tr(e)==je}function gg(e){return xt(e)&&Jt(e)==Ie}function vg(e){return xt(e)&&pa(e.length)&&!!at[tr(e)]}function zu(e){return typeof e=="function"?e:e==null?dr:typeof e=="object"?Te(e)?Bu(e[0],e[1]):Hu(e):cl(e)}function xo(e){if(!Vn(e))return bp(e);var i=[];for(var a in ut(e))nt.call(e,a)&&a!="constructor"&&i.push(a);return i}function yg(e){if(!bt(e))return Qg(e);var i=Vn(e),a=[];for(var u in e)u=="constructor"&&(i||!nt.call(e,u))||a.push(u);return a}function Co(e,i){return e<i}function qu(e,i){var a=-1,u=lr(e)?H(e.length):[];return bi(e,function(f,y,E){u[++a]=i(f,y,E)}),u}function Hu(e){var i=Ho(e);return i.length==1&&i[0][2]?Eh(i[0][0],i[0][1]):function(a){return a===e||Io(a,e,i)}}function Bu(e,i){return Ko(e)&&wh(i)?Eh(Yr(e),i):function(a){var u=ec(a,e);return u===r&&u===i?tc(a,e):Hn(i,u,$|B)}}function Zs(e,i,a,u,f){e!==i&&wo(i,function(y,E){if(f||(f=new jr),bt(y))_g(e,i,E,a,Zs,u,f);else{var C=u?u(ko(e,E),y,E+"",e,i,f):r;C===r&&(C=y),bo(e,E,C)}},fr)}function _g(e,i,a,u,f,y,E){var C=ko(e,a),U=ko(i,a),J=E.get(U);if(J){bo(e,a,J);return}var X=y?y(C,U,a+"",e,i,E):r,Q=X===r;if(Q){var oe=Te(U),ve=!oe&&Di(U),me=!oe&&!ve&&wn(U);X=U,oe||ve||me?Te(C)?X=C:Ot(C)?X=hr(C):ve?(Q=!1,X=th(U,!0)):me?(Q=!1,X=rh(U,!0)):X=[]:Gn(U)||Bi(U)?(X=C,Bi(C)?X=Zh(C):(!bt(C)||ci(C))&&(X=mh(U))):Q=!1}Q&&(E.set(U,X),f(X,U,u,y,E),E.delete(U)),bo(e,a,X)}function Ku(e,i){var a=e.length;if(a)return i+=i<0?a:0,oi(i,a)?e[i]:r}function Vu(e,i,a){i.length?i=yt(i,function(y){return Te(y)?function(E){return zi(E,y.length===1?y[0]:y)}:y}):i=[dr];var u=-1;i=yt(i,yr(_e()));var f=qu(e,function(y,E,C){var U=yt(i,function(J){return J(y)});return{criteria:U,index:++u,value:y}});return Vd(f,function(y,E){return Ng(y,E,a)})}function bg(e,i){return ku(e,i,function(a,u){return tc(e,u)})}function ku(e,i,a){for(var u=-1,f=i.length,y={};++u<f;){var E=i[u],C=zi(e,E);a(C,E)&&Bn(y,wi(E,e),C)}return y}function mg(e){return function(i){return zi(i,e)}}function Ao(e,i,a,u){var f=u?Kd:hn,y=-1,E=i.length,C=e;for(e===i&&(i=hr(i)),a&&(C=yt(e,yr(a)));++y<E;)for(var U=0,J=i[y],X=a?a(J):J;(U=f(C,X,U,u))>-1;)C!==e&&Hs.call(C,U,1),Hs.call(e,U,1);return e}function Gu(e,i){for(var a=e?i.length:0,u=a-1;a--;){var f=i[a];if(a==u||f!==y){var y=f;oi(f)?Hs.call(e,f,1):To(e,f)}}return e}function Oo(e,i){return e+Vs(Cu()*(i-e+1))}function wg(e,i,a,u){for(var f=-1,y=qt(Ks((i-e)/(a||1)),0),E=H(y);y--;)E[u?y:++f]=e,e+=a;return E}function Po(e,i){var a="";if(!e||i<1||i>W)return a;do i%2&&(a+=e),i=Vs(i/2),i&&(e+=e);while(i);return a}function Ke(e,i){return Go(Dh(e,i,dr),e+"")}function Eg(e){return Pu(En(e))}function Dg(e,i){var a=En(e);return ca(a,ji(i,0,a.length))}function Bn(e,i,a,u){if(!bt(e))return e;i=wi(i,e);for(var f=-1,y=i.length,E=y-1,C=e;C!=null&&++f<y;){var U=Yr(i[f]),J=a;if(U==="__proto__"||U==="constructor"||U==="prototype")return e;if(f!=E){var X=C[U];J=u?u(X,U,C):r,J===r&&(J=bt(X)?X:oi(i[f+1])?[]:{})}jn(C,U,J),C=C[U]}return e}var Wu=ks?function(e,i){return ks.set(e,i),e}:dr,Sg=Bs?function(e,i){return Bs(e,"toString",{configurable:!0,enumerable:!1,value:ic(i),writable:!0})}:dr;function Ig(e){return ca(En(e))}function Or(e,i,a){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),a=a>f?f:a,a<0&&(a+=f),f=i>a?0:a-i>>>0,i>>>=0;for(var y=H(f);++u<f;)y[u]=e[u+i];return y}function xg(e,i){var a;return bi(e,function(u,f,y){return a=i(u,f,y),!a}),!!a}function Qs(e,i,a){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=ne){for(;u<f;){var y=u+f>>>1,E=e[y];E!==null&&!br(E)&&(a?E<=i:E<i)?u=y+1:f=y}return f}return No(e,i,dr,a)}function No(e,i,a,u){var f=0,y=e==null?0:e.length;if(y===0)return 0;i=a(i);for(var E=i!==i,C=i===null,U=br(i),J=i===r;f<y;){var X=Vs((f+y)/2),Q=a(e[X]),oe=Q!==r,ve=Q===null,me=Q===Q,qe=br(Q);if(E)var we=u||me;else J?we=me&&(u||oe):C?we=me&&oe&&(u||!ve):U?we=me&&oe&&!ve&&(u||!qe):ve||qe?we=!1:we=u?Q<=i:Q<i;we?f=X+1:y=X}return Yt(y,xe)}function Yu(e,i){for(var a=-1,u=e.length,f=0,y=[];++a<u;){var E=e[a],C=i?i(E):E;if(!a||!zr(C,U)){var U=C;y[f++]=E===0?0:E}}return y}function Ju(e){return typeof e=="number"?e:br(e)?Y:+e}function _r(e){if(typeof e=="string")return e;if(Te(e))return yt(e,_r)+"";if(br(e))return Au?Au.call(e):"";var i=e+"";return i=="0"&&1/e==-te?"-0":i}function mi(e,i,a){var u=-1,f=Ts,y=e.length,E=!0,C=[],U=C;if(a)E=!1,f=so;else if(y>=o){var J=i?null:$g(e);if(J)return Us(J);E=!1,f=Rn,U=new Mi}else U=i?[]:C;e:for(;++u<y;){var X=e[u],Q=i?i(X):X;if(X=a||X!==0?X:0,E&&Q===Q){for(var oe=U.length;oe--;)if(U[oe]===Q)continue e;i&&U.push(Q),C.push(X)}else f(U,Q,a)||(U!==C&&U.push(Q),C.push(X))}return C}function To(e,i){return i=wi(i,e),e=Sh(e,i),e==null||delete e[Yr(Pr(i))]}function Xu(e,i,a,u){return Bn(e,i,a(zi(e,i)),u)}function ea(e,i,a,u){for(var f=e.length,y=u?f:-1;(u?y--:++y<f)&&i(e[y],y,e););return a?Or(e,u?0:y,u?y+1:f):Or(e,u?y+1:0,u?f:y)}function Zu(e,i){var a=e;return a instanceof Ye&&(a=a.value()),ao(i,function(u,f){return f.func.apply(f.thisArg,vi([u],f.args))},a)}function Ro(e,i,a){var u=e.length;if(u<2)return u?mi(e[0]):[];for(var f=-1,y=H(u);++f<u;)for(var E=e[f],C=-1;++C<u;)C!=f&&(y[f]=zn(y[f]||E,e[C],i,a));return mi(kt(y,1),i,a)}function Qu(e,i,a){for(var u=-1,f=e.length,y=i.length,E={};++u<f;){var C=u<y?i[u]:r;a(E,e[u],C)}return E}function Uo(e){return Ot(e)?e:[]}function Fo(e){return typeof e=="function"?e:dr}function wi(e,i){return Te(e)?e:Ko(e,i)?[e]:Ah(it(e))}var Cg=Ke;function Ei(e,i,a){var u=e.length;return a=a===r?u:a,!i&&a>=u?e:Or(e,i,a)}var eh=pp||function(e){return Xe.clearTimeout(e)};function th(e,i){if(i)return e.slice();var a=e.length,u=Eu?Eu(a):new e.constructor(a);return e.copy(u),u}function Lo(e){var i=new e.constructor(e.byteLength);return new zs(i).set(new zs(e)),i}function Ag(e,i){var a=i?Lo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function Og(e){var i=new e.constructor(e.source,Dr.exec(e));return i.lastIndex=e.lastIndex,i}function Pg(e){return Mn?ut(Mn.call(e)):{}}function rh(e,i){var a=i?Lo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function ih(e,i){if(e!==i){var a=e!==r,u=e===null,f=e===e,y=br(e),E=i!==r,C=i===null,U=i===i,J=br(i);if(!C&&!J&&!y&&e>i||y&&E&&U&&!C&&!J||u&&E&&U||!a&&U||!f)return 1;if(!u&&!y&&!J&&e<i||J&&a&&f&&!u&&!y||C&&a&&f||!E&&f||!U)return-1}return 0}function Ng(e,i,a){for(var u=-1,f=e.criteria,y=i.criteria,E=f.length,C=a.length;++u<E;){var U=ih(f[u],y[u]);if(U){if(u>=C)return U;var J=a[u];return U*(J=="desc"?-1:1)}}return e.index-i.index}function nh(e,i,a,u){for(var f=-1,y=e.length,E=a.length,C=-1,U=i.length,J=qt(y-E,0),X=H(U+J),Q=!u;++C<U;)X[C]=i[C];for(;++f<E;)(Q||f<y)&&(X[a[f]]=e[f]);for(;J--;)X[C++]=e[f++];return X}function sh(e,i,a,u){for(var f=-1,y=e.length,E=-1,C=a.length,U=-1,J=i.length,X=qt(y-C,0),Q=H(X+J),oe=!u;++f<X;)Q[f]=e[f];for(var ve=f;++U<J;)Q[ve+U]=i[U];for(;++E<C;)(oe||f<y)&&(Q[ve+a[E]]=e[f++]);return Q}function hr(e,i){var a=-1,u=e.length;for(i||(i=H(u));++a<u;)i[a]=e[a];return i}function Wr(e,i,a,u){var f=!a;a||(a={});for(var y=-1,E=i.length;++y<E;){var C=i[y],U=u?u(a[C],e[C],C,a,e):r;U===r&&(U=e[C]),f?ni(a,C,U):jn(a,C,U)}return a}function Tg(e,i){return Wr(e,Bo(e),i)}function Rg(e,i){return Wr(e,_h(e),i)}function ta(e,i){return function(a,u){var f=Te(a)?Md:tg,y=i?i():{};return f(a,e,_e(u,2),y)}}function _n(e){return Ke(function(i,a){var u=-1,f=a.length,y=f>1?a[f-1]:r,E=f>2?a[2]:r;for(y=e.length>3&&typeof y=="function"?(f--,y):r,E&&rr(a[0],a[1],E)&&(y=f<3?r:y,f=1),i=ut(i);++u<f;){var C=a[u];C&&e(i,C,u,y)}return i})}function ah(e,i){return function(a,u){if(a==null)return a;if(!lr(a))return e(a,u);for(var f=a.length,y=i?f:-1,E=ut(a);(i?y--:++y<f)&&u(E[y],y,E)!==!1;);return a}}function oh(e){return function(i,a,u){for(var f=-1,y=ut(i),E=u(i),C=E.length;C--;){var U=E[e?C:++f];if(a(y[U],U,y)===!1)break}return i}}function Ug(e,i,a){var u=i&G,f=Kn(e);function y(){var E=this&&this!==Xe&&this instanceof y?f:e;return E.apply(u?a:this,arguments)}return y}function ch(e){return function(i){i=it(i);var a=ln(i)?Mr(i):r,u=a?a[0]:i.charAt(0),f=a?Ei(a,1).join(""):i.slice(1);return u[e]()+f}}function bn(e){return function(i){return ao(al(sl(i).replace(Nn,"")),e,"")}}function Kn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=yn(e.prototype),u=e.apply(a,i);return bt(u)?u:a}}function Fg(e,i,a){var u=Kn(e);function f(){for(var y=arguments.length,E=H(y),C=y,U=mn(f);C--;)E[C]=arguments[C];var J=y<3&&E[0]!==U&&E[y-1]!==U?[]:yi(E,U);if(y-=J.length,y<a)return dh(e,i,ra,f.placeholder,r,E,J,r,r,a-y);var X=this&&this!==Xe&&this instanceof f?u:e;return Ht(X,this,E)}return f}function uh(e){return function(i,a,u){var f=ut(i);if(!lr(i)){var y=_e(a,3);i=Bt(i),a=function(C){return y(f[C],C,f)}}var E=e(i,a,u);return E>-1?f[y?i[E]:E]:r}}function hh(e){return ai(function(i){var a=i.length,u=a,f=Cr.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new xr(v);if(f&&!E&&aa(y)=="wrapper")var E=new Cr([],!0)}for(u=E?u:a;++u<a;){y=i[u];var C=aa(y),U=C=="wrapper"?qo(y):r;U&&Vo(U[0])&&U[1]==(c|R|x|_)&&!U[4].length&&U[9]==1?E=E[aa(U[0])].apply(E,U[3]):E=y.length==1&&Vo(y)?E[C]():E.thru(y)}return function(){var J=arguments,X=J[0];if(E&&J.length==1&&Te(X))return E.plant(X).value();for(var Q=0,oe=a?i[Q].apply(this,J):X;++Q<a;)oe=i[Q].call(this,oe);return oe}})}function ra(e,i,a,u,f,y,E,C,U,J){var X=i&c,Q=i&G,oe=i&ie,ve=i&(R|D),me=i&K,qe=oe?r:Kn(e);function we(){for(var Ge=arguments.length,Ze=H(Ge),mr=Ge;mr--;)Ze[mr]=arguments[mr];if(ve)var ir=mn(we),wr=Gd(Ze,ir);if(u&&(Ze=nh(Ze,u,f,ve)),y&&(Ze=sh(Ze,y,E,ve)),Ge-=wr,ve&&Ge<J){var Pt=yi(Ze,ir);return dh(e,i,ra,we.placeholder,a,Ze,Pt,C,U,J-Ge)}var qr=Q?a:this,hi=oe?qr[e]:e;return Ge=Ze.length,C?Ze=t0(Ze,C):me&&Ge>1&&Ze.reverse(),X&&U<Ge&&(Ze.length=U),this&&this!==Xe&&this instanceof we&&(hi=qe||Kn(hi)),hi.apply(qr,Ze)}return we}function lh(e,i){return function(a,u){return ug(a,e,i(u),{})}}function ia(e,i){return function(a,u){var f;if(a===r&&u===r)return i;if(a!==r&&(f=a),u!==r){if(f===r)return u;typeof a=="string"||typeof u=="string"?(a=_r(a),u=_r(u)):(a=Ju(a),u=Ju(u)),f=e(a,u)}return f}}function $o(e){return ai(function(i){return i=yt(i,yr(_e())),Ke(function(a){var u=this;return e(i,function(f){return Ht(f,u,a)})})})}function na(e,i){i=i===r?" ":_r(i);var a=i.length;if(a<2)return a?Po(i,e):i;var u=Po(i,Ks(e/fn(i)));return ln(i)?Ei(Mr(u),0,e).join(""):u.slice(0,e)}function Lg(e,i,a,u){var f=i&G,y=Kn(e);function E(){for(var C=-1,U=arguments.length,J=-1,X=u.length,Q=H(X+U),oe=this&&this!==Xe&&this instanceof E?y:e;++J<X;)Q[J]=u[J];for(;U--;)Q[J++]=arguments[++C];return Ht(oe,f?a:this,Q)}return E}function fh(e){return function(i,a,u){return u&&typeof u!="number"&&rr(i,a,u)&&(a=u=r),i=ui(i),a===r?(a=i,i=0):a=ui(a),u=u===r?i<a?1:-1:ui(u),wg(i,a,u,e)}}function sa(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Nr(i),a=Nr(a)),e(i,a)}}function dh(e,i,a,u,f,y,E,C,U,J){var X=i&R,Q=X?E:r,oe=X?r:E,ve=X?y:r,me=X?r:y;i|=X?x:b,i&=~(X?b:x),i&A||(i&=~(G|ie));var qe=[e,i,f,ve,Q,me,oe,C,U,J],we=a.apply(r,qe);return Vo(e)&&Ih(we,qe),we.placeholder=u,xh(we,e,i)}function Mo(e){var i=zt[e];return function(a,u){if(a=Nr(a),u=u==null?0:Yt(Me(u),292),u&&xu(a)){var f=(it(a)+"e").split("e"),y=i(f[0]+"e"+(+f[1]+u));return f=(it(y)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(a)}}var $g=gn&&1/Us(new gn([,-0]))[1]==te?function(e){return new gn(e)}:ac;function ph(e){return function(i){var a=Jt(i);return a==Se?po(i):a==Ie?ep(i):kd(i,e(i))}}function si(e,i,a,u,f,y,E,C){var U=i&ie;if(!U&&typeof e!="function")throw new xr(v);var J=u?u.length:0;if(J||(i&=~(x|b),u=f=r),E=E===r?E:qt(Me(E),0),C=C===r?C:Me(C),J-=f?f.length:0,i&b){var X=u,Q=f;u=f=r}var oe=U?r:qo(e),ve=[e,i,a,u,f,X,Q,y,E,C];if(oe&&Zg(ve,oe),e=ve[0],i=ve[1],a=ve[2],u=ve[3],f=ve[4],C=ve[9]=ve[9]===r?U?0:e.length:qt(ve[9]-J,0),!C&&i&(R|D)&&(i&=~(R|D)),!i||i==G)var me=Ug(e,i,a);else i==R||i==D?me=Fg(e,i,C):(i==x||i==(G|x))&&!f.length?me=Lg(e,i,a,u):me=ra.apply(r,ve);var qe=oe?Wu:Ih;return xh(qe(me,ve),e,i)}function gh(e,i,a,u){return e===r||zr(e,pn[a])&&!nt.call(u,a)?i:e}function vh(e,i,a,u,f,y){return bt(e)&&bt(i)&&(y.set(i,e),Zs(e,i,r,vh,y),y.delete(i)),e}function Mg(e){return Gn(e)?r:e}function yh(e,i,a,u,f,y){var E=a&$,C=e.length,U=i.length;if(C!=U&&!(E&&U>C))return!1;var J=y.get(e),X=y.get(i);if(J&&X)return J==i&&X==e;var Q=-1,oe=!0,ve=a&B?new Mi:r;for(y.set(e,i),y.set(i,e);++Q<C;){var me=e[Q],qe=i[Q];if(u)var we=E?u(qe,me,Q,i,e,y):u(me,qe,Q,e,i,y);if(we!==r){if(we)continue;oe=!1;break}if(ve){if(!oo(i,function(Ge,Ze){if(!Rn(ve,Ze)&&(me===Ge||f(me,Ge,a,u,y)))return ve.push(Ze)})){oe=!1;break}}else if(!(me===qe||f(me,qe,a,u,y))){oe=!1;break}}return y.delete(e),y.delete(i),oe}function jg(e,i,a,u,f,y,E){switch(a){case Oe:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case De:return!(e.byteLength!=i.byteLength||!y(new zs(e),new zs(i)));case M:case O:case He:return zr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case je:case Re:return e==i+"";case Se:var C=po;case Ie:var U=u&$;if(C||(C=Us),e.size!=i.size&&!U)return!1;var J=E.get(e);if(J)return J==i;u|=B,E.set(e,i);var X=yh(C(e),C(i),u,f,y,E);return E.delete(e),X;case Ue:if(Mn)return Mn.call(e)==Mn.call(i)}return!1}function zg(e,i,a,u,f,y){var E=a&$,C=jo(e),U=C.length,J=jo(i),X=J.length;if(U!=X&&!E)return!1;for(var Q=U;Q--;){var oe=C[Q];if(!(E?oe in i:nt.call(i,oe)))return!1}var ve=y.get(e),me=y.get(i);if(ve&&me)return ve==i&&me==e;var qe=!0;y.set(e,i),y.set(i,e);for(var we=E;++Q<U;){oe=C[Q];var Ge=e[oe],Ze=i[oe];if(u)var mr=E?u(Ze,Ge,oe,i,e,y):u(Ge,Ze,oe,e,i,y);if(!(mr===r?Ge===Ze||f(Ge,Ze,a,u,y):mr)){qe=!1;break}we||(we=oe=="constructor")}if(qe&&!we){var ir=e.constructor,wr=i.constructor;ir!=wr&&"constructor"in e&&"constructor"in i&&!(typeof ir=="function"&&ir instanceof ir&&typeof wr=="function"&&wr instanceof wr)&&(qe=!1)}return y.delete(e),y.delete(i),qe}function ai(e){return Go(Dh(e,r,Th),e+"")}function jo(e){return $u(e,Bt,Bo)}function zo(e){return $u(e,fr,_h)}var qo=ks?function(e){return ks.get(e)}:ac;function aa(e){for(var i=e.name+"",a=vn[i],u=nt.call(vn,i)?a.length:0;u--;){var f=a[u],y=f.func;if(y==null||y==e)return f.name}return i}function mn(e){var i=nt.call(p,"placeholder")?p:e;return i.placeholder}function _e(){var e=p.iteratee||nc;return e=e===nc?zu:e,arguments.length?e(arguments[0],arguments[1]):e}function oa(e,i){var a=e.__data__;return Wg(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Ho(e){for(var i=Bt(e),a=i.length;a--;){var u=i[a],f=e[u];i[a]=[u,f,wh(f)]}return i}function qi(e,i){var a=Xd(e,i);return ju(a)?a:r}function qg(e){var i=nt.call(e,Li),a=e[Li];try{e[Li]=r;var u=!0}catch{}var f=Ms.call(e);return u&&(i?e[Li]=a:delete e[Li]),f}var Bo=vo?function(e){return e==null?[]:(e=ut(e),gi(vo(e),function(i){return Su.call(e,i)}))}:oc,_h=vo?function(e){for(var i=[];e;)vi(i,Bo(e)),e=qs(e);return i}:oc,Jt=tr;(yo&&Jt(new yo(new ArrayBuffer(1)))!=Oe||Fn&&Jt(new Fn)!=Se||_o&&Jt(_o.resolve())!=dt||gn&&Jt(new gn)!=Ie||Ln&&Jt(new Ln)!=Ae)&&(Jt=function(e){var i=tr(e),a=i==$e?e.constructor:r,u=a?Hi(a):"";if(u)switch(u){case Dp:return Oe;case Sp:return Se;case Ip:return dt;case xp:return Ie;case Cp:return Ae}return i});function Hg(e,i,a){for(var u=-1,f=a.length;++u<f;){var y=a[u],E=y.size;switch(y.type){case"drop":e+=E;break;case"dropRight":i-=E;break;case"take":i=Yt(i,e+E);break;case"takeRight":e=qt(e,i-E);break}}return{start:e,end:i}}function Bg(e){var i=e.match(ht);return i?i[1].split(Ft):[]}function bh(e,i,a){i=wi(i,e);for(var u=-1,f=i.length,y=!1;++u<f;){var E=Yr(i[u]);if(!(y=e!=null&&a(e,E)))break;e=e[E]}return y||++u!=f?y:(f=e==null?0:e.length,!!f&&pa(f)&&oi(E,f)&&(Te(e)||Bi(e)))}function Kg(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function mh(e){return typeof e.constructor=="function"&&!Vn(e)?yn(qs(e)):{}}function Vg(e,i,a){var u=e.constructor;switch(i){case De:return Lo(e);case M:case O:return new u(+e);case Oe:return Ag(e,a);case Be:case Ce:case ke:case We:case et:case tt:case Je:case Zt:case cr:return rh(e,a);case Se:return new u;case He:case Re:return new u(e);case je:return Og(e);case Ie:return new u;case Ue:return Pg(e)}}function kg(e,i){var a=i.length;if(!a)return e;var u=a-1;return i[u]=(a>1?"& ":"")+i[u],i=i.join(a>2?", ":" "),e.replace(It,`{
/* [wrapped with `+i+`] */
`)}function Gg(e){return Te(e)||Bi(e)||!!(Iu&&e&&e[Iu])}function oi(e,i){var a=typeof e;return i=i??W,!!i&&(a=="number"||a!="symbol"&&Va.test(e))&&e>-1&&e%1==0&&e<i}function rr(e,i,a){if(!bt(a))return!1;var u=typeof i;return(u=="number"?lr(a)&&oi(i,a.length):u=="string"&&i in a)?zr(a[i],e):!1}function Ko(e,i){if(Te(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||br(e)?!0:Tt.test(e)||!vt.test(e)||i!=null&&e in ut(i)}function Wg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Vo(e){var i=aa(e),a=p[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(e===a)return!0;var u=qo(a);return!!u&&e===u[0]}function Yg(e){return!!wu&&wu in e}var Jg=Ls?ci:cc;function Vn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||pn;return e===a}function wh(e){return e===e&&!bt(e)}function Eh(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in ut(a))}}function Xg(e){var i=fa(e,function(u){return a.size===w&&a.clear(),u}),a=i.cache;return i}function Zg(e,i){var a=e[1],u=i[1],f=a|u,y=f<(G|ie|c),E=u==c&&a==R||u==c&&a==_&&e[7].length<=i[8]||u==(c|_)&&i[7].length<=i[8]&&a==R;if(!(y||E))return e;u&G&&(e[2]=i[2],f|=a&G?0:A);var C=i[3];if(C){var U=e[3];e[3]=U?nh(U,C,i[4]):C,e[4]=U?yi(e[3],S):i[4]}return C=i[5],C&&(U=e[5],e[5]=U?sh(U,C,i[6]):C,e[6]=U?yi(e[5],S):i[6]),C=i[7],C&&(e[7]=C),u&c&&(e[8]=e[8]==null?i[8]:Yt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function Qg(e){var i=[];if(e!=null)for(var a in ut(e))i.push(a);return i}function e0(e){return Ms.call(e)}function Dh(e,i,a){return i=qt(i===r?e.length-1:i,0),function(){for(var u=arguments,f=-1,y=qt(u.length-i,0),E=H(y);++f<y;)E[f]=u[i+f];f=-1;for(var C=H(i+1);++f<i;)C[f]=u[f];return C[i]=a(E),Ht(e,this,C)}}function Sh(e,i){return i.length<2?e:zi(e,Or(i,0,-1))}function t0(e,i){for(var a=e.length,u=Yt(i.length,a),f=hr(e);u--;){var y=i[u];e[u]=oi(y,a)?f[y]:r}return e}function ko(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Ih=Ch(Wu),kn=vp||function(e,i){return Xe.setTimeout(e,i)},Go=Ch(Sg);function xh(e,i,a){var u=i+"";return Go(e,kg(u,r0(Bg(u),a)))}function Ch(e){var i=0,a=0;return function(){var u=mp(),f=ge-(u-a);if(a=u,f>0){if(++i>=ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function ca(e,i){var a=-1,u=e.length,f=u-1;for(i=i===r?u:i;++a<i;){var y=Oo(a,f),E=e[y];e[y]=e[a],e[a]=E}return e.length=i,e}var Ah=Xg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Rt,function(a,u,f,y){i.push(f?y.replace(ja,"$1"):u||a)}),i});function Yr(e){if(typeof e=="string"||br(e))return e;var i=e+"";return i=="0"&&1/e==-te?"-0":i}function Hi(e){if(e!=null){try{return $s.call(e)}catch{}try{return e+""}catch{}}return""}function r0(e,i){return Ir(be,function(a){var u="_."+a[0];i&a[1]&&!Ts(e,u)&&e.push(u)}),e.sort()}function Oh(e){if(e instanceof Ye)return e.clone();var i=new Cr(e.__wrapped__,e.__chain__);return i.__actions__=hr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function i0(e,i,a){(a?rr(e,i,a):i===r)?i=1:i=qt(Me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,y=0,E=H(Ks(u/i));f<u;)E[y++]=Or(e,f,f+=i);return E}function n0(e){for(var i=-1,a=e==null?0:e.length,u=0,f=[];++i<a;){var y=e[i];y&&(f[u++]=y)}return f}function s0(){var e=arguments.length;if(!e)return[];for(var i=H(e-1),a=arguments[0],u=e;u--;)i[u-1]=arguments[u];return vi(Te(a)?hr(a):[a],kt(i,1))}var a0=Ke(function(e,i){return Ot(e)?zn(e,kt(i,1,Ot,!0)):[]}),o0=Ke(function(e,i){var a=Pr(i);return Ot(a)&&(a=r),Ot(e)?zn(e,kt(i,1,Ot,!0),_e(a,2)):[]}),c0=Ke(function(e,i){var a=Pr(i);return Ot(a)&&(a=r),Ot(e)?zn(e,kt(i,1,Ot,!0),r,a):[]});function u0(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),Or(e,i<0?0:i,u)):[]}function h0(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),i=u-i,Or(e,0,i<0?0:i)):[]}function l0(e,i){return e&&e.length?ea(e,_e(i,3),!0,!0):[]}function f0(e,i){return e&&e.length?ea(e,_e(i,3),!0):[]}function d0(e,i,a,u){var f=e==null?0:e.length;return f?(a&&typeof a!="number"&&rr(e,i,a)&&(a=0,u=f),sg(e,i,a,u)):[]}function Ph(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=a==null?0:Me(a);return f<0&&(f=qt(u+f,0)),Rs(e,_e(i,3),f)}function Nh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return a!==r&&(f=Me(a),f=a<0?qt(u+f,0):Yt(f,u-1)),Rs(e,_e(i,3),f,!0)}function Th(e){var i=e==null?0:e.length;return i?kt(e,1):[]}function p0(e){var i=e==null?0:e.length;return i?kt(e,te):[]}function g0(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:Me(i),kt(e,i)):[]}function v0(e){for(var i=-1,a=e==null?0:e.length,u={};++i<a;){var f=e[i];u[f[0]]=f[1]}return u}function Rh(e){return e&&e.length?e[0]:r}function y0(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=a==null?0:Me(a);return f<0&&(f=qt(u+f,0)),hn(e,i,f)}function _0(e){var i=e==null?0:e.length;return i?Or(e,0,-1):[]}var b0=Ke(function(e){var i=yt(e,Uo);return i.length&&i[0]===e[0]?So(i):[]}),m0=Ke(function(e){var i=Pr(e),a=yt(e,Uo);return i===Pr(a)?i=r:a.pop(),a.length&&a[0]===e[0]?So(a,_e(i,2)):[]}),w0=Ke(function(e){var i=Pr(e),a=yt(e,Uo);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?So(a,r,i):[]});function E0(e,i){return e==null?"":_p.call(e,i)}function Pr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function D0(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var f=u;return a!==r&&(f=Me(a),f=f<0?qt(u+f,0):Yt(f,u-1)),i===i?rp(e,i,f):Rs(e,du,f,!0)}function S0(e,i){return e&&e.length?Ku(e,Me(i)):r}var I0=Ke(Uh);function Uh(e,i){return e&&e.length&&i&&i.length?Ao(e,i):e}function x0(e,i,a){return e&&e.length&&i&&i.length?Ao(e,i,_e(a,2)):e}function C0(e,i,a){return e&&e.length&&i&&i.length?Ao(e,i,r,a):e}var A0=ai(function(e,i){var a=e==null?0:e.length,u=mo(e,i);return Gu(e,yt(i,function(f){return oi(f,a)?+f:f}).sort(ih)),u});function O0(e,i){var a=[];if(!(e&&e.length))return a;var u=-1,f=[],y=e.length;for(i=_e(i,3);++u<y;){var E=e[u];i(E,u,e)&&(a.push(E),f.push(u))}return Gu(e,f),a}function Wo(e){return e==null?e:Ep.call(e)}function P0(e,i,a){var u=e==null?0:e.length;return u?(a&&typeof a!="number"&&rr(e,i,a)?(i=0,a=u):(i=i==null?0:Me(i),a=a===r?u:Me(a)),Or(e,i,a)):[]}function N0(e,i){return Qs(e,i)}function T0(e,i,a){return No(e,i,_e(a,2))}function R0(e,i){var a=e==null?0:e.length;if(a){var u=Qs(e,i);if(u<a&&zr(e[u],i))return u}return-1}function U0(e,i){return Qs(e,i,!0)}function F0(e,i,a){return No(e,i,_e(a,2),!0)}function L0(e,i){var a=e==null?0:e.length;if(a){var u=Qs(e,i,!0)-1;if(zr(e[u],i))return u}return-1}function $0(e){return e&&e.length?Yu(e):[]}function M0(e,i){return e&&e.length?Yu(e,_e(i,2)):[]}function j0(e){var i=e==null?0:e.length;return i?Or(e,1,i):[]}function z0(e,i,a){return e&&e.length?(i=a||i===r?1:Me(i),Or(e,0,i<0?0:i)):[]}function q0(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),i=u-i,Or(e,i<0?0:i,u)):[]}function H0(e,i){return e&&e.length?ea(e,_e(i,3),!1,!0):[]}function B0(e,i){return e&&e.length?ea(e,_e(i,3)):[]}var K0=Ke(function(e){return mi(kt(e,1,Ot,!0))}),V0=Ke(function(e){var i=Pr(e);return Ot(i)&&(i=r),mi(kt(e,1,Ot,!0),_e(i,2))}),k0=Ke(function(e){var i=Pr(e);return i=typeof i=="function"?i:r,mi(kt(e,1,Ot,!0),r,i)});function G0(e){return e&&e.length?mi(e):[]}function W0(e,i){return e&&e.length?mi(e,_e(i,2)):[]}function Y0(e,i){return i=typeof i=="function"?i:r,e&&e.length?mi(e,r,i):[]}function Yo(e){if(!(e&&e.length))return[];var i=0;return e=gi(e,function(a){if(Ot(a))return i=qt(a.length,i),!0}),lo(i,function(a){return yt(e,co(a))})}function Fh(e,i){if(!(e&&e.length))return[];var a=Yo(e);return i==null?a:yt(a,function(u){return Ht(i,r,u)})}var J0=Ke(function(e,i){return Ot(e)?zn(e,i):[]}),X0=Ke(function(e){return Ro(gi(e,Ot))}),Z0=Ke(function(e){var i=Pr(e);return Ot(i)&&(i=r),Ro(gi(e,Ot),_e(i,2))}),Q0=Ke(function(e){var i=Pr(e);return i=typeof i=="function"?i:r,Ro(gi(e,Ot),r,i)}),e1=Ke(Yo);function t1(e,i){return Qu(e||[],i||[],jn)}function r1(e,i){return Qu(e||[],i||[],Bn)}var i1=Ke(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,Fh(e,a)});function Lh(e){var i=p(e);return i.__chain__=!0,i}function n1(e,i){return i(e),e}function ua(e,i){return i(e)}var s1=ai(function(e){var i=e.length,a=i?e[0]:0,u=this.__wrapped__,f=function(y){return mo(y,e)};return i>1||this.__actions__.length||!(u instanceof Ye)||!oi(a)?this.thru(f):(u=u.slice(a,+a+(i?1:0)),u.__actions__.push({func:ua,args:[f],thisArg:r}),new Cr(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function a1(){return Lh(this)}function o1(){return new Cr(this.value(),this.__chain__)}function c1(){this.__values__===r&&(this.__values__=Jh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function u1(){return this}function h1(e){for(var i,a=this;a instanceof Ws;){var u=Oh(a);u.__index__=0,u.__values__=r,i?f.__wrapped__=u:i=u;var f=u;a=a.__wrapped__}return f.__wrapped__=e,i}function l1(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:ua,args:[Wo],thisArg:r}),new Cr(i,this.__chain__)}return this.thru(Wo)}function f1(){return Zu(this.__wrapped__,this.__actions__)}var d1=ta(function(e,i,a){nt.call(e,a)?++e[a]:ni(e,a,1)});function p1(e,i,a){var u=Te(e)?lu:ng;return a&&rr(e,i,a)&&(i=r),u(e,_e(i,3))}function g1(e,i){var a=Te(e)?gi:Fu;return a(e,_e(i,3))}var v1=uh(Ph),y1=uh(Nh);function _1(e,i){return kt(ha(e,i),1)}function b1(e,i){return kt(ha(e,i),te)}function m1(e,i,a){return a=a===r?1:Me(a),kt(ha(e,i),a)}function $h(e,i){var a=Te(e)?Ir:bi;return a(e,_e(i,3))}function Mh(e,i){var a=Te(e)?jd:Uu;return a(e,_e(i,3))}var w1=ta(function(e,i,a){nt.call(e,a)?e[a].push(i):ni(e,a,[i])});function E1(e,i,a,u){e=lr(e)?e:En(e),a=a&&!u?Me(a):0;var f=e.length;return a<0&&(a=qt(f+a,0)),ga(e)?a<=f&&e.indexOf(i,a)>-1:!!f&&hn(e,i,a)>-1}var D1=Ke(function(e,i,a){var u=-1,f=typeof i=="function",y=lr(e)?H(e.length):[];return bi(e,function(E){y[++u]=f?Ht(i,E,a):qn(E,i,a)}),y}),S1=ta(function(e,i,a){ni(e,a,i)});function ha(e,i){var a=Te(e)?yt:qu;return a(e,_e(i,3))}function I1(e,i,a,u){return e==null?[]:(Te(i)||(i=i==null?[]:[i]),a=u?r:a,Te(a)||(a=a==null?[]:[a]),Vu(e,i,a))}var x1=ta(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function C1(e,i,a){var u=Te(e)?ao:gu,f=arguments.length<3;return u(e,_e(i,4),a,f,bi)}function A1(e,i,a){var u=Te(e)?zd:gu,f=arguments.length<3;return u(e,_e(i,4),a,f,Uu)}function O1(e,i){var a=Te(e)?gi:Fu;return a(e,da(_e(i,3)))}function P1(e){var i=Te(e)?Pu:Eg;return i(e)}function N1(e,i,a){(a?rr(e,i,a):i===r)?i=1:i=Me(i);var u=Te(e)?Qp:Dg;return u(e,i)}function T1(e){var i=Te(e)?eg:Ig;return i(e)}function R1(e){if(e==null)return 0;if(lr(e))return ga(e)?fn(e):e.length;var i=Jt(e);return i==Se||i==Ie?e.size:xo(e).length}function U1(e,i,a){var u=Te(e)?oo:xg;return a&&rr(e,i,a)&&(i=r),u(e,_e(i,3))}var F1=Ke(function(e,i){if(e==null)return[];var a=i.length;return a>1&&rr(e,i[0],i[1])?i=[]:a>2&&rr(i[0],i[1],i[2])&&(i=[i[0]]),Vu(e,kt(i,1),[])}),la=gp||function(){return Xe.Date.now()};function L1(e,i){if(typeof i!="function")throw new xr(v);return e=Me(e),function(){if(--e<1)return i.apply(this,arguments)}}function jh(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,si(e,c,r,r,r,r,i)}function zh(e,i){var a;if(typeof i!="function")throw new xr(v);return e=Me(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var Jo=Ke(function(e,i,a){var u=G;if(a.length){var f=yi(a,mn(Jo));u|=x}return si(e,u,i,a,f)}),qh=Ke(function(e,i,a){var u=G|ie;if(a.length){var f=yi(a,mn(qh));u|=x}return si(i,u,e,a,f)});function Hh(e,i,a){i=a?r:i;var u=si(e,R,r,r,r,r,r,i);return u.placeholder=Hh.placeholder,u}function Bh(e,i,a){i=a?r:i;var u=si(e,D,r,r,r,r,r,i);return u.placeholder=Bh.placeholder,u}function Kh(e,i,a){var u,f,y,E,C,U,J=0,X=!1,Q=!1,oe=!0;if(typeof e!="function")throw new xr(v);i=Nr(i)||0,bt(a)&&(X=!!a.leading,Q="maxWait"in a,y=Q?qt(Nr(a.maxWait)||0,i):y,oe="trailing"in a?!!a.trailing:oe);function ve(Pt){var qr=u,hi=f;return u=f=r,J=Pt,E=e.apply(hi,qr),E}function me(Pt){return J=Pt,C=kn(Ge,i),X?ve(Pt):E}function qe(Pt){var qr=Pt-U,hi=Pt-J,ul=i-qr;return Q?Yt(ul,y-hi):ul}function we(Pt){var qr=Pt-U,hi=Pt-J;return U===r||qr>=i||qr<0||Q&&hi>=y}function Ge(){var Pt=la();if(we(Pt))return Ze(Pt);C=kn(Ge,qe(Pt))}function Ze(Pt){return C=r,oe&&u?ve(Pt):(u=f=r,E)}function mr(){C!==r&&eh(C),J=0,u=U=f=C=r}function ir(){return C===r?E:Ze(la())}function wr(){var Pt=la(),qr=we(Pt);if(u=arguments,f=this,U=Pt,qr){if(C===r)return me(U);if(Q)return eh(C),C=kn(Ge,i),ve(U)}return C===r&&(C=kn(Ge,i)),E}return wr.cancel=mr,wr.flush=ir,wr}var $1=Ke(function(e,i){return Ru(e,1,i)}),M1=Ke(function(e,i,a){return Ru(e,Nr(i)||0,a)});function j1(e){return si(e,K)}function fa(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new xr(v);var a=function(){var u=arguments,f=i?i.apply(this,u):u[0],y=a.cache;if(y.has(f))return y.get(f);var E=e.apply(this,u);return a.cache=y.set(f,E)||y,E};return a.cache=new(fa.Cache||ii),a}fa.Cache=ii;function da(e){if(typeof e!="function")throw new xr(v);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function z1(e){return zh(2,e)}var q1=Cg(function(e,i){i=i.length==1&&Te(i[0])?yt(i[0],yr(_e())):yt(kt(i,1),yr(_e()));var a=i.length;return Ke(function(u){for(var f=-1,y=Yt(u.length,a);++f<y;)u[f]=i[f].call(this,u[f]);return Ht(e,this,u)})}),Xo=Ke(function(e,i){var a=yi(i,mn(Xo));return si(e,x,r,i,a)}),Vh=Ke(function(e,i){var a=yi(i,mn(Vh));return si(e,b,r,i,a)}),H1=ai(function(e,i){return si(e,_,r,r,r,i)});function B1(e,i){if(typeof e!="function")throw new xr(v);return i=i===r?i:Me(i),Ke(e,i)}function K1(e,i){if(typeof e!="function")throw new xr(v);return i=i==null?0:qt(Me(i),0),Ke(function(a){var u=a[i],f=Ei(a,0,i);return u&&vi(f,u),Ht(e,this,f)})}function V1(e,i,a){var u=!0,f=!0;if(typeof e!="function")throw new xr(v);return bt(a)&&(u="leading"in a?!!a.leading:u,f="trailing"in a?!!a.trailing:f),Kh(e,i,{leading:u,maxWait:i,trailing:f})}function k1(e){return jh(e,1)}function G1(e,i){return Xo(Fo(i),e)}function W1(){if(!arguments.length)return[];var e=arguments[0];return Te(e)?e:[e]}function Y1(e){return Ar(e,L)}function J1(e,i){return i=typeof i=="function"?i:r,Ar(e,L,i)}function X1(e){return Ar(e,F|L)}function Z1(e,i){return i=typeof i=="function"?i:r,Ar(e,F|L,i)}function Q1(e,i){return i==null||Tu(e,i,Bt(i))}function zr(e,i){return e===i||e!==e&&i!==i}var ev=sa(Do),tv=sa(function(e,i){return e>=i}),Bi=Mu(function(){return arguments}())?Mu:function(e){return xt(e)&&nt.call(e,"callee")&&!Su.call(e,"callee")},Te=H.isArray,rv=er?yr(er):hg;function lr(e){return e!=null&&pa(e.length)&&!ci(e)}function Ot(e){return xt(e)&&lr(e)}function iv(e){return e===!0||e===!1||xt(e)&&tr(e)==M}var Di=yp||cc,nv=$r?yr($r):lg;function sv(e){return xt(e)&&e.nodeType===1&&!Gn(e)}function av(e){if(e==null)return!0;if(lr(e)&&(Te(e)||typeof e=="string"||typeof e.splice=="function"||Di(e)||wn(e)||Bi(e)))return!e.length;var i=Jt(e);if(i==Se||i==Ie)return!e.size;if(Vn(e))return!xo(e).length;for(var a in e)if(nt.call(e,a))return!1;return!0}function ov(e,i){return Hn(e,i)}function cv(e,i,a){a=typeof a=="function"?a:r;var u=a?a(e,i):r;return u===r?Hn(e,i,r,a):!!u}function Zo(e){if(!xt(e))return!1;var i=tr(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Gn(e)}function uv(e){return typeof e=="number"&&xu(e)}function ci(e){if(!bt(e))return!1;var i=tr(e);return i==se||i==fe||i==j||i==pt}function kh(e){return typeof e=="number"&&e==Me(e)}function pa(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=W}function bt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function xt(e){return e!=null&&typeof e=="object"}var Gh=Sr?yr(Sr):dg;function hv(e,i){return e===i||Io(e,i,Ho(i))}function lv(e,i,a){return a=typeof a=="function"?a:r,Io(e,i,Ho(i),a)}function fv(e){return Wh(e)&&e!=+e}function dv(e){if(Jg(e))throw new Pe(l);return ju(e)}function pv(e){return e===null}function gv(e){return e==null}function Wh(e){return typeof e=="number"||xt(e)&&tr(e)==He}function Gn(e){if(!xt(e)||tr(e)!=$e)return!1;var i=qs(e);if(i===null)return!0;var a=nt.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&$s.call(a)==lp}var Qo=kr?yr(kr):pg;function vv(e){return kh(e)&&e>=-W&&e<=W}var Yh=Tn?yr(Tn):gg;function ga(e){return typeof e=="string"||!Te(e)&&xt(e)&&tr(e)==Re}function br(e){return typeof e=="symbol"||xt(e)&&tr(e)==Ue}var wn=Fi?yr(Fi):vg;function yv(e){return e===r}function _v(e){return xt(e)&&Jt(e)==Ae}function bv(e){return xt(e)&&tr(e)==Fe}var mv=sa(Co),wv=sa(function(e,i){return e<=i});function Jh(e){if(!e)return[];if(lr(e))return ga(e)?Mr(e):hr(e);if(Un&&e[Un])return Qd(e[Un]());var i=Jt(e),a=i==Se?po:i==Ie?Us:En;return a(e)}function ui(e){if(!e)return e===0?e:0;if(e=Nr(e),e===te||e===-te){var i=e<0?-1:1;return i*ee}return e===e?e:0}function Me(e){var i=ui(e),a=i%1;return i===i?a?i-a:i:0}function Xh(e){return e?ji(Me(e),0,re):0}function Nr(e){if(typeof e=="number")return e;if(br(e))return Y;if(bt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=bt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=vu(e);var a=Ha.test(e);return a||Ka.test(e)?Ne(e.slice(2),a?2:8):qa.test(e)?Y:+e}function Zh(e){return Wr(e,fr(e))}function Ev(e){return e?ji(Me(e),-W,W):e===0?e:0}function it(e){return e==null?"":_r(e)}var Dv=_n(function(e,i){if(Vn(i)||lr(i)){Wr(i,Bt(i),e);return}for(var a in i)nt.call(i,a)&&jn(e,a,i[a])}),Qh=_n(function(e,i){Wr(i,fr(i),e)}),va=_n(function(e,i,a,u){Wr(i,fr(i),e,u)}),Sv=_n(function(e,i,a,u){Wr(i,Bt(i),e,u)}),Iv=ai(mo);function xv(e,i){var a=yn(e);return i==null?a:Nu(a,i)}var Cv=Ke(function(e,i){e=ut(e);var a=-1,u=i.length,f=u>2?i[2]:r;for(f&&rr(i[0],i[1],f)&&(u=1);++a<u;)for(var y=i[a],E=fr(y),C=-1,U=E.length;++C<U;){var J=E[C],X=e[J];(X===r||zr(X,pn[J])&&!nt.call(e,J))&&(e[J]=y[J])}return e}),Av=Ke(function(e){return e.push(r,vh),Ht(el,r,e)});function Ov(e,i){return fu(e,_e(i,3),Gr)}function Pv(e,i){return fu(e,_e(i,3),Eo)}function Nv(e,i){return e==null?e:wo(e,_e(i,3),fr)}function Tv(e,i){return e==null?e:Lu(e,_e(i,3),fr)}function Rv(e,i){return e&&Gr(e,_e(i,3))}function Uv(e,i){return e&&Eo(e,_e(i,3))}function Fv(e){return e==null?[]:Xs(e,Bt(e))}function Lv(e){return e==null?[]:Xs(e,fr(e))}function ec(e,i,a){var u=e==null?r:zi(e,i);return u===r?a:u}function $v(e,i){return e!=null&&bh(e,i,ag)}function tc(e,i){return e!=null&&bh(e,i,og)}var Mv=lh(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Ms.call(i)),e[i]=a},ic(dr)),jv=lh(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Ms.call(i)),nt.call(e,i)?e[i].push(a):e[i]=[a]},_e),zv=Ke(qn);function Bt(e){return lr(e)?Ou(e):xo(e)}function fr(e){return lr(e)?Ou(e,!0):yg(e)}function qv(e,i){var a={};return i=_e(i,3),Gr(e,function(u,f,y){ni(a,i(u,f,y),u)}),a}function Hv(e,i){var a={};return i=_e(i,3),Gr(e,function(u,f,y){ni(a,f,i(u,f,y))}),a}var Bv=_n(function(e,i,a){Zs(e,i,a)}),el=_n(function(e,i,a,u){Zs(e,i,a,u)}),Kv=ai(function(e,i){var a={};if(e==null)return a;var u=!1;i=yt(i,function(y){return y=wi(y,e),u||(u=y.length>1),y}),Wr(e,zo(e),a),u&&(a=Ar(a,F|q|L,Mg));for(var f=i.length;f--;)To(a,i[f]);return a});function Vv(e,i){return tl(e,da(_e(i)))}var kv=ai(function(e,i){return e==null?{}:bg(e,i)});function tl(e,i){if(e==null)return{};var a=yt(zo(e),function(u){return[u]});return i=_e(i),ku(e,a,function(u,f){return i(u,f[0])})}function Gv(e,i,a){i=wi(i,e);var u=-1,f=i.length;for(f||(f=1,e=r);++u<f;){var y=e==null?r:e[Yr(i[u])];y===r&&(u=f,y=a),e=ci(y)?y.call(e):y}return e}function Wv(e,i,a){return e==null?e:Bn(e,i,a)}function Yv(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:Bn(e,i,a,u)}var rl=ph(Bt),il=ph(fr);function Jv(e,i,a){var u=Te(e),f=u||Di(e)||wn(e);if(i=_e(i,4),a==null){var y=e&&e.constructor;f?a=u?new y:[]:bt(e)?a=ci(y)?yn(qs(e)):{}:a={}}return(f?Ir:Gr)(e,function(E,C,U){return i(a,E,C,U)}),a}function Xv(e,i){return e==null?!0:To(e,i)}function Zv(e,i,a){return e==null?e:Xu(e,i,Fo(a))}function Qv(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:Xu(e,i,Fo(a),u)}function En(e){return e==null?[]:fo(e,Bt(e))}function ey(e){return e==null?[]:fo(e,fr(e))}function ty(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Nr(a),a=a===a?a:0),i!==r&&(i=Nr(i),i=i===i?i:0),ji(Nr(e),i,a)}function ry(e,i,a){return i=ui(i),a===r?(a=i,i=0):a=ui(a),e=Nr(e),cg(e,i,a)}function iy(e,i,a){if(a&&typeof a!="boolean"&&rr(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ui(e),i===r?(i=e,e=0):i=ui(i)),e>i){var u=e;e=i,i=u}if(a||e%1||i%1){var f=Cu();return Yt(e+f*(i-e+ot("1e-"+((f+"").length-1))),i)}return Oo(e,i)}var ny=bn(function(e,i,a){return i=i.toLowerCase(),e+(a?nl(i):i)});function nl(e){return rc(it(e).toLowerCase())}function sl(e){return e=it(e),e&&e.replace(ei,Wd).replace(io,"")}function sy(e,i,a){e=it(e),i=_r(i);var u=e.length;a=a===r?u:ji(Me(a),0,u);var f=a;return a-=i.length,a>=0&&e.slice(a,f)==i}function ay(e){return e=it(e),e&&gt.test(e)?e.replace(Pi,Yd):e}function oy(e){return e=it(e),e&&Ut.test(e)?e.replace(Dt,"\\$&"):e}var cy=bn(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),uy=bn(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),hy=ch("toLowerCase");function ly(e,i,a){e=it(e),i=Me(i);var u=i?fn(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return na(Vs(f),a)+e+na(Ks(f),a)}function fy(e,i,a){e=it(e),i=Me(i);var u=i?fn(e):0;return i&&u<i?e+na(i-u,a):e}function dy(e,i,a){e=it(e),i=Me(i);var u=i?fn(e):0;return i&&u<i?na(i-u,a)+e:e}function py(e,i,a){return a||i==null?i=0:i&&(i=+i),wp(it(e).replace(St,""),i||0)}function gy(e,i,a){return(a?rr(e,i,a):i===r)?i=1:i=Me(i),Po(it(e),i)}function vy(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var yy=bn(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function _y(e,i,a){return a&&typeof a!="number"&&rr(e,i,a)&&(i=a=r),a=a===r?re:a>>>0,a?(e=it(e),e&&(typeof i=="string"||i!=null&&!Qo(i))&&(i=_r(i),!i&&ln(e))?Ei(Mr(e),0,a):e.split(i,a)):[]}var by=bn(function(e,i,a){return e+(a?" ":"")+rc(i)});function my(e,i,a){return e=it(e),a=a==null?0:ji(Me(a),0,e.length),i=_r(i),e.slice(a,a+i.length)==i}function wy(e,i,a){var u=p.templateSettings;a&&rr(e,i,a)&&(i=r),e=it(e),i=va({},i,u,gh);var f=va({},i.imports,u.imports,gh),y=Bt(f),E=fo(f,y),C,U,J=0,X=i.interpolate||rn,Q="__p += '",oe=go((i.escape||rn).source+"|"+X.source+"|"+(X===_t?za:rn).source+"|"+(i.evaluate||rn).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++no+"]")+`
`;e.replace(oe,function(we,Ge,Ze,mr,ir,wr){return Ze||(Ze=mr),Q+=e.slice(J,wr).replace(ka,Jd),Ge&&(C=!0,Q+=`' +
__e(`+Ge+`) +
'`),ir&&(U=!0,Q+=`';
`+ir+`;
__p += '`),Ze&&(Q+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),J=wr+we.length,we}),Q+=`';
`;var me=nt.call(i,"variable")&&i.variable;if(!me)Q=`with (obj) {
`+Q+`
}
`;else if(Ma.test(me))throw new Pe(d);Q=(U?Q.replace(Kr,""):Q).replace(Qt,"$1").replace(Qr,"$1;"),Q="function("+(me||"obj")+`) {
`+(me?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(C?", __e = _.escape":"")+(U?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var qe=ol(function(){return rt(y,ve+"return "+Q).apply(r,E)});if(qe.source=Q,Zo(qe))throw qe;return qe}function Ey(e){return it(e).toLowerCase()}function Dy(e){return it(e).toUpperCase()}function Sy(e,i,a){if(e=it(e),e&&(a||i===r))return vu(e);if(!e||!(i=_r(i)))return e;var u=Mr(e),f=Mr(i),y=yu(u,f),E=_u(u,f)+1;return Ei(u,y,E).join("")}function Iy(e,i,a){if(e=it(e),e&&(a||i===r))return e.slice(0,mu(e)+1);if(!e||!(i=_r(i)))return e;var u=Mr(e),f=_u(u,Mr(i))+1;return Ei(u,0,f).join("")}function xy(e,i,a){if(e=it(e),e&&(a||i===r))return e.replace(St,"");if(!e||!(i=_r(i)))return e;var u=Mr(e),f=yu(u,Mr(i));return Ei(u,f).join("")}function Cy(e,i){var a=k,u=ae;if(bt(i)){var f="separator"in i?i.separator:f;a="length"in i?Me(i.length):a,u="omission"in i?_r(i.omission):u}e=it(e);var y=e.length;if(ln(e)){var E=Mr(e);y=E.length}if(a>=y)return e;var C=a-fn(u);if(C<1)return u;var U=E?Ei(E,0,C).join(""):e.slice(0,C);if(f===r)return U+u;if(E&&(C+=U.length-C),Qo(f)){if(e.slice(C).search(f)){var J,X=U;for(f.global||(f=go(f.source,it(Dr.exec(f))+"g")),f.lastIndex=0;J=f.exec(X);)var Q=J.index;U=U.slice(0,Q===r?C:Q)}}else if(e.indexOf(_r(f),C)!=C){var oe=U.lastIndexOf(f);oe>-1&&(U=U.slice(0,oe))}return U+u}function Ay(e){return e=it(e),e&&mt.test(e)?e.replace(di,ip):e}var Oy=bn(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),rc=ch("toUpperCase");function al(e,i,a){return e=it(e),i=a?r:i,i===r?Zd(e)?ap(e):Bd(e):e.match(i)||[]}var ol=Ke(function(e,i){try{return Ht(e,r,i)}catch(a){return Zo(a)?a:new Pe(a)}}),Py=ai(function(e,i){return Ir(i,function(a){a=Yr(a),ni(e,a,Jo(e[a],e))}),e});function Ny(e){var i=e==null?0:e.length,a=_e();return e=i?yt(e,function(u){if(typeof u[1]!="function")throw new xr(v);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var f=-1;++f<i;){var y=e[f];if(Ht(y[0],this,u))return Ht(y[1],this,u)}})}function Ty(e){return ig(Ar(e,F))}function ic(e){return function(){return e}}function Ry(e,i){return e==null||e!==e?i:e}var Uy=hh(),Fy=hh(!0);function dr(e){return e}function nc(e){return zu(typeof e=="function"?e:Ar(e,F))}function Ly(e){return Hu(Ar(e,F))}function $y(e,i){return Bu(e,Ar(i,F))}var My=Ke(function(e,i){return function(a){return qn(a,e,i)}}),jy=Ke(function(e,i){return function(a){return qn(e,a,i)}});function sc(e,i,a){var u=Bt(i),f=Xs(i,u);a==null&&!(bt(i)&&(f.length||!u.length))&&(a=i,i=e,e=this,f=Xs(i,Bt(i)));var y=!(bt(a)&&"chain"in a)||!!a.chain,E=ci(e);return Ir(f,function(C){var U=i[C];e[C]=U,E&&(e.prototype[C]=function(){var J=this.__chain__;if(y||J){var X=e(this.__wrapped__),Q=X.__actions__=hr(this.__actions__);return Q.push({func:U,args:arguments,thisArg:e}),X.__chain__=J,X}return U.apply(e,vi([this.value()],arguments))})}),e}function zy(){return Xe._===this&&(Xe._=fp),this}function ac(){}function qy(e){return e=Me(e),Ke(function(i){return Ku(i,e)})}var Hy=$o(yt),By=$o(lu),Ky=$o(oo);function cl(e){return Ko(e)?co(Yr(e)):mg(e)}function Vy(e){return function(i){return e==null?r:zi(e,i)}}var ky=fh(),Gy=fh(!0);function oc(){return[]}function cc(){return!1}function Wy(){return{}}function Yy(){return""}function Jy(){return!0}function Xy(e,i){if(e=Me(e),e<1||e>W)return[];var a=re,u=Yt(e,re);i=_e(i),e-=re;for(var f=lo(u,i);++a<e;)i(a);return f}function Zy(e){return Te(e)?yt(e,Yr):br(e)?[e]:hr(Ah(it(e)))}function Qy(e){var i=++hp;return it(e)+i}var e_=ia(function(e,i){return e+i},0),t_=Mo("ceil"),r_=ia(function(e,i){return e/i},1),i_=Mo("floor");function n_(e){return e&&e.length?Js(e,dr,Do):r}function s_(e,i){return e&&e.length?Js(e,_e(i,2),Do):r}function a_(e){return pu(e,dr)}function o_(e,i){return pu(e,_e(i,2))}function c_(e){return e&&e.length?Js(e,dr,Co):r}function u_(e,i){return e&&e.length?Js(e,_e(i,2),Co):r}var h_=ia(function(e,i){return e*i},1),l_=Mo("round"),f_=ia(function(e,i){return e-i},0);function d_(e){return e&&e.length?ho(e,dr):0}function p_(e,i){return e&&e.length?ho(e,_e(i,2)):0}return p.after=L1,p.ary=jh,p.assign=Dv,p.assignIn=Qh,p.assignInWith=va,p.assignWith=Sv,p.at=Iv,p.before=zh,p.bind=Jo,p.bindAll=Py,p.bindKey=qh,p.castArray=W1,p.chain=Lh,p.chunk=i0,p.compact=n0,p.concat=s0,p.cond=Ny,p.conforms=Ty,p.constant=ic,p.countBy=d1,p.create=xv,p.curry=Hh,p.curryRight=Bh,p.debounce=Kh,p.defaults=Cv,p.defaultsDeep=Av,p.defer=$1,p.delay=M1,p.difference=a0,p.differenceBy=o0,p.differenceWith=c0,p.drop=u0,p.dropRight=h0,p.dropRightWhile=l0,p.dropWhile=f0,p.fill=d0,p.filter=g1,p.flatMap=_1,p.flatMapDeep=b1,p.flatMapDepth=m1,p.flatten=Th,p.flattenDeep=p0,p.flattenDepth=g0,p.flip=j1,p.flow=Uy,p.flowRight=Fy,p.fromPairs=v0,p.functions=Fv,p.functionsIn=Lv,p.groupBy=w1,p.initial=_0,p.intersection=b0,p.intersectionBy=m0,p.intersectionWith=w0,p.invert=Mv,p.invertBy=jv,p.invokeMap=D1,p.iteratee=nc,p.keyBy=S1,p.keys=Bt,p.keysIn=fr,p.map=ha,p.mapKeys=qv,p.mapValues=Hv,p.matches=Ly,p.matchesProperty=$y,p.memoize=fa,p.merge=Bv,p.mergeWith=el,p.method=My,p.methodOf=jy,p.mixin=sc,p.negate=da,p.nthArg=qy,p.omit=Kv,p.omitBy=Vv,p.once=z1,p.orderBy=I1,p.over=Hy,p.overArgs=q1,p.overEvery=By,p.overSome=Ky,p.partial=Xo,p.partialRight=Vh,p.partition=x1,p.pick=kv,p.pickBy=tl,p.property=cl,p.propertyOf=Vy,p.pull=I0,p.pullAll=Uh,p.pullAllBy=x0,p.pullAllWith=C0,p.pullAt=A0,p.range=ky,p.rangeRight=Gy,p.rearg=H1,p.reject=O1,p.remove=O0,p.rest=B1,p.reverse=Wo,p.sampleSize=N1,p.set=Wv,p.setWith=Yv,p.shuffle=T1,p.slice=P0,p.sortBy=F1,p.sortedUniq=$0,p.sortedUniqBy=M0,p.split=_y,p.spread=K1,p.tail=j0,p.take=z0,p.takeRight=q0,p.takeRightWhile=H0,p.takeWhile=B0,p.tap=n1,p.throttle=V1,p.thru=ua,p.toArray=Jh,p.toPairs=rl,p.toPairsIn=il,p.toPath=Zy,p.toPlainObject=Zh,p.transform=Jv,p.unary=k1,p.union=K0,p.unionBy=V0,p.unionWith=k0,p.uniq=G0,p.uniqBy=W0,p.uniqWith=Y0,p.unset=Xv,p.unzip=Yo,p.unzipWith=Fh,p.update=Zv,p.updateWith=Qv,p.values=En,p.valuesIn=ey,p.without=J0,p.words=al,p.wrap=G1,p.xor=X0,p.xorBy=Z0,p.xorWith=Q0,p.zip=e1,p.zipObject=t1,p.zipObjectDeep=r1,p.zipWith=i1,p.entries=rl,p.entriesIn=il,p.extend=Qh,p.extendWith=va,sc(p,p),p.add=e_,p.attempt=ol,p.camelCase=ny,p.capitalize=nl,p.ceil=t_,p.clamp=ty,p.clone=Y1,p.cloneDeep=X1,p.cloneDeepWith=Z1,p.cloneWith=J1,p.conformsTo=Q1,p.deburr=sl,p.defaultTo=Ry,p.divide=r_,p.endsWith=sy,p.eq=zr,p.escape=ay,p.escapeRegExp=oy,p.every=p1,p.find=v1,p.findIndex=Ph,p.findKey=Ov,p.findLast=y1,p.findLastIndex=Nh,p.findLastKey=Pv,p.floor=i_,p.forEach=$h,p.forEachRight=Mh,p.forIn=Nv,p.forInRight=Tv,p.forOwn=Rv,p.forOwnRight=Uv,p.get=ec,p.gt=ev,p.gte=tv,p.has=$v,p.hasIn=tc,p.head=Rh,p.identity=dr,p.includes=E1,p.indexOf=y0,p.inRange=ry,p.invoke=zv,p.isArguments=Bi,p.isArray=Te,p.isArrayBuffer=rv,p.isArrayLike=lr,p.isArrayLikeObject=Ot,p.isBoolean=iv,p.isBuffer=Di,p.isDate=nv,p.isElement=sv,p.isEmpty=av,p.isEqual=ov,p.isEqualWith=cv,p.isError=Zo,p.isFinite=uv,p.isFunction=ci,p.isInteger=kh,p.isLength=pa,p.isMap=Gh,p.isMatch=hv,p.isMatchWith=lv,p.isNaN=fv,p.isNative=dv,p.isNil=gv,p.isNull=pv,p.isNumber=Wh,p.isObject=bt,p.isObjectLike=xt,p.isPlainObject=Gn,p.isRegExp=Qo,p.isSafeInteger=vv,p.isSet=Yh,p.isString=ga,p.isSymbol=br,p.isTypedArray=wn,p.isUndefined=yv,p.isWeakMap=_v,p.isWeakSet=bv,p.join=E0,p.kebabCase=cy,p.last=Pr,p.lastIndexOf=D0,p.lowerCase=uy,p.lowerFirst=hy,p.lt=mv,p.lte=wv,p.max=n_,p.maxBy=s_,p.mean=a_,p.meanBy=o_,p.min=c_,p.minBy=u_,p.stubArray=oc,p.stubFalse=cc,p.stubObject=Wy,p.stubString=Yy,p.stubTrue=Jy,p.multiply=h_,p.nth=S0,p.noConflict=zy,p.noop=ac,p.now=la,p.pad=ly,p.padEnd=fy,p.padStart=dy,p.parseInt=py,p.random=iy,p.reduce=C1,p.reduceRight=A1,p.repeat=gy,p.replace=vy,p.result=Gv,p.round=l_,p.runInContext=T,p.sample=P1,p.size=R1,p.snakeCase=yy,p.some=U1,p.sortedIndex=N0,p.sortedIndexBy=T0,p.sortedIndexOf=R0,p.sortedLastIndex=U0,p.sortedLastIndexBy=F0,p.sortedLastIndexOf=L0,p.startCase=by,p.startsWith=my,p.subtract=f_,p.sum=d_,p.sumBy=p_,p.template=wy,p.times=Xy,p.toFinite=ui,p.toInteger=Me,p.toLength=Xh,p.toLower=Ey,p.toNumber=Nr,p.toSafeInteger=Ev,p.toString=it,p.toUpper=Dy,p.trim=Sy,p.trimEnd=Iy,p.trimStart=xy,p.truncate=Cy,p.unescape=Ay,p.uniqueId=Qy,p.upperCase=Oy,p.upperFirst=rc,p.each=$h,p.eachRight=Mh,p.first=Rh,sc(p,function(){var e={};return Gr(p,function(i,a){nt.call(p.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),p.VERSION=s,Ir(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),Ir(["drop","take"],function(e,i){Ye.prototype[e]=function(a){a=a===r?1:qt(Me(a),0);var u=this.__filtered__&&!i?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Yt(a,u.__takeCount__):u.__views__.push({size:Yt(a,re),type:e+(u.__dir__<0?"Right":"")}),u},Ye.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Ir(["filter","map","takeWhile"],function(e,i){var a=i+1,u=a==P||a==le;Ye.prototype[e]=function(f){var y=this.clone();return y.__iteratees__.push({iteratee:_e(f,3),type:a}),y.__filtered__=y.__filtered__||u,y}}),Ir(["head","last"],function(e,i){var a="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[a](1).value()[0]}}),Ir(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(dr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Ke(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(a){return qn(a,e,i)})}),Ye.prototype.reject=function(e){return this.filter(da(_e(e)))},Ye.prototype.slice=function(e,i){e=Me(e);var a=this;return a.__filtered__&&(e>0||i<0)?new Ye(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=Me(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Gr(Ye.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=p[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);f&&(p.prototype[i]=function(){var E=this.__wrapped__,C=u?[1]:arguments,U=E instanceof Ye,J=C[0],X=U||Te(E),Q=function(Ge){var Ze=f.apply(p,vi([Ge],C));return u&&oe?Ze[0]:Ze};X&&a&&typeof J=="function"&&J.length!=1&&(U=X=!1);var oe=this.__chain__,ve=!!this.__actions__.length,me=y&&!oe,qe=U&&!ve;if(!y&&X){E=qe?E:new Ye(this);var we=e.apply(E,C);return we.__actions__.push({func:ua,args:[Q],thisArg:r}),new Cr(we,oe)}return me&&qe?e.apply(this,C):(we=this.thru(Q),me?u?we.value()[0]:we.value():we)})}),Ir(["pop","push","shift","sort","splice","unshift"],function(e){var i=Fs[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(Te(y)?y:[],f)}return this[a](function(E){return i.apply(Te(E)?E:[],f)})}}),Gr(Ye.prototype,function(e,i){var a=p[i];if(a){var u=a.name+"";nt.call(vn,u)||(vn[u]=[]),vn[u].push({name:i,func:a})}}),vn[ra(r,ie).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=Ap,Ye.prototype.reverse=Op,Ye.prototype.value=Pp,p.prototype.at=s1,p.prototype.chain=a1,p.prototype.commit=o1,p.prototype.next=c1,p.prototype.plant=h1,p.prototype.reverse=l1,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=f1,p.prototype.first=p.prototype.head,Un&&(p.prototype[Un]=u1),p},dn=op();At?((At.exports=dn)._=dn,ct._=dn):Xe._=dn}).call(ss)})(zc,zc.exports);var d2=Object.defineProperty,p2=Object.defineProperties,g2=Object.getOwnPropertyDescriptors,Df=Object.getOwnPropertySymbols,v2=Object.prototype.hasOwnProperty,y2=Object.prototype.propertyIsEnumerable,Sf=(n,t,r)=>t in n?d2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,_a=(n,t)=>{for(var r in t||(t={}))v2.call(t,r)&&Sf(n,r,t[r]);if(Df)for(var r of Df(t))y2.call(t,r)&&Sf(n,r,t[r]);return n},_2=(n,t)=>p2(n,g2(t));function Ur(n,t,r){let s;const o=qc(n);return t.rpcMap&&(s=t.rpcMap[o]),s||(s=`${f2}?chainId=eip155:${o}&projectId=${r}`),s}function qc(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function b2(n,t){if(!t.includes(n))throw new Error(`Chain '${n}' not approved. Please use one of the following: ${t.toString()}`)}function m2(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function w2(n,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(n));if(!r.length)return[];const s=[];return r.forEach(o=>{const l=t.namespaces[o].accounts;s.push(...l)}),s}function E2(n,t={}){const r=If(n),s=If(t);return zc.exports.merge(r,s)}function If(n){var t,r,s,o;const l={};if(!xn(n))return l;for(const[v,d]of Object.entries(n)){const g=od(v)?[v]:d.chains,w=d.methods||[],S=d.events||[],F=d.rpcMap||{},q=wa(v);l[q]=_2(_a(_a({},l[q]),d),{chains:pc(g,(t=l[q])==null?void 0:t.chains),methods:pc(w,(r=l[q])==null?void 0:r.methods),events:pc(S,(s=l[q])==null?void 0:s.events),rpcMap:_a(_a({},F),(o=l[q])==null?void 0:o.rpcMap)})}return l}const tn=(n,t)=>{const r=s=>{s.request!==t.request||s.topic!==t.topic||(n.events.removeListener("session_request_sent",r),D2(t,n.core.storage))};n.on("session_request_sent",r)};async function D2(n,t){try{const r=await t.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(!r)return;const s=typeof r=="string"?JSON.parse(r):r,o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&o.slice(0,-1);const l=`${o}/wc?requestId=${n.id}&sessionTopic=${n.topic}`,v=rd();v===Yi.browser?window.open(l,"_self","noreferrer noopener"):v===Yi.reactNative&&await require("react-native").Linking.openURL(l)}catch(r){console.error(r)}}class S2{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?(tn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace);return typeof s>"u"?void 0:new Ci(new Zi(s))}}class I2{constructor(t){this.name="eip155",this.namespace=t.namespace,this.client=t.client,this.events=t.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){var r;switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?(tn(this.client,t),await this.client.request(t)):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=qc(t);if(!this.httpProviders[s]){const o=r||Ur(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=qc(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}handleSwitchChain(t){const r=parseInt(t,16),s=`${this.name}:${r}`;b2(s,this.namespace.chains),this.setDefaultChain(`${r}`)}}class x2{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?(tn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s))}}class C2{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?(tn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s))}}class A2{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?(tn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Ci(new Zi(s))}}class O2{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?(tn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s))}}class P2{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?(tn(this.client,t),this.client.request(t)):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Ur(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ur(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ci(new Zi(s))}}var N2=Object.defineProperty,T2=Object.defineProperties,R2=Object.getOwnPropertyDescriptors,xf=Object.getOwnPropertySymbols,U2=Object.prototype.hasOwnProperty,F2=Object.prototype.propertyIsEnumerable,Cf=(n,t,r)=>t in n?N2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ba=(n,t)=>{for(var r in t||(t={}))U2.call(t,r)&&Cf(n,r,t[r]);if(xf)for(var r of xf(t))F2.call(t,r)&&Cf(n,r,t[r]);return n},Ic=(n,t)=>T2(n,R2(t));class uu{constructor(t){this.events=new Fr,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||wf}))}static async init(t){const r=new uu(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ba({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Nt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(l=>{this.session=l}).catch(l=>{if(l.message!==Ld)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(fi(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await c2.init({logger:this.providerOpts.logger||wf,relayUrl:this.providerOpts.relayUrl||u2,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");[...new Set(Object.keys(this.session.namespaces).map(t=>wa(t)))].forEach(t=>{if(!this.session)return;const r=w2(t,this.session),s=m2(r),o=E2(this.namespaces,this.optionalNamespaces),l=Ic(ba({},o[t]),{accounts:r,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new I2({client:this.client,namespace:l,events:this.events});break;case"solana":this.rpcProviders[t]=new x2({client:this.client,namespace:l,events:this.events});break;case"cosmos":this.rpcProviders[t]=new C2({client:this.client,namespace:l,events:this.events});break;case"polkadot":this.rpcProviders[t]=new S2({client:this.client,namespace:l,events:this.events});break;case"cip34":this.rpcProviders[t]=new A2({client:this.client,namespace:l,events:this.events});break;case"elrond":this.rpcProviders[t]=new O2({client:this.client,namespace:l,events:this.events});break;case"multiversx":this.rpcProviders[t]=new P2({client:this.client,namespace:l,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,l=(s=this.client)==null?void 0:s.session.get(t);this.session=Ic(ba({},l),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ic(ba({},Nt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Oi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).map(v=>wa(v)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=wa(Object.keys(this.namespaces)[0]),l=this.rpcProviders[o].getDefaultChain();return[o,l]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;const[o,l]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(l),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Ef}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Ef}/${t}`)}}const L2=uu,$2="wc",M2="ethereum_provider",j2=`${$2}@2:${M2}:`,z2="https://rpc.walletconnect.com/v1/",Hc=["eth_sendTransaction","personal_sign"],nD=["eth_accounts","eth_requestAccounts","eth_call","eth_getBalance","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Bc=["chainChanged","accountsChanged"],sD=["message","disconnect","connect"];var q2=Object.defineProperty,H2=Object.defineProperties,B2=Object.getOwnPropertyDescriptors,Af=Object.getOwnPropertySymbols,K2=Object.prototype.hasOwnProperty,V2=Object.prototype.propertyIsEnumerable,Of=(n,t,r)=>t in n?q2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,xc=(n,t)=>{for(var r in t||(t={}))K2.call(t,r)&&Of(n,r,t[r]);if(Af)for(var r of Af(t))V2.call(t,r)&&Of(n,r,t[r]);return n},Pf=(n,t)=>H2(n,B2(t));function Kc(n){return Number(n[0].split(":")[1])}function Cc(n){return`0x${n.toString(16)}`}function k2(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:l,optionalEvents:v,rpcMap:d}=n;if(!fi(t))throw new Error("Invalid chains");const g=t,w=s||Hc,S=l||Bc,F={[Kc(g)]:d[Kc(g)]},q={chains:g,methods:w,events:S,rpcMap:F},L=l==null?void 0:l.filter(ie=>!Bc.includes(ie)),$=s==null?void 0:s.filter(ie=>!Hc.includes(ie));if(!r&&!v&&!o&&!(L!=null&&L.length)&&!($!=null&&$.length))return{required:q};const B=(L==null?void 0:L.length)&&($==null?void 0:$.length)||!r,G={chains:[...new Set(B?g.concat(r||[]):r)],methods:[...new Set(w.concat(o||[]))],events:[...new Set(S.concat(v||[]))],rpcMap:d};return{required:q,optional:G}}class hu{constructor(){this.events=new Fr,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=j2,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new hu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=k2(this.rpc);try{const o=await new Promise(async(v,d)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(w=>{!w.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Pf(xc({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(w=>{v(w)}).catch(w=>{d(new Error(w.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const l=Dm(o.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:Cc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Cc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Pf(xc({},Nt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}setHttpProvider(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Cc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.setHttpProvider(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;return{chains:((r=t.chains)==null?void 0:r.map(o=>this.formatChainId(o)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(o=>this.formatChainId(o)):void 0,methods:(t==null?void 0:t.methods)||Hc,events:(t==null?void 0:t.events)||Bc,optionalMethods:(t==null?void 0:t.optionalMethods)||[],optionalEvents:(t==null?void 0:t.optionalEvents)||[],rpcMap:(t==null?void 0:t.rpcMap)||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:(s=t==null?void 0:t.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=Kc(this.rpc.chains),this.signer=await L2.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal)try{const{Web3Modal:r}=await w_(()=>import("./index-f2b60d69.js").then(s=>s.i),["./index-f2b60d69.js","./index-3ce0559c.js","./index-269edbab.css"],import.meta.url);this.modal=new r(xc({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch{throw new Error("To use QR modal, please install @web3modal/standalone package")}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&fi(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)})),s&&fi(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${z2}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`);this.setChainIds(t?[this.formatChainId(t)]:this.session.namespaces[this.namespace].accounts),this.setAccounts(this.session.namespaces[this.namespace].accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const aD=hu;export{aD as EthereumProvider,sD as OPTIONAL_EVENTS,nD as OPTIONAL_METHODS,Bc as REQUIRED_EVENTS,Hc as REQUIRED_METHODS,hu as default};
